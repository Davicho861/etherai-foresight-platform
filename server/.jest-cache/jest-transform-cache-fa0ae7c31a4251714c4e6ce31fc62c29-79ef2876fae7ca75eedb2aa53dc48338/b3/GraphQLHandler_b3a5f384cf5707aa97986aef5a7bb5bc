3352eb33ca530671cc904db4c59e4b4e
"use strict";

var __defProp = Object.defineProperty;
var __getOwnPropDesc = Object.getOwnPropertyDescriptor;
var __getOwnPropNames = Object.getOwnPropertyNames;
var __hasOwnProp = Object.prototype.hasOwnProperty;
var __export = (target, all) => {
  for (var name in all) __defProp(target, name, {
    get: all[name],
    enumerable: true
  });
};
var __copyProps = (to, from, except, desc) => {
  if (from && typeof from === "object" || typeof from === "function") {
    for (let key of __getOwnPropNames(from)) if (!__hasOwnProp.call(to, key) && key !== except) __defProp(to, key, {
      get: () => from[key],
      enumerable: !(desc = __getOwnPropDesc(from, key)) || desc.enumerable
    });
  }
  return to;
};
var __toCommonJS = mod => __copyProps(__defProp({}, "__esModule", {
  value: true
}), mod);
var GraphQLHandler_exports = {};
__export(GraphQLHandler_exports, {
  GraphQLHandler: () => GraphQLHandler,
  isDocumentNode: () => isDocumentNode
});
module.exports = __toCommonJS(GraphQLHandler_exports);
var import_RequestHandler = require("./RequestHandler");
var import_getTimestamp = require("../utils/logging/getTimestamp");
var import_getStatusCodeColor = require("../utils/logging/getStatusCodeColor");
var import_serializeRequest = require("../utils/logging/serializeRequest");
var import_serializeResponse = require("../utils/logging/serializeResponse");
var import_matchRequestUrl = require("../utils/matching/matchRequestUrl");
var import_parseGraphQLRequest = require("../utils/internal/parseGraphQLRequest");
var import_toPublicUrl = require("../utils/request/toPublicUrl");
var import_devUtils = require("../utils/internal/devUtils");
var import_getRequestCookies = require("../utils/request/getRequestCookies");
function isDocumentNode(value) {
  if (value == null) {
    return false;
  }
  return typeof value === "object" && "kind" in value && "definitions" in value;
}
class GraphQLHandler extends import_RequestHandler.RequestHandler {
  endpoint;
  static parsedRequestCache = /* @__PURE__ */new WeakMap();
  constructor(operationType, predicate, endpoint, resolver, options) {
    let resolvedOperationName = predicate;
    if (isDocumentNode(resolvedOperationName)) {
      const parsedNode = (0, import_parseGraphQLRequest.parseDocumentNode)(resolvedOperationName);
      if (parsedNode.operationType !== operationType) {
        throw new Error(`Failed to create a GraphQL handler: provided a DocumentNode with a mismatched operation type (expected "${operationType}", but got "${parsedNode.operationType}").`);
      }
      if (!parsedNode.operationName) {
        throw new Error(`Failed to create a GraphQL handler: provided a DocumentNode with no operation name.`);
      }
      resolvedOperationName = parsedNode.operationName;
    }
    const displayOperationName = typeof resolvedOperationName === "function" ? "[custom predicate]" : resolvedOperationName;
    const header = operationType === "all" ? `${operationType} (origin: ${endpoint.toString()})` : `${operationType}${displayOperationName ? ` ${displayOperationName}` : ""} (origin: ${endpoint.toString()})`;
    super({
      info: {
        header,
        operationType,
        operationName: resolvedOperationName
      },
      resolver,
      options
    });
    this.endpoint = endpoint;
  }
  /**
   * Parses the request body, once per request, cached across all
   * GraphQL handlers. This is done to avoid multiple parsing of the
   * request body, which each requires a clone of the request.
   */
  async parseGraphQLRequestOrGetFromCache(request) {
    if (!GraphQLHandler.parsedRequestCache.has(request)) {
      GraphQLHandler.parsedRequestCache.set(request, await (0, import_parseGraphQLRequest.parseGraphQLRequest)(request).catch(error => {
        console.error(error);
        return void 0;
      }));
    }
    return GraphQLHandler.parsedRequestCache.get(request);
  }
  async parse(args) {
    const match = (0, import_matchRequestUrl.matchRequestUrl)(new URL(args.request.url), this.endpoint);
    const cookies = (0, import_getRequestCookies.getAllRequestCookies)(args.request);
    if (!match.matches) {
      return {
        match,
        cookies
      };
    }
    const parsedResult = await this.parseGraphQLRequestOrGetFromCache(args.request);
    if (typeof parsedResult === "undefined") {
      return {
        match,
        cookies
      };
    }
    return {
      match,
      cookies,
      query: parsedResult.query,
      operationType: parsedResult.operationType,
      operationName: parsedResult.operationName,
      variables: parsedResult.variables
    };
  }
  async predicate(args) {
    if (args.parsedResult.operationType === void 0) {
      return false;
    }
    if (!args.parsedResult.operationName && this.info.operationType !== "all") {
      const publicUrl = (0, import_toPublicUrl.toPublicUrl)(args.request.url);
      import_devUtils.devUtils.warn(`Failed to intercept a GraphQL request at "${args.request.method} ${publicUrl}": anonymous GraphQL operations are not supported.

Consider naming this operation or using "graphql.operation()" request handler to intercept GraphQL requests regardless of their operation name/type. Read more: https://mswjs.io/docs/api/graphql/#graphqloperationresolver`);
      return false;
    }
    const hasMatchingOperationType = this.info.operationType === "all" || args.parsedResult.operationType === this.info.operationType;
    const hasMatchingOperationName = await this.matchOperationName({
      request: args.request,
      parsedResult: args.parsedResult
    });
    return args.parsedResult.match.matches && hasMatchingOperationType && hasMatchingOperationName;
  }
  async matchOperationName(args) {
    if (typeof this.info.operationName === "function") {
      const customPredicateResult = await this.info.operationName({
        request: args.request,
        ...this.extendResolverArgs({
          request: args.request,
          parsedResult: args.parsedResult
        })
      });
      return typeof customPredicateResult === "boolean" ? customPredicateResult : customPredicateResult.matches;
    }
    if (this.info.operationName instanceof RegExp) {
      return this.info.operationName.test(args.parsedResult.operationName || "");
    }
    return args.parsedResult.operationName === this.info.operationName;
  }
  extendResolverArgs(args) {
    return {
      query: args.parsedResult.query || "",
      operationType: args.parsedResult.operationType,
      operationName: args.parsedResult.operationName || "",
      variables: args.parsedResult.variables || {},
      cookies: args.parsedResult.cookies
    };
  }
  async log(args) {
    const loggedRequest = await (0, import_serializeRequest.serializeRequest)(args.request);
    const loggedResponse = await (0, import_serializeResponse.serializeResponse)(args.response);
    const statusColor = (0, import_getStatusCodeColor.getStatusCodeColor)(loggedResponse.status);
    const requestInfo = args.parsedResult.operationName ? `${args.parsedResult.operationType} ${args.parsedResult.operationName}` : `anonymous ${args.parsedResult.operationType}`;
    console.groupCollapsed(import_devUtils.devUtils.formatMessage(`${(0, import_getTimestamp.getTimestamp)()} ${requestInfo} (%c${loggedResponse.status} ${loggedResponse.statusText}%c)`), `color:${statusColor}`, "color:inherit");
    console.log("Request:", loggedRequest);
    console.log("Handler:", this);
    console.log("Response:", loggedResponse);
    console.groupEnd();
  }
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJHcmFwaFFMSGFuZGxlcl9leHBvcnRzIiwiX19leHBvcnQiLCJHcmFwaFFMSGFuZGxlciIsImlzRG9jdW1lbnROb2RlIiwibW9kdWxlIiwiZXhwb3J0cyIsIl9fdG9Db21tb25KUyIsImltcG9ydF9SZXF1ZXN0SGFuZGxlciIsInJlcXVpcmUiLCJpbXBvcnRfZ2V0VGltZXN0YW1wIiwiaW1wb3J0X2dldFN0YXR1c0NvZGVDb2xvciIsImltcG9ydF9zZXJpYWxpemVSZXF1ZXN0IiwiaW1wb3J0X3NlcmlhbGl6ZVJlc3BvbnNlIiwiaW1wb3J0X21hdGNoUmVxdWVzdFVybCIsImltcG9ydF9wYXJzZUdyYXBoUUxSZXF1ZXN0IiwiaW1wb3J0X3RvUHVibGljVXJsIiwiaW1wb3J0X2RldlV0aWxzIiwiaW1wb3J0X2dldFJlcXVlc3RDb29raWVzIiwidmFsdWUiLCJSZXF1ZXN0SGFuZGxlciIsImVuZHBvaW50IiwicGFyc2VkUmVxdWVzdENhY2hlIiwiV2Vha01hcCIsImNvbnN0cnVjdG9yIiwib3BlcmF0aW9uVHlwZSIsInByZWRpY2F0ZSIsInJlc29sdmVyIiwib3B0aW9ucyIsInJlc29sdmVkT3BlcmF0aW9uTmFtZSIsInBhcnNlZE5vZGUiLCJwYXJzZURvY3VtZW50Tm9kZSIsIkVycm9yIiwib3BlcmF0aW9uTmFtZSIsImRpc3BsYXlPcGVyYXRpb25OYW1lIiwiaGVhZGVyIiwidG9TdHJpbmciLCJpbmZvIiwicGFyc2VHcmFwaFFMUmVxdWVzdE9yR2V0RnJvbUNhY2hlIiwicmVxdWVzdCIsImhhcyIsInNldCIsInBhcnNlR3JhcGhRTFJlcXVlc3QiLCJjYXRjaCIsImVycm9yIiwiY29uc29sZSIsImdldCIsInBhcnNlIiwiYXJncyIsIm1hdGNoIiwibWF0Y2hSZXF1ZXN0VXJsIiwiVVJMIiwidXJsIiwiY29va2llcyIsImdldEFsbFJlcXVlc3RDb29raWVzIiwibWF0Y2hlcyIsInBhcnNlZFJlc3VsdCIsInF1ZXJ5IiwidmFyaWFibGVzIiwicHVibGljVXJsIiwidG9QdWJsaWNVcmwiLCJkZXZVdGlscyIsIndhcm4iLCJtZXRob2QiLCJoYXNNYXRjaGluZ09wZXJhdGlvblR5cGUiLCJoYXNNYXRjaGluZ09wZXJhdGlvbk5hbWUiLCJtYXRjaE9wZXJhdGlvbk5hbWUiLCJjdXN0b21QcmVkaWNhdGVSZXN1bHQiLCJleHRlbmRSZXNvbHZlckFyZ3MiLCJSZWdFeHAiLCJ0ZXN0IiwibG9nIiwibG9nZ2VkUmVxdWVzdCIsInNlcmlhbGl6ZVJlcXVlc3QiLCJsb2dnZWRSZXNwb25zZSIsInNlcmlhbGl6ZVJlc3BvbnNlIiwicmVzcG9uc2UiLCJzdGF0dXNDb2xvciIsImdldFN0YXR1c0NvZGVDb2xvciIsInN0YXR1cyIsInJlcXVlc3RJbmZvIiwiZ3JvdXBDb2xsYXBzZWQiLCJmb3JtYXRNZXNzYWdlIiwiZ2V0VGltZXN0YW1wIiwic3RhdHVzVGV4dCIsImdyb3VwRW5kIl0sInNvdXJjZXMiOlsiLi4vLi4vLi4vc3JjL2NvcmUvaGFuZGxlcnMvR3JhcGhRTEhhbmRsZXIudHMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHR5cGUgeyBEb2N1bWVudE5vZGUsIEdyYXBoUUxFcnJvciwgT3BlcmF0aW9uVHlwZU5vZGUgfSBmcm9tICdncmFwaHFsJ1xuaW1wb3J0IHtcbiAgRGVmYXVsdEJvZHlUeXBlLFxuICBSZXF1ZXN0SGFuZGxlcixcbiAgUmVxdWVzdEhhbmRsZXJEZWZhdWx0SW5mbyxcbiAgUmVxdWVzdEhhbmRsZXJPcHRpb25zLFxuICBSZXNwb25zZVJlc29sdmVyLFxufSBmcm9tICcuL1JlcXVlc3RIYW5kbGVyJ1xuaW1wb3J0IHsgZ2V0VGltZXN0YW1wIH0gZnJvbSAnLi4vdXRpbHMvbG9nZ2luZy9nZXRUaW1lc3RhbXAnXG5pbXBvcnQgeyBnZXRTdGF0dXNDb2RlQ29sb3IgfSBmcm9tICcuLi91dGlscy9sb2dnaW5nL2dldFN0YXR1c0NvZGVDb2xvcidcbmltcG9ydCB7IHNlcmlhbGl6ZVJlcXVlc3QgfSBmcm9tICcuLi91dGlscy9sb2dnaW5nL3NlcmlhbGl6ZVJlcXVlc3QnXG5pbXBvcnQgeyBzZXJpYWxpemVSZXNwb25zZSB9IGZyb20gJy4uL3V0aWxzL2xvZ2dpbmcvc2VyaWFsaXplUmVzcG9uc2UnXG5pbXBvcnQgeyBNYXRjaCwgbWF0Y2hSZXF1ZXN0VXJsLCBQYXRoIH0gZnJvbSAnLi4vdXRpbHMvbWF0Y2hpbmcvbWF0Y2hSZXF1ZXN0VXJsJ1xuaW1wb3J0IHtcbiAgUGFyc2VkR3JhcGhRTFJlcXVlc3QsXG4gIEdyYXBoUUxNdWx0aXBhcnRSZXF1ZXN0Qm9keSxcbiAgcGFyc2VHcmFwaFFMUmVxdWVzdCxcbiAgcGFyc2VEb2N1bWVudE5vZGUsXG59IGZyb20gJy4uL3V0aWxzL2ludGVybmFsL3BhcnNlR3JhcGhRTFJlcXVlc3QnXG5pbXBvcnQgeyB0b1B1YmxpY1VybCB9IGZyb20gJy4uL3V0aWxzL3JlcXVlc3QvdG9QdWJsaWNVcmwnXG5pbXBvcnQgeyBkZXZVdGlscyB9IGZyb20gJy4uL3V0aWxzL2ludGVybmFsL2RldlV0aWxzJ1xuaW1wb3J0IHsgZ2V0QWxsUmVxdWVzdENvb2tpZXMgfSBmcm9tICcuLi91dGlscy9yZXF1ZXN0L2dldFJlcXVlc3RDb29raWVzJ1xuXG5leHBvcnQgdHlwZSBHcmFwaFFMT3BlcmF0aW9uVHlwZSA9IE9wZXJhdGlvblR5cGVOb2RlIHwgJ2FsbCdcbmV4cG9ydCB0eXBlIEdyYXBoUUxIYW5kbGVyTmFtZVNlbGVjdG9yID0gRG9jdW1lbnROb2RlIHwgUmVnRXhwIHwgc3RyaW5nXG5cbmV4cG9ydCB0eXBlIEdyYXBoUUxRdWVyeSA9IFJlY29yZDxzdHJpbmcsIGFueT4gfCBudWxsXG5leHBvcnQgdHlwZSBHcmFwaFFMVmFyaWFibGVzID0gUmVjb3JkPHN0cmluZywgYW55PlxuXG5leHBvcnQgaW50ZXJmYWNlIEdyYXBoUUxIYW5kbGVySW5mbyBleHRlbmRzIFJlcXVlc3RIYW5kbGVyRGVmYXVsdEluZm8ge1xuICBvcGVyYXRpb25UeXBlOiBHcmFwaFFMT3BlcmF0aW9uVHlwZVxuICBvcGVyYXRpb25OYW1lOiBHcmFwaFFMSGFuZGxlck5hbWVTZWxlY3RvciB8IEdyYXBoUUxDdXN0b21QcmVkaWNhdGVcbn1cblxuZXhwb3J0IHR5cGUgR3JhcGhRTFJlcXVlc3RQYXJzZWRSZXN1bHQgPSB7XG4gIG1hdGNoOiBNYXRjaFxuICBjb29raWVzOiBSZWNvcmQ8c3RyaW5nLCBzdHJpbmc+XG59ICYgKFxuICB8IFBhcnNlZEdyYXBoUUxSZXF1ZXN0PEdyYXBoUUxWYXJpYWJsZXM+XG4gIC8qKlxuICAgKiBBbiBlbXB0eSB2ZXJzaW9uIG9mIHRoZSBQYXJzZWRHcmFwaFFMUmVxdWVzdFxuICAgKiB3aGljaCBzaW1wbGlmaWVzIHRoZSByZXR1cm4gdHlwZSBvZiB0aGUgcmVzb2x2ZXJcbiAgICogd2hlbiB0aGUgcmVxdWVzdCBpcyB0byBhIG5vbi1tYXRjaGluZyBlbmRwb2ludFxuICAgKi9cbiAgfCB7XG4gICAgICBvcGVyYXRpb25UeXBlPzogdW5kZWZpbmVkXG4gICAgICBvcGVyYXRpb25OYW1lPzogdW5kZWZpbmVkXG4gICAgICBxdWVyeT86IHVuZGVmaW5lZFxuICAgICAgdmFyaWFibGVzPzogdW5kZWZpbmVkXG4gICAgfVxuKVxuXG5leHBvcnQgdHlwZSBHcmFwaFFMUmVzb2x2ZXJFeHRyYXM8VmFyaWFibGVzIGV4dGVuZHMgR3JhcGhRTFZhcmlhYmxlcz4gPSB7XG4gIHF1ZXJ5OiBzdHJpbmdcbiAgb3BlcmF0aW9uTmFtZTogc3RyaW5nXG4gIHZhcmlhYmxlczogVmFyaWFibGVzXG4gIGNvb2tpZXM6IFJlY29yZDxzdHJpbmcsIHN0cmluZz5cbn1cblxuZXhwb3J0IHR5cGUgR3JhcGhRTFJlcXVlc3RCb2R5PFZhcmlhYmxlc1R5cGUgZXh0ZW5kcyBHcmFwaFFMVmFyaWFibGVzPiA9XG4gIHwgR3JhcGhRTEpzb25SZXF1ZXN0Qm9keTxWYXJpYWJsZXNUeXBlPlxuICB8IEdyYXBoUUxNdWx0aXBhcnRSZXF1ZXN0Qm9keVxuICB8IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgfCB1bmRlZmluZWRcblxuZXhwb3J0IGludGVyZmFjZSBHcmFwaFFMSnNvblJlcXVlc3RCb2R5PFZhcmlhYmxlcyBleHRlbmRzIEdyYXBoUUxWYXJpYWJsZXM+IHtcbiAgcXVlcnk6IHN0cmluZ1xuICB2YXJpYWJsZXM/OiBWYXJpYWJsZXNcbn1cblxuZXhwb3J0IHR5cGUgR3JhcGhRTFJlc3BvbnNlQm9keTxCb2R5VHlwZSBleHRlbmRzIERlZmF1bHRCb2R5VHlwZT4gPVxuICB8IHtcbiAgICAgIGRhdGE/OiBCb2R5VHlwZSB8IG51bGxcbiAgICAgIGVycm9ycz86IHJlYWRvbmx5IFBhcnRpYWw8R3JhcGhRTEVycm9yPltdIHwgbnVsbFxuICAgICAgZXh0ZW5zaW9ucz86IFJlY29yZDxzdHJpbmcsIGFueT5cbiAgICB9XG4gIHwgbnVsbFxuICB8IHVuZGVmaW5lZFxuXG5leHBvcnQgdHlwZSBHcmFwaFFMQ3VzdG9tUHJlZGljYXRlID0gKGFyZ3M6IHtcbiAgcmVxdWVzdDogUmVxdWVzdFxuICBxdWVyeTogc3RyaW5nXG4gIG9wZXJhdGlvblR5cGU6IEdyYXBoUUxPcGVyYXRpb25UeXBlXG4gIG9wZXJhdGlvbk5hbWU6IHN0cmluZ1xuICB2YXJpYWJsZXM6IEdyYXBoUUxWYXJpYWJsZXNcbiAgY29va2llczogUmVjb3JkPHN0cmluZywgc3RyaW5nPlxufSkgPT4gR3JhcGhRTEN1c3RvbVByZWRpY2F0ZVJlc3VsdCB8IFByb21pc2U8R3JhcGhRTEN1c3RvbVByZWRpY2F0ZVJlc3VsdD5cblxuZXhwb3J0IHR5cGUgR3JhcGhRTEN1c3RvbVByZWRpY2F0ZVJlc3VsdCA9IGJvb2xlYW4gfCB7IG1hdGNoZXM6IGJvb2xlYW4gfVxuXG5leHBvcnQgdHlwZSBHcmFwaFFMUHJlZGljYXRlID1cbiAgfCBHcmFwaFFMSGFuZGxlck5hbWVTZWxlY3RvclxuICB8IEdyYXBoUUxDdXN0b21QcmVkaWNhdGVcblxuZXhwb3J0IGZ1bmN0aW9uIGlzRG9jdW1lbnROb2RlKFxuICB2YWx1ZTogRG9jdW1lbnROb2RlIHwgYW55LFxuKTogdmFsdWUgaXMgRG9jdW1lbnROb2RlIHtcbiAgaWYgKHZhbHVlID09IG51bGwpIHtcbiAgICByZXR1cm4gZmFsc2VcbiAgfVxuXG4gIHJldHVybiB0eXBlb2YgdmFsdWUgPT09ICdvYmplY3QnICYmICdraW5kJyBpbiB2YWx1ZSAmJiAnZGVmaW5pdGlvbnMnIGluIHZhbHVlXG59XG5cbmV4cG9ydCBjbGFzcyBHcmFwaFFMSGFuZGxlciBleHRlbmRzIFJlcXVlc3RIYW5kbGVyPFxuICBHcmFwaFFMSGFuZGxlckluZm8sXG4gIEdyYXBoUUxSZXF1ZXN0UGFyc2VkUmVzdWx0LFxuICBHcmFwaFFMUmVzb2x2ZXJFeHRyYXM8YW55PlxuPiB7XG4gIHByaXZhdGUgZW5kcG9pbnQ6IFBhdGhcblxuICBzdGF0aWMgcGFyc2VkUmVxdWVzdENhY2hlID0gbmV3IFdlYWtNYXA8XG4gICAgUmVxdWVzdCxcbiAgICBQYXJzZWRHcmFwaFFMUmVxdWVzdDxHcmFwaFFMVmFyaWFibGVzPlxuICA+KClcblxuICBjb25zdHJ1Y3RvcihcbiAgICBvcGVyYXRpb25UeXBlOiBHcmFwaFFMT3BlcmF0aW9uVHlwZSxcbiAgICBwcmVkaWNhdGU6IEdyYXBoUUxQcmVkaWNhdGUsXG4gICAgZW5kcG9pbnQ6IFBhdGgsXG4gICAgcmVzb2x2ZXI6IFJlc3BvbnNlUmVzb2x2ZXI8R3JhcGhRTFJlc29sdmVyRXh0cmFzPGFueT4sIGFueSwgYW55PixcbiAgICBvcHRpb25zPzogUmVxdWVzdEhhbmRsZXJPcHRpb25zLFxuICApIHtcbiAgICBsZXQgcmVzb2x2ZWRPcGVyYXRpb25OYW1lID0gcHJlZGljYXRlXG5cbiAgICBpZiAoaXNEb2N1bWVudE5vZGUocmVzb2x2ZWRPcGVyYXRpb25OYW1lKSkge1xuICAgICAgY29uc3QgcGFyc2VkTm9kZSA9IHBhcnNlRG9jdW1lbnROb2RlKHJlc29sdmVkT3BlcmF0aW9uTmFtZSlcblxuICAgICAgaWYgKHBhcnNlZE5vZGUub3BlcmF0aW9uVHlwZSAhPT0gb3BlcmF0aW9uVHlwZSkge1xuICAgICAgICB0aHJvdyBuZXcgRXJyb3IoXG4gICAgICAgICAgYEZhaWxlZCB0byBjcmVhdGUgYSBHcmFwaFFMIGhhbmRsZXI6IHByb3ZpZGVkIGEgRG9jdW1lbnROb2RlIHdpdGggYSBtaXNtYXRjaGVkIG9wZXJhdGlvbiB0eXBlIChleHBlY3RlZCBcIiR7b3BlcmF0aW9uVHlwZX1cIiwgYnV0IGdvdCBcIiR7cGFyc2VkTm9kZS5vcGVyYXRpb25UeXBlfVwiKS5gLFxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIGlmICghcGFyc2VkTm9kZS5vcGVyYXRpb25OYW1lKSB7XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihcbiAgICAgICAgICBgRmFpbGVkIHRvIGNyZWF0ZSBhIEdyYXBoUUwgaGFuZGxlcjogcHJvdmlkZWQgYSBEb2N1bWVudE5vZGUgd2l0aCBubyBvcGVyYXRpb24gbmFtZS5gLFxuICAgICAgICApXG4gICAgICB9XG5cbiAgICAgIHJlc29sdmVkT3BlcmF0aW9uTmFtZSA9IHBhcnNlZE5vZGUub3BlcmF0aW9uTmFtZVxuICAgIH1cblxuICAgIGNvbnN0IGRpc3BsYXlPcGVyYXRpb25OYW1lID1cbiAgICAgIHR5cGVvZiByZXNvbHZlZE9wZXJhdGlvbk5hbWUgPT09ICdmdW5jdGlvbidcbiAgICAgICAgPyAnW2N1c3RvbSBwcmVkaWNhdGVdJ1xuICAgICAgICA6IHJlc29sdmVkT3BlcmF0aW9uTmFtZVxuXG4gICAgY29uc3QgaGVhZGVyID1cbiAgICAgIG9wZXJhdGlvblR5cGUgPT09ICdhbGwnXG4gICAgICAgID8gYCR7b3BlcmF0aW9uVHlwZX0gKG9yaWdpbjogJHtlbmRwb2ludC50b1N0cmluZygpfSlgXG4gICAgICAgIDogYCR7b3BlcmF0aW9uVHlwZX0ke2Rpc3BsYXlPcGVyYXRpb25OYW1lID8gYCAke2Rpc3BsYXlPcGVyYXRpb25OYW1lfWAgOiAnJ30gKG9yaWdpbjogJHtlbmRwb2ludC50b1N0cmluZygpfSlgXG5cbiAgICBzdXBlcih7XG4gICAgICBpbmZvOiB7XG4gICAgICAgIGhlYWRlcixcbiAgICAgICAgb3BlcmF0aW9uVHlwZSxcbiAgICAgICAgb3BlcmF0aW9uTmFtZTogcmVzb2x2ZWRPcGVyYXRpb25OYW1lLFxuICAgICAgfSxcbiAgICAgIHJlc29sdmVyLFxuICAgICAgb3B0aW9ucyxcbiAgICB9KVxuXG4gICAgdGhpcy5lbmRwb2ludCA9IGVuZHBvaW50XG4gIH1cblxuICAvKipcbiAgICogUGFyc2VzIHRoZSByZXF1ZXN0IGJvZHksIG9uY2UgcGVyIHJlcXVlc3QsIGNhY2hlZCBhY3Jvc3MgYWxsXG4gICAqIEdyYXBoUUwgaGFuZGxlcnMuIFRoaXMgaXMgZG9uZSB0byBhdm9pZCBtdWx0aXBsZSBwYXJzaW5nIG9mIHRoZVxuICAgKiByZXF1ZXN0IGJvZHksIHdoaWNoIGVhY2ggcmVxdWlyZXMgYSBjbG9uZSBvZiB0aGUgcmVxdWVzdC5cbiAgICovXG4gIGFzeW5jIHBhcnNlR3JhcGhRTFJlcXVlc3RPckdldEZyb21DYWNoZShcbiAgICByZXF1ZXN0OiBSZXF1ZXN0LFxuICApOiBQcm9taXNlPFBhcnNlZEdyYXBoUUxSZXF1ZXN0PEdyYXBoUUxWYXJpYWJsZXM+PiB7XG4gICAgaWYgKCFHcmFwaFFMSGFuZGxlci5wYXJzZWRSZXF1ZXN0Q2FjaGUuaGFzKHJlcXVlc3QpKSB7XG4gICAgICBHcmFwaFFMSGFuZGxlci5wYXJzZWRSZXF1ZXN0Q2FjaGUuc2V0KFxuICAgICAgICByZXF1ZXN0LFxuICAgICAgICBhd2FpdCBwYXJzZUdyYXBoUUxSZXF1ZXN0KHJlcXVlc3QpLmNhdGNoKChlcnJvcikgPT4ge1xuICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpXG4gICAgICAgICAgcmV0dXJuIHVuZGVmaW5lZFxuICAgICAgICB9KSxcbiAgICAgIClcbiAgICB9XG5cbiAgICByZXR1cm4gR3JhcGhRTEhhbmRsZXIucGFyc2VkUmVxdWVzdENhY2hlLmdldChyZXF1ZXN0KVxuICB9XG5cbiAgYXN5bmMgcGFyc2UoYXJnczogeyByZXF1ZXN0OiBSZXF1ZXN0IH0pOiBQcm9taXNlPEdyYXBoUUxSZXF1ZXN0UGFyc2VkUmVzdWx0PiB7XG4gICAgLyoqXG4gICAgICogSWYgdGhlIHJlcXVlc3QgZG9lc24ndCBtYXRjaCBhIHNwZWNpZmllZCBlbmRwb2ludCwgdGhlcmUncyBub1xuICAgICAqIG5lZWQgdG8gcGFyc2UgaXQgc2luY2UgdGhlcmUncyBubyBjYXNlIHdoZXJlIHdlIHdvdWxkIGhhbmRsZSB0aGlzXG4gICAgICovXG4gICAgY29uc3QgbWF0Y2ggPSBtYXRjaFJlcXVlc3RVcmwobmV3IFVSTChhcmdzLnJlcXVlc3QudXJsKSwgdGhpcy5lbmRwb2ludClcbiAgICBjb25zdCBjb29raWVzID0gZ2V0QWxsUmVxdWVzdENvb2tpZXMoYXJncy5yZXF1ZXN0KVxuXG4gICAgaWYgKCFtYXRjaC5tYXRjaGVzKSB7XG4gICAgICByZXR1cm4ge1xuICAgICAgICBtYXRjaCxcbiAgICAgICAgY29va2llcyxcbiAgICAgIH1cbiAgICB9XG5cbiAgICBjb25zdCBwYXJzZWRSZXN1bHQgPSBhd2FpdCB0aGlzLnBhcnNlR3JhcGhRTFJlcXVlc3RPckdldEZyb21DYWNoZShcbiAgICAgIGFyZ3MucmVxdWVzdCxcbiAgICApXG5cbiAgICBpZiAodHlwZW9mIHBhcnNlZFJlc3VsdCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgIHJldHVybiB7XG4gICAgICAgIG1hdGNoLFxuICAgICAgICBjb29raWVzLFxuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICBtYXRjaCxcbiAgICAgIGNvb2tpZXMsXG4gICAgICBxdWVyeTogcGFyc2VkUmVzdWx0LnF1ZXJ5LFxuICAgICAgb3BlcmF0aW9uVHlwZTogcGFyc2VkUmVzdWx0Lm9wZXJhdGlvblR5cGUsXG4gICAgICBvcGVyYXRpb25OYW1lOiBwYXJzZWRSZXN1bHQub3BlcmF0aW9uTmFtZSxcbiAgICAgIHZhcmlhYmxlczogcGFyc2VkUmVzdWx0LnZhcmlhYmxlcyxcbiAgICB9XG4gIH1cblxuICBhc3luYyBwcmVkaWNhdGUoYXJnczoge1xuICAgIHJlcXVlc3Q6IFJlcXVlc3RcbiAgICBwYXJzZWRSZXN1bHQ6IEdyYXBoUUxSZXF1ZXN0UGFyc2VkUmVzdWx0XG4gIH0pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAoYXJncy5wYXJzZWRSZXN1bHQub3BlcmF0aW9uVHlwZSA9PT0gdW5kZWZpbmVkKSB7XG4gICAgICByZXR1cm4gZmFsc2VcbiAgICB9XG5cbiAgICBpZiAoIWFyZ3MucGFyc2VkUmVzdWx0Lm9wZXJhdGlvbk5hbWUgJiYgdGhpcy5pbmZvLm9wZXJhdGlvblR5cGUgIT09ICdhbGwnKSB7XG4gICAgICBjb25zdCBwdWJsaWNVcmwgPSB0b1B1YmxpY1VybChhcmdzLnJlcXVlc3QudXJsKVxuXG4gICAgICBkZXZVdGlscy53YXJuKGBcXFxuRmFpbGVkIHRvIGludGVyY2VwdCBhIEdyYXBoUUwgcmVxdWVzdCBhdCBcIiR7YXJncy5yZXF1ZXN0Lm1ldGhvZH0gJHtwdWJsaWNVcmx9XCI6IGFub255bW91cyBHcmFwaFFMIG9wZXJhdGlvbnMgYXJlIG5vdCBzdXBwb3J0ZWQuXG5cbkNvbnNpZGVyIG5hbWluZyB0aGlzIG9wZXJhdGlvbiBvciB1c2luZyBcImdyYXBocWwub3BlcmF0aW9uKClcIiByZXF1ZXN0IGhhbmRsZXIgdG8gaW50ZXJjZXB0IEdyYXBoUUwgcmVxdWVzdHMgcmVnYXJkbGVzcyBvZiB0aGVpciBvcGVyYXRpb24gbmFtZS90eXBlLiBSZWFkIG1vcmU6IGh0dHBzOi8vbXN3anMuaW8vZG9jcy9hcGkvZ3JhcGhxbC8jZ3JhcGhxbG9wZXJhdGlvbnJlc29sdmVyYClcbiAgICAgIHJldHVybiBmYWxzZVxuICAgIH1cblxuICAgIGNvbnN0IGhhc01hdGNoaW5nT3BlcmF0aW9uVHlwZSA9XG4gICAgICB0aGlzLmluZm8ub3BlcmF0aW9uVHlwZSA9PT0gJ2FsbCcgfHxcbiAgICAgIGFyZ3MucGFyc2VkUmVzdWx0Lm9wZXJhdGlvblR5cGUgPT09IHRoaXMuaW5mby5vcGVyYXRpb25UeXBlXG5cbiAgICAvKipcbiAgICAgKiBDaGVjayBpZiB0aGUgb3BlcmF0aW9uIG5hbWUgbWF0Y2hlcyB0aGUgb3V0Z29pbmcgR3JhcGhRTCByZXF1ZXN0LlxuICAgICAqIEBub3RlIFVubGlrZSB0aGUgSFRUUCBoYW5kbGVyLCB0aGUgY3VzdG9tIHByZWRpY2F0ZSBmdW5jdGlvbnMgYXJlIGludm9rZWRcbiAgICAgKiBkdXJpbmcgcHJlZGljYXRlLCBub3QgcGFyc2luZywgYmVjYXVzZSBHcmFwaFFMIHJlcXVlc3QgcGFyc2luZyBoYXBwZW5zIGZpcnN0LFxuICAgICAqIGFuZCBub24tR3JhcGhRTCByZXF1ZXN0cyBhcmUgZmlsdGVyZWQgb3V0IGF1dG9tYXRpY2FsbHkuXG4gICAgICovXG4gICAgY29uc3QgaGFzTWF0Y2hpbmdPcGVyYXRpb25OYW1lID0gYXdhaXQgdGhpcy5tYXRjaE9wZXJhdGlvbk5hbWUoe1xuICAgICAgcmVxdWVzdDogYXJncy5yZXF1ZXN0LFxuICAgICAgcGFyc2VkUmVzdWx0OiBhcmdzLnBhcnNlZFJlc3VsdCxcbiAgICB9KVxuXG4gICAgcmV0dXJuIChcbiAgICAgIGFyZ3MucGFyc2VkUmVzdWx0Lm1hdGNoLm1hdGNoZXMgJiZcbiAgICAgIGhhc01hdGNoaW5nT3BlcmF0aW9uVHlwZSAmJlxuICAgICAgaGFzTWF0Y2hpbmdPcGVyYXRpb25OYW1lXG4gICAgKVxuICB9XG5cbiAgcHJpdmF0ZSBhc3luYyBtYXRjaE9wZXJhdGlvbk5hbWUoYXJnczoge1xuICAgIHJlcXVlc3Q6IFJlcXVlc3RcbiAgICBwYXJzZWRSZXN1bHQ6IEdyYXBoUUxSZXF1ZXN0UGFyc2VkUmVzdWx0XG4gIH0pOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgICBpZiAodHlwZW9mIHRoaXMuaW5mby5vcGVyYXRpb25OYW1lID09PSAnZnVuY3Rpb24nKSB7XG4gICAgICBjb25zdCBjdXN0b21QcmVkaWNhdGVSZXN1bHQgPSBhd2FpdCB0aGlzLmluZm8ub3BlcmF0aW9uTmFtZSh7XG4gICAgICAgIHJlcXVlc3Q6IGFyZ3MucmVxdWVzdCxcbiAgICAgICAgLi4udGhpcy5leHRlbmRSZXNvbHZlckFyZ3Moe1xuICAgICAgICAgIHJlcXVlc3Q6IGFyZ3MucmVxdWVzdCxcbiAgICAgICAgICBwYXJzZWRSZXN1bHQ6IGFyZ3MucGFyc2VkUmVzdWx0LFxuICAgICAgICB9KSxcbiAgICAgIH0pXG5cbiAgICAgIC8qKlxuICAgICAgICogQG5vdGUgS2VlcCB0aGUgeyBtYXRjaGVzIH0gc2lnbmF0dXJlIGluIGNhc2Ugd2UgZGVjaWRlIHRvIHN1cHBvcnQgcGF0aCBwYXJhbWV0ZXJzXG4gICAgICAgKiBpbiBHcmFwaFFMIGhhbmRsZXJzLiBJZiB0aGF0IGhhcHBlbnMsIHRoZSBjdXN0b20gcHJlZGljYXRlIHdvdWxkIGhhdmUgdG8gYmUgbW92ZWRcbiAgICAgICAqIHRvIHRoZSBwYXJzaW5nIHBoYXNlLCB0aGUgc2FtZSBhcyB3ZSBoYXZlIGZvciB0aGUgSHR0cEhhbmRsZXIsIGFuZCB0aGUgdXNlciB3aWxsXG4gICAgICAgKiBoYXZlIGEgcG9zc2liaWxpdHkgdG8gcmV0dXJuIHBhcnNlZCBwYXRoIHBhcmFtZXRlcnMgZnJvbSB0aGUgY3VzdG9tIHByZWRpY2F0ZS5cbiAgICAgICAqL1xuICAgICAgcmV0dXJuIHR5cGVvZiBjdXN0b21QcmVkaWNhdGVSZXN1bHQgPT09ICdib29sZWFuJ1xuICAgICAgICA/IGN1c3RvbVByZWRpY2F0ZVJlc3VsdFxuICAgICAgICA6IGN1c3RvbVByZWRpY2F0ZVJlc3VsdC5tYXRjaGVzXG4gICAgfVxuXG4gICAgaWYgKHRoaXMuaW5mby5vcGVyYXRpb25OYW1lIGluc3RhbmNlb2YgUmVnRXhwKSB7XG4gICAgICByZXR1cm4gdGhpcy5pbmZvLm9wZXJhdGlvbk5hbWUudGVzdChhcmdzLnBhcnNlZFJlc3VsdC5vcGVyYXRpb25OYW1lIHx8ICcnKVxuICAgIH1cblxuICAgIHJldHVybiBhcmdzLnBhcnNlZFJlc3VsdC5vcGVyYXRpb25OYW1lID09PSB0aGlzLmluZm8ub3BlcmF0aW9uTmFtZVxuICB9XG5cbiAgcHJvdGVjdGVkIGV4dGVuZFJlc29sdmVyQXJncyhhcmdzOiB7XG4gICAgcmVxdWVzdDogUmVxdWVzdFxuICAgIHBhcnNlZFJlc3VsdDogR3JhcGhRTFJlcXVlc3RQYXJzZWRSZXN1bHRcbiAgfSkge1xuICAgIHJldHVybiB7XG4gICAgICBxdWVyeTogYXJncy5wYXJzZWRSZXN1bHQucXVlcnkgfHwgJycsXG4gICAgICBvcGVyYXRpb25UeXBlOiBhcmdzLnBhcnNlZFJlc3VsdC5vcGVyYXRpb25UeXBlISxcbiAgICAgIG9wZXJhdGlvbk5hbWU6IGFyZ3MucGFyc2VkUmVzdWx0Lm9wZXJhdGlvbk5hbWUgfHwgJycsXG4gICAgICB2YXJpYWJsZXM6IGFyZ3MucGFyc2VkUmVzdWx0LnZhcmlhYmxlcyB8fCB7fSxcbiAgICAgIGNvb2tpZXM6IGFyZ3MucGFyc2VkUmVzdWx0LmNvb2tpZXMsXG4gICAgfVxuICB9XG5cbiAgYXN5bmMgbG9nKGFyZ3M6IHtcbiAgICByZXF1ZXN0OiBSZXF1ZXN0XG4gICAgcmVzcG9uc2U6IFJlc3BvbnNlXG4gICAgcGFyc2VkUmVzdWx0OiBHcmFwaFFMUmVxdWVzdFBhcnNlZFJlc3VsdFxuICB9KSB7XG4gICAgY29uc3QgbG9nZ2VkUmVxdWVzdCA9IGF3YWl0IHNlcmlhbGl6ZVJlcXVlc3QoYXJncy5yZXF1ZXN0KVxuICAgIGNvbnN0IGxvZ2dlZFJlc3BvbnNlID0gYXdhaXQgc2VyaWFsaXplUmVzcG9uc2UoYXJncy5yZXNwb25zZSlcbiAgICBjb25zdCBzdGF0dXNDb2xvciA9IGdldFN0YXR1c0NvZGVDb2xvcihsb2dnZWRSZXNwb25zZS5zdGF0dXMpXG4gICAgY29uc3QgcmVxdWVzdEluZm8gPSBhcmdzLnBhcnNlZFJlc3VsdC5vcGVyYXRpb25OYW1lXG4gICAgICA/IGAke2FyZ3MucGFyc2VkUmVzdWx0Lm9wZXJhdGlvblR5cGV9ICR7YXJncy5wYXJzZWRSZXN1bHQub3BlcmF0aW9uTmFtZX1gXG4gICAgICA6IGBhbm9ueW1vdXMgJHthcmdzLnBhcnNlZFJlc3VsdC5vcGVyYXRpb25UeXBlfWBcblxuICAgIGNvbnNvbGUuZ3JvdXBDb2xsYXBzZWQoXG4gICAgICBkZXZVdGlscy5mb3JtYXRNZXNzYWdlKFxuICAgICAgICBgJHtnZXRUaW1lc3RhbXAoKX0gJHtyZXF1ZXN0SW5mb30gKCVjJHtsb2dnZWRSZXNwb25zZS5zdGF0dXN9ICR7XG4gICAgICAgICAgbG9nZ2VkUmVzcG9uc2Uuc3RhdHVzVGV4dFxuICAgICAgICB9JWMpYCxcbiAgICAgICksXG4gICAgICBgY29sb3I6JHtzdGF0dXNDb2xvcn1gLFxuICAgICAgJ2NvbG9yOmluaGVyaXQnLFxuICAgIClcbiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tY29uc29sZVxuICAgIGNvbnNvbGUubG9nKCdSZXF1ZXN0OicsIGxvZ2dlZFJlcXVlc3QpXG4gICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGVcbiAgICBjb25zb2xlLmxvZygnSGFuZGxlcjonLCB0aGlzKVxuICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb25zb2xlXG4gICAgY29uc29sZS5sb2coJ1Jlc3BvbnNlOicsIGxvZ2dlZFJlc3BvbnNlKVxuICAgIGNvbnNvbGUuZ3JvdXBFbmQoKVxuICB9XG59XG4iXSwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7Ozs7OztBQUFBLElBQUFBLHNCQUFBO0FBQUFDLFFBQUEsQ0FBQUQsc0JBQUE7RUFBQUUsY0FBQSxFQUFBQSxDQUFBLEtBQUFBLGNBQUE7RUFBQUMsY0FBQSxFQUFBQSxDQUFBLEtBQUFBO0FBQUE7QUFBQUMsTUFBQSxDQUFBQyxPQUFBLEdBQUFDLFlBQUEsQ0FBQU4sc0JBQUE7QUFDQSxJQUFBTyxxQkFBQSxHQU1PQyxPQUFBO0FBQ1AsSUFBQUMsbUJBQUEsR0FBNkJELE9BQUE7QUFDN0IsSUFBQUUseUJBQUEsR0FBbUNGLE9BQUE7QUFDbkMsSUFBQUcsdUJBQUEsR0FBaUNILE9BQUE7QUFDakMsSUFBQUksd0JBQUEsR0FBa0NKLE9BQUE7QUFDbEMsSUFBQUssc0JBQUEsR0FBNkNMLE9BQUE7QUFDN0MsSUFBQU0s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