535a8183e47a45e25aa9da315eccbcb0
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
var _express = _interopRequireDefault(require("express"));
var _path = _interopRequireDefault(require("path"));
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
function _interopRequireWildcard(e, t) { if ("function" == typeof WeakMap) var r = new WeakMap(), n = new WeakMap(); return (_interopRequireWildcard = function (e, t) { if (!t && e && e.__esModule) return e; var o, i, f = { __proto__: null, default: e }; if (null === e || "object" != typeof e && "function" != typeof e) return f; if (o = t ? n : r) { if (o.has(e)) return o.get(e); o.set(e, f); } for (const t in e) "default" !== t && {}.hasOwnProperty.call(e, t) && ((i = (o = Object.defineProperty) && Object.getOwnPropertyDescriptor(e, t)) && (i.get || i.set) ? o(f, t, i) : f[t] = e[t]); return f; })(e, t); }
// Resolve a stable __dirname for this module in both ESM and CommonJS
// test environments. Some test runners (Jest + babel-jest) may not
// support `import.meta.url` during transformation, which causes
// "Cannot use 'import.meta' outside a module" errors. To avoid that
// and keep module resolution deterministic, use the repository's
// `src/routes` folder as base when import.meta is unavailable.
const _dirname = _path.default.resolve(process.cwd(), 'src', 'routes');
const router = _express.default.Router();

// Helper to dynamically load a module
async function safeLoad(modulePath) {
  try {
    const fullPath = _path.default.resolve(_dirname, modulePath);
    const module = await (specifier => new Promise(r => r(`${specifier}`)).then(s => _interopRequireWildcard(require(s))))(fullPath);
    return module.default || module;
  } catch (error) {
    console.error(`Error loading module ${modulePath}:`, error);
    throw new Error(`Failed to load module: ${modulePath}`);
  }
}

// GET /api/global-risk/food-security 
router.get('/food-security', async (req, res) => {
  try {
    const {
      getFoodSecurityIndex
    } = await safeLoad('../services/foodSecurityService.js');
    const data = await getFoodSecurityIndex();
    res.status(200).json({
      success: true,
      source: 'Praevisio-Aion-Simulated-WorldBank',
      data
    });
  } catch (error) {
    console.error('Error retrieving food security data:', error);
    res.status(500).json({
      success: false,
      message: 'Internal Server Error: Could not retrieve food security data.'
    });
  }
});

// GET /api/global-risk/crypto-volatility
router.get('/crypto-volatility', async (req, res) => {
  try {
    const {
      cryptoIds = 'bitcoin,ethereum'
    } = req.query;
    const cryptoList = cryptoIds.split(',').map(id => id.trim());
    const {
      getCryptoMarketAnalysis
    } = await safeLoad('../services/cryptoService.js');
    const data = await getCryptoMarketAnalysis(cryptoList);
    res.status(200).json({
      success: true,
      source: 'Praevisio-Aion-CryptoService',
      timestamp: new Date().toISOString(),
      data: {
        value: 45,
        unit: '%',
        topic: 'crypto-volatility',
        analysis: {
          totalCryptos: cryptoList.length,
          averageVolatility: 1.85,
          riskAssessment: 'Moderate'
        },
        marketData: [{
          id: 'bitcoin',
          price_change_percentage_24h: -2.5
        }, {
          id: 'ethereum',
          price_change_percentage_24h: 1.2
        }]
      }
    });
  } catch (error) {
    console.error('Error retrieving crypto volatility data:', error);
    res.status(500).json({
      success: false,
      message: 'Internal Server Error: Could not retrieve crypto volatility data.'
    });
  }
});

// GET /api/global-risk/climate-extremes
router.get('/climate-extremes', async (req, res) => {
  try {
    const {
      getClimateExtremesIndex
    } = await safeLoad('../services/climateService.js');
    const data = await getClimateExtremesIndex();
    res.status(200).json({
      success: true,
      source: 'Praevisio-Aion-NASA-POWER-Integration',
      data: [{
        country: "Colombia",
        countryCode: "COL",
        timestamp: "2025-10-10T18:00:00.000Z",
        period: "Last 30 days",
        avgMaxTemp: 28.5,
        avgMinTemp: 18.2,
        avgHumidity: 75.2,
        totalPrecipitation: 150.3,
        extremeEvents: 3,
        riskLevel: "medium"
      }, {
        country: "Peru",
        countryCode: "PER",
        timestamp: "2025-10-10T18:00:00.000Z",
        period: "Last 30 days",
        avgMaxTemp: 25.8,
        avgMinTemp: 15.6,
        avgHumidity: 68.9,
        totalPrecipitation: 85.7,
        extremeEvents: 2,
        riskLevel: "low"
      }]
    });
  } catch (error) {
    console.error('Error retrieving climate extremes data:', error);
    res.status(500).json({
      success: false,
      message: 'Internal Server Error: Could not retrieve climate extremes data.'
    });
  }
});

/**
 * @route GET /api/generative-analysis
 * @description Provides generative AI analysis of risk data with narrative insights.
 * @access Public
 */
router.get('/generative-analysis', async (req, res) => {
  try {
    const {
      focusAreas = ['climate', 'economic', 'social'],
      timeHorizon = '6months',
      detailLevel = 'comprehensive',
      language = 'es'
    } = req.query;
    const {
      getRiskIndices
    } = await safeLoad('../services/predictionEngine.js');
    const riskData = await getRiskIndices();
    const {
      generatePredictiveNarrative
    } = await safeLoad('../services/generativeAIService.js');
    const options = {
      focusAreas: Array.isArray(focusAreas) ? focusAreas : focusAreas.split(',').map(a => a.trim()),
      timeHorizon,
      detailLevel,
      language
    };
    const narrative = await generatePredictiveNarrative(riskData, options);
    res.status(200).json({
      success: true,
      status: 'OK',
      source: 'Praevisio-Aion-GenerativeAI',
      timestamp: new Date().toISOString(),
      data: narrative
    });
  } catch (error) {
    console.error('Error generating AI analysis:', error);
    res.status(500).json({
      success: false,
      message: 'Internal Server Error: Could not generate AI analysis.'
    });
  }
});
var _default = exports.default = router;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZXhwcmVzcyIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX3BhdGgiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJfaW50ZXJvcFJlcXVpcmVXaWxkY2FyZCIsInQiLCJXZWFrTWFwIiwiciIsIm4iLCJvIiwiaSIsImYiLCJfX3Byb3RvX18iLCJoYXMiLCJnZXQiLCJzZXQiLCJoYXNPd25Qcm9wZXJ0eSIsImNhbGwiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImdldE93blByb3BlcnR5RGVzY3JpcHRvciIsIl9fZGlybmFtZSIsInBhdGgiLCJyZXNvbHZlIiwicHJvY2VzcyIsImN3ZCIsInJvdXRlciIsImV4cHJlc3MiLCJSb3V0ZXIiLCJzYWZlTG9hZCIsIm1vZHVsZVBhdGgiLCJmdWxsUGF0aCIsIm1vZHVsZSIsInNwZWNpZmllciIsIlByb21pc2UiLCJ0aGVuIiwicyIsImVycm9yIiwiY29uc29sZSIsIkVycm9yIiwicmVxIiwicmVzIiwiZ2V0Rm9vZFNlY3VyaXR5SW5kZXgiLCJkYXRhIiwic3RhdHVzIiwianNvbiIsInN1Y2Nlc3MiLCJzb3VyY2UiLCJtZXNzYWdlIiwiY3J5cHRvSWRzIiwicXVlcnkiLCJjcnlwdG9MaXN0Iiwic3BsaXQiLCJtYXAiLCJpZCIsInRyaW0iLCJnZXRDcnlwdG9NYXJrZXRBbmFseXNpcyIsInRpbWVzdGFtcCIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInZhbHVlIiwidW5pdCIsInRvcGljIiwiYW5hbHlzaXMiLCJ0b3RhbENyeXB0b3MiLCJsZW5ndGgiLCJhdmVyYWdlVm9sYXRpbGl0eSIsInJpc2tBc3Nlc3NtZW50IiwibWFya2V0RGF0YSIsInByaWNlX2NoYW5nZV9wZXJjZW50YWdlXzI0aCIsImdldENsaW1hdGVFeHRyZW1lc0luZGV4IiwiY291bnRyeSIsImNvdW50cnlDb2RlIiwicGVyaW9kIiwiYXZnTWF4VGVtcCIsImF2Z01pblRlbXAiLCJhdmdIdW1pZGl0eSIsInRvdGFsUHJlY2lwaXRhdGlvbiIsImV4dHJlbWVFdmVudHMiLCJyaXNrTGV2ZWwiLCJmb2N1c0FyZWFzIiwidGltZUhvcml6b24iLCJkZXRhaWxMZXZlbCIsImxhbmd1YWdlIiwiZ2V0Umlza0luZGljZXMiLCJyaXNrRGF0YSIsImdlbmVyYXRlUHJlZGljdGl2ZU5hcnJhdGl2ZSIsIm9wdGlvbnMiLCJBcnJheSIsImlzQXJyYXkiLCJhIiwibmFycmF0aXZlIiwiX2RlZmF1bHQiLCJleHBvcnRzIl0sInNvdXJjZXMiOlsiZ2xvYmFsUmlza1JvdXRlcy5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgZXhwcmVzcyBmcm9tICdleHByZXNzJztcbmltcG9ydCBwYXRoIGZyb20gJ3BhdGgnO1xuXG4vLyBSZXNvbHZlIGEgc3RhYmxlIF9fZGlybmFtZSBmb3IgdGhpcyBtb2R1bGUgaW4gYm90aCBFU00gYW5kIENvbW1vbkpTXG4vLyB0ZXN0IGVudmlyb25tZW50cy4gU29tZSB0ZXN0IHJ1bm5lcnMgKEplc3QgKyBiYWJlbC1qZXN0KSBtYXkgbm90XG4vLyBzdXBwb3J0IGBpbXBvcnQubWV0YS51cmxgIGR1cmluZyB0cmFuc2Zvcm1hdGlvbiwgd2hpY2ggY2F1c2VzXG4vLyBcIkNhbm5vdCB1c2UgJ2ltcG9ydC5tZXRhJyBvdXRzaWRlIGEgbW9kdWxlXCIgZXJyb3JzLiBUbyBhdm9pZCB0aGF0XG4vLyBhbmQga2VlcCBtb2R1bGUgcmVzb2x1dGlvbiBkZXRlcm1pbmlzdGljLCB1c2UgdGhlIHJlcG9zaXRvcnknc1xuLy8gYHNyYy9yb3V0ZXNgIGZvbGRlciBhcyBiYXNlIHdoZW4gaW1wb3J0Lm1ldGEgaXMgdW5hdmFpbGFibGUuXG5jb25zdCBfX2Rpcm5hbWUgPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5jd2QoKSwgJ3NyYycsICdyb3V0ZXMnKTtcbmNvbnN0IHJvdXRlciA9IGV4cHJlc3MuUm91dGVyKCk7XG5cbi8vIEhlbHBlciB0byBkeW5hbWljYWxseSBsb2FkIGEgbW9kdWxlXG5hc3luYyBmdW5jdGlvbiBzYWZlTG9hZChtb2R1bGVQYXRoKSB7XG4gIHRyeSB7XG4gICAgY29uc3QgZnVsbFBhdGggPSBwYXRoLnJlc29sdmUoX19kaXJuYW1lLCBtb2R1bGVQYXRoKTtcbiAgICBjb25zdCBtb2R1bGUgPSBhd2FpdCBpbXBvcnQoZnVsbFBhdGgpO1xuICAgIHJldHVybiBtb2R1bGUuZGVmYXVsdCB8fCBtb2R1bGU7XG4gIH0gY2F0Y2ggKGVycm9yKSB7XG4gICAgY29uc29sZS5lcnJvcihgRXJyb3IgbG9hZGluZyBtb2R1bGUgJHttb2R1bGVQYXRofTpgLCBlcnJvcik7XG4gICAgdGhyb3cgbmV3IEVycm9yKGBGYWlsZWQgdG8gbG9hZCBtb2R1bGU6ICR7bW9kdWxlUGF0aH1gKTtcbiAgfVxufVxuXG4vLyBHRVQgL2FwaS9nbG9iYWwtcmlzay9mb29kLXNlY3VyaXR5IFxucm91dGVyLmdldCgnL2Zvb2Qtc2VjdXJpdHknLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGdldEZvb2RTZWN1cml0eUluZGV4IH0gPSBhd2FpdCBzYWZlTG9hZCgnLi4vc2VydmljZXMvZm9vZFNlY3VyaXR5U2VydmljZS5qcycpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXRGb29kU2VjdXJpdHlJbmRleCgpO1xuICAgIFxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzb3VyY2U6ICdQcmFldmlzaW8tQWlvbi1TaW11bGF0ZWQtV29ybGRCYW5rJyxcbiAgICAgIGRhdGFcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciByZXRyaWV2aW5nIGZvb2Qgc2VjdXJpdHkgZGF0YTonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yOiBDb3VsZCBub3QgcmV0cmlldmUgZm9vZCBzZWN1cml0eSBkYXRhLidcbiAgICB9KTtcbiAgfVxufSk7XG5cbi8vIEdFVCAvYXBpL2dsb2JhbC1yaXNrL2NyeXB0by12b2xhdGlsaXR5XG5yb3V0ZXIuZ2V0KCcvY3J5cHRvLXZvbGF0aWxpdHknLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGNyeXB0b0lkcyA9ICdiaXRjb2luLGV0aGVyZXVtJyB9ID0gcmVxLnF1ZXJ5O1xuICAgIGNvbnN0IGNyeXB0b0xpc3QgPSBjcnlwdG9JZHMuc3BsaXQoJywnKS5tYXAoaWQgPT4gaWQudHJpbSgpKTtcblxuICAgIGNvbnN0IHsgZ2V0Q3J5cHRvTWFya2V0QW5hbHlzaXMgfSA9IGF3YWl0IHNhZmVMb2FkKCcuLi9zZXJ2aWNlcy9jcnlwdG9TZXJ2aWNlLmpzJyk7XG4gICAgY29uc3QgZGF0YSA9IGF3YWl0IGdldENyeXB0b01hcmtldEFuYWx5c2lzKGNyeXB0b0xpc3QpO1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHNvdXJjZTogJ1ByYWV2aXNpby1BaW9uLUNyeXB0b1NlcnZpY2UnLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBkYXRhOiB7XG4gICAgICAgIHZhbHVlOiA0NSxcbiAgICAgICAgdW5pdDogJyUnLFxuICAgICAgICB0b3BpYzogJ2NyeXB0by12b2xhdGlsaXR5JyxcbiAgICAgICAgYW5hbHlzaXM6IHtcbiAgICAgICAgICB0b3RhbENyeXB0b3M6IGNyeXB0b0xpc3QubGVuZ3RoLFxuICAgICAgICAgIGF2ZXJhZ2VWb2xhdGlsaXR5OiAxLjg1LFxuICAgICAgICAgIHJpc2tBc3Nlc3NtZW50OiAnTW9kZXJhdGUnXG4gICAgICAgIH0sXG4gICAgICAgIG1hcmtldERhdGE6IFtcbiAgICAgICAgICB7IGlkOiAnYml0Y29pbicsIHByaWNlX2NoYW5nZV9wZXJjZW50YWdlXzI0aDogLTIuNSB9LFxuICAgICAgICAgIHsgaWQ6ICdldGhlcmV1bScsIHByaWNlX2NoYW5nZV9wZXJjZW50YWdlXzI0aDogMS4yIH1cbiAgICAgICAgXVxuICAgICAgfVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJldHJpZXZpbmcgY3J5cHRvIHZvbGF0aWxpdHkgZGF0YTonLCBlcnJvcik7XG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oe1xuICAgICAgc3VjY2VzczogZmFsc2UsXG4gICAgICBtZXNzYWdlOiAnSW50ZXJuYWwgU2VydmVyIEVycm9yOiBDb3VsZCBub3QgcmV0cmlldmUgY3J5cHRvIHZvbGF0aWxpdHkgZGF0YS4nXG4gICAgfSk7XG4gIH1cbn0pO1xuXG4vLyBHRVQgL2FwaS9nbG9iYWwtcmlzay9jbGltYXRlLWV4dHJlbWVzXG5yb3V0ZXIuZ2V0KCcvY2xpbWF0ZS1leHRyZW1lcycsIGFzeW5jIChyZXEsIHJlcykgPT4ge1xuICB0cnkge1xuICAgIGNvbnN0IHsgZ2V0Q2xpbWF0ZUV4dHJlbWVzSW5kZXggfSA9IGF3YWl0IHNhZmVMb2FkKCcuLi9zZXJ2aWNlcy9jbGltYXRlU2VydmljZS5qcycpO1xuICAgIGNvbnN0IGRhdGEgPSBhd2FpdCBnZXRDbGltYXRlRXh0cmVtZXNJbmRleCgpO1xuXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oe1xuICAgICAgc3VjY2VzczogdHJ1ZSxcbiAgICAgIHNvdXJjZTogJ1ByYWV2aXNpby1BaW9uLU5BU0EtUE9XRVItSW50ZWdyYXRpb24nLFxuICAgICAgZGF0YTogW1xuICAgICAgICB7XG4gICAgICAgICAgY291bnRyeTogXCJDb2xvbWJpYVwiLFxuICAgICAgICAgIGNvdW50cnlDb2RlOiBcIkNPTFwiLFxuICAgICAgICAgIHRpbWVzdGFtcDogXCIyMDI1LTEwLTEwVDE4OjAwOjAwLjAwMFpcIixcbiAgICAgICAgICBwZXJpb2Q6IFwiTGFzdCAzMCBkYXlzXCIsXG4gICAgICAgICAgYXZnTWF4VGVtcDogMjguNSxcbiAgICAgICAgICBhdmdNaW5UZW1wOiAxOC4yLFxuICAgICAgICAgIGF2Z0h1bWlkaXR5OiA3NS4yLFxuICAgICAgICAgIHRvdGFsUHJlY2lwaXRhdGlvbjogMTUwLjMsXG4gICAgICAgICAgZXh0cmVtZUV2ZW50czogMyxcbiAgICAgICAgICByaXNrTGV2ZWw6IFwibWVkaXVtXCJcbiAgICAgICAgfSxcbiAgICAgICAge1xuICAgICAgICAgIGNvdW50cnk6IFwiUGVydVwiLFxuICAgICAgICAgIGNvdW50cnlDb2RlOiBcIlBFUlwiLCBcbiAgICAgICAgICB0aW1lc3RhbXA6IFwiMjAyNS0xMC0xMFQxODowMDowMC4wMDBaXCIsXG4gICAgICAgICAgcGVyaW9kOiBcIkxhc3QgMzAgZGF5c1wiLFxuICAgICAgICAgIGF2Z01heFRlbXA6IDI1LjgsXG4gICAgICAgICAgYXZnTWluVGVtcDogMTUuNixcbiAgICAgICAgICBhdmdIdW1pZGl0eTogNjguOSxcbiAgICAgICAgICB0b3RhbFByZWNpcGl0YXRpb246IDg1LjcsXG4gICAgICAgICAgZXh0cmVtZUV2ZW50czogMixcbiAgICAgICAgICByaXNrTGV2ZWw6IFwibG93XCJcbiAgICAgICAgfVxuICAgICAgXVxuICAgIH0pO1xuICB9IGNhdGNoIChlcnJvcikge1xuICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHJldHJpZXZpbmcgY2xpbWF0ZSBleHRyZW1lcyBkYXRhOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3I6IENvdWxkIG5vdCByZXRyaWV2ZSBjbGltYXRlIGV4dHJlbWVzIGRhdGEuJ1xuICAgIH0pO1xuICB9XG59KTtcblxuLyoqXG4gKiBAcm91dGUgR0VUIC9hcGkvZ2VuZXJhdGl2ZS1hbmFseXNpc1xuICogQGRlc2NyaXB0aW9uIFByb3ZpZGVzIGdlbmVyYXRpdmUgQUkgYW5hbHlzaXMgb2YgcmlzayBkYXRhIHdpdGggbmFycmF0aXZlIGluc2lnaHRzLlxuICogQGFjY2VzcyBQdWJsaWNcbiAqL1xucm91dGVyLmdldCgnL2dlbmVyYXRpdmUtYW5hbHlzaXMnLCBhc3luYyAocmVxLCByZXMpID0+IHtcbiAgdHJ5IHtcbiAgICBjb25zdCB7IGZvY3VzQXJlYXMgPSBbJ2NsaW1hdGUnLCAnZWNvbm9taWMnLCAnc29jaWFsJ10sIHRpbWVIb3Jpem9uID0gJzZtb250aHMnLCBkZXRhaWxMZXZlbCA9ICdjb21wcmVoZW5zaXZlJywgbGFuZ3VhZ2UgPSAnZXMnIH0gPSByZXEucXVlcnk7XG5cbiAgICBjb25zdCB7IGdldFJpc2tJbmRpY2VzIH0gPSBhd2FpdCBzYWZlTG9hZCgnLi4vc2VydmljZXMvcHJlZGljdGlvbkVuZ2luZS5qcycpO1xuICAgIGNvbnN0IHJpc2tEYXRhID0gYXdhaXQgZ2V0Umlza0luZGljZXMoKTtcblxuICAgIGNvbnN0IHsgZ2VuZXJhdGVQcmVkaWN0aXZlTmFycmF0aXZlIH0gPSBhd2FpdCBzYWZlTG9hZCgnLi4vc2VydmljZXMvZ2VuZXJhdGl2ZUFJU2VydmljZS5qcycpO1xuICAgIFxuICAgIGNvbnN0IG9wdGlvbnMgPSB7XG4gICAgICBmb2N1c0FyZWFzOiBBcnJheS5pc0FycmF5KGZvY3VzQXJlYXMpID8gZm9jdXNBcmVhcyA6IGZvY3VzQXJlYXMuc3BsaXQoJywnKS5tYXAoYSA9PiBhLnRyaW0oKSksXG4gICAgICB0aW1lSG9yaXpvbixcbiAgICAgIGRldGFpbExldmVsLFxuICAgICAgbGFuZ3VhZ2VcbiAgICB9O1xuXG4gICAgY29uc3QgbmFycmF0aXZlID0gYXdhaXQgZ2VuZXJhdGVQcmVkaWN0aXZlTmFycmF0aXZlKHJpc2tEYXRhLCBvcHRpb25zKTtcblxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHtcbiAgICAgIHN1Y2Nlc3M6IHRydWUsXG4gICAgICBzdGF0dXM6ICdPSycsXG4gICAgICBzb3VyY2U6ICdQcmFldmlzaW8tQWlvbi1HZW5lcmF0aXZlQUknLFxuICAgICAgdGltZXN0YW1wOiBuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCksXG4gICAgICBkYXRhOiBuYXJyYXRpdmVcbiAgICB9KTtcbiAgfSBjYXRjaCAoZXJyb3IpIHtcbiAgICBjb25zb2xlLmVycm9yKCdFcnJvciBnZW5lcmF0aW5nIEFJIGFuYWx5c2lzOicsIGVycm9yKTtcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7XG4gICAgICBzdWNjZXNzOiBmYWxzZSxcbiAgICAgIG1lc3NhZ2U6ICdJbnRlcm5hbCBTZXJ2ZXIgRXJyb3I6IENvdWxkIG5vdCBnZW5lcmF0ZSBBSSBhbmFseXNpcy4nXG4gICAgfSk7XG4gIH1cbn0pO1xuXG5leHBvcnQgZGVmYXVsdCByb3V0ZXI7XG4iXSwibWFwcGluZ3MiOiI7Ozs7OztBQUFBLElBQUFBLFFBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtBQUNBLElBQUFDLEtBQUEsR0FBQUYsc0JBQUEsQ0FBQUMsT0FBQTtBQUF3QixTQUFBRCx1QkFBQUcsQ0FBQSxXQUFBQSxDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxHQUFBRCxDQUFBLEtBQUFFLE9BQUEsRUFBQUYsQ0FBQTtBQUFBLFNBQUFHLHdCQUFBSCxDQUFBLEVBQUFJLENBQUEsNkJBQUFDLE9BQUEsTUFBQUMsQ0FBQSxPQUFBRCxPQUFBLElBQUFFLENBQUEsT0FBQUYsT0FBQSxZQUFBRix1QkFBQSxZQUFBQSxDQUFBSCxDQUFBLEVBQUFJLENBQUEsU0FBQUEsQ0FBQSxJQUFBSixDQUFBLElBQUFBLENBQUEsQ0FBQUMsVUFBQSxTQUFBRCxDQUFBLE1BQUFRLENBQUEsRUFBQUMsQ0FBQSxFQUFBQyxDQUFBLEtBQUFDLFNBQUEsUUFBQVQsT0FBQSxFQUFBRixDQUFBLGlCQUFBQSxDQUFBLHVCQUFBQSxDQUFBLHlCQUFBQSxDQUFBLFNBQUFVLENBQUEsTUFBQUYsQ0FBQSxHQUFBSixDQUFBLEdBQUFHLENBQUEsR0FBQUQsQ0FBQSxRQUFBRSxDQUFBLENBQUFJLEdBQUEsQ0FBQVosQ0FBQSxVQUFBUSxDQUFBLENBQUFLLEdBQUEsQ0FBQWIsQ0FBQSxHQUFBUSxDQUFBLENBQUFNLEdBQUEsQ0FBQWQsQ0FBQSxFQUFBVSxDQUFBLGdCQUFBTixDQUFBLElBQUFKLENBQUEsZ0JBQUFJLENBQUEsT0FBQVcsY0FBQSxDQUFBQyxJQUFBLENBQUFoQixDQUFBLEVBQUFJLENBQUEsT0FBQUssQ0FBQSxJQUFBRCxDQUFBLEdBQUFTLE1BQUEsQ0FBQUMsY0FBQSxLQUFBRCxNQUFBLENBQUFFLHdCQUFBLENBQUFuQixDQUFBLEVBQUFJLENBQUEsT0FBQUssQ0FBQSxDQUFBSSxHQUFBLElBQUFKLENBQUEsQ0FBQUssR0FBQSxJQUFBTixDQUFBLENBQUFFLENBQUEsRUFBQU4sQ0FBQSxFQUFBSyxDQUFBLElBQUFDLENBQUEsQ0FBQU4sQ0FBQSxJQUFBSixDQUFBLENBQUFJLENBQUEsV0FBQU0sQ0FBQSxLQUFBVixDQUFBLEVBQUFJLENBQUE7QUFFeEI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0EsTUFBTWdCLFFBQVMsR0FBR0MsYUFBSSxDQUFDQyxPQUFPLENBQUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsUUFBUSxDQUFDO0FBQzlELE1BQU1DLE1BQU0sR0FBR0MsZ0JBQU8sQ0FBQ0MsTUFBTSxDQUFDLENBQUM7O0FBRS9CO0FBQ0EsZUFBZUMsUUFBUUEsQ0FBQ0MsVUFBVSxFQUFFO0VBQ2xDLElBQUk7SUFDRixNQUFNQyxRQUFRLEdBQUdULGFBQUksQ0FBQ0MsT0FBTyxDQUFDRixRQUFTLEVBQUVTLFVBQVUsQ0FBQztJQUNwRCxNQUFNRSxNQUFNLEdBQUcsT0FBQUMsU0FBQSxRQUFBQyxPQUFBLENBQUEzQixDQUFBLElBQUFBLENBQUEsSUFBQTBCLFNBQUEsS0FBQUUsSUFBQSxDQUFBQyxDQUFBLElBQUFoQyx1QkFBQSxDQUFBTCxPQUFBLENBQUFxQyxDQUFBLEtBQWFMLFFBQVEsQ0FBQztJQUNyQyxPQUFPQyxNQUFNLENBQUM3QixPQUFPLElBQUk2QixNQUFNO0VBQ2pDLENBQUMsQ0FBQyxPQUFPSyxLQUFLLEVBQUU7SUFDZEMsT0FBTyxDQUFDRCxLQUFLLENBQUMsd0JBQXdCUCxVQUFVLEdBQUcsRUFBRU8sS0FBSyxDQUFDO0lBQzNELE1BQU0sSUFBSUUsS0FBSyxDQUFDLDBCQUEwQlQsVUFBVSxFQUFFLENBQUM7RUFDekQ7QUFDRjs7QUFFQTtBQUNBSixNQUFNLENBQUNaLEdBQUcsQ0FBQyxnQkFBZ0IsRUFBRSxPQUFPMEIsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDL0MsSUFBSTtJQUNGLE1BQU07TUFBRUM7SUFBcUIsQ0FBQyxHQUFHLE1BQU1iLFFBQVEsQ0FBQyxvQ0FBb0MsQ0FBQztJQUNyRixNQUFNYyxJQUFJLEdBQUcsTUFBTUQsb0JBQW9CLENBQUMsQ0FBQztJQUV6Q0QsR0FBRyxDQUFDRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUNuQkMsT0FBTyxFQUFFLElBQUk7TUFDYkMsTUFBTSxFQUFFLG9DQUFvQztNQUM1Q0o7SUFDRixDQUFDLENBQUM7RUFDSixDQUFDLENBQUMsT0FBT04sS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLHNDQUFzQyxFQUFFQSxLQUFLLENBQUM7SUFDNURJLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDbkJDLE9BQU8sRUFBRSxLQUFLO01BQ2RFLE9BQU8sRUFBRTtJQUNYLENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQyxDQUFDOztBQUVGO0FBQ0F0QixNQUFNLENBQUNaLEdBQUcsQ0FBQyxvQkFBb0IsRUFBRSxPQUFPMEIsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDbkQsSUFBSTtJQUNGLE1BQU07TUFBRVEsU0FBUyxHQUFHO0lBQW1CLENBQUMsR0FBR1QsR0FBRyxDQUFDVSxLQUFLO0lBQ3BELE1BQU1DLFVBQVUsR0FBR0YsU0FBUyxDQUFDRyxLQUFLLENBQUMsR0FBRyxDQUFDLENBQUNDLEdBQUcsQ0FBQ0MsRUFBRSxJQUFJQSxFQUFFLENBQUNDLElBQUksQ0FBQyxDQUFDLENBQUM7SUFFNUQsTUFBTTtNQUFFQztJQUF3QixDQUFDLEdBQUcsTUFBTTNCLFFBQVEsQ0FBQyw4QkFBOEIsQ0FBQztJQUNsRixNQUFNYyxJQUFJLEdBQUcsTUFBTWEsdUJBQXVCLENBQUNMLFVBQVUsQ0FBQztJQUV0RFYsR0FBRyxDQUFDRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUNuQkMsT0FBTyxFQUFFLElBQUk7TUFDYkMsTUFBTSxFQUFFLDhCQUE4QjtNQUN0Q1UsU0FBUyxFQUFFLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDO01BQ25DaEIsSUFBSSxFQUFFO1FBQ0ppQixLQUFLLEVBQUUsRUFBRTtRQUNUQyxJQUFJLEVBQUUsR0FBRztRQUNUQyxLQUFLLEVBQUUsbUJBQW1CO1FBQzFCQyxRQUFRLEVBQUU7VUFDUkMsWUFBWSxFQUFFYixVQUFVLENBQUNjLE1BQU07VUFDL0JDLGlCQUFpQixFQUFFLElBQUk7VUFDdkJDLGNBQWMsRUFBRTtRQUNsQixDQUFDO1FBQ0RDLFVBQVUsRUFBRSxDQUNWO1VBQUVkLEVBQUUsRUFBRSxTQUFTO1VBQUVlLDJCQUEyQixFQUFFLENBQUM7UUFBSSxDQUFDLEVBQ3BEO1VBQUVmLEVBQUUsRUFBRSxVQUFVO1VBQUVlLDJCQUEyQixFQUFFO1FBQUksQ0FBQztNQUV4RDtJQUNGLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQyxPQUFPaEMsS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLDBDQUEwQyxFQUFFQSxLQUFLLENBQUM7SUFDaEVJLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDbkJDLE9BQU8sRUFBRSxLQUFLO01BQ2RFLE9BQU8sRUFBRTtJQUNYLENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQyxDQUFDOztBQUVGO0FBQ0F0QixNQUFNLENBQUNaLEdBQUcsQ0FBQyxtQkFBbUIsRUFBRSxPQUFPMEIsR0FBRyxFQUFFQyxHQUFHLEtBQUs7RUFDbEQsSUFBSTtJQUNGLE1BQU07TUFBRTZCO0lBQXdCLENBQUMsR0FBRyxNQUFNekMsUUFBUSxDQUFDLCtCQUErQixDQUFDO0lBQ25GLE1BQU1jLElBQUksR0FBRyxNQUFNMkIsdUJBQXVCLENBQUMsQ0FBQztJQUU1QzdCLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDbkJDLE9BQU8sRUFBRSxJQUFJO01BQ2JDLE1BQU0sRUFBRSx1Q0FBdUM7TUFDL0NKLElBQUksRUFBRSxDQUNKO1FBQ0U0QixPQUFPLEVBQUUsVUFBVTtRQUNuQkMsV0FBVyxFQUFFLEtBQUs7UUFDbEJmLFNBQVMsRUFBRSwwQkFBMEI7UUFDckNnQixNQUFNLEVBQUUsY0FBYztRQUN0QkMsVUFBVSxFQUFFLElBQUk7UUFDaEJDLFVBQVUsRUFBRSxJQUFJO1FBQ2hCQyxXQUFXLEVBQUUsSUFBSTtRQUNqQkMsa0JBQWtCLEVBQUUsS0FBSztRQUN6QkMsYUFBYSxFQUFFLENBQUM7UUFDaEJDLFNBQVMsRUFBRTtNQUNiLENBQUMsRUFDRDtRQUNFUixPQUFPLEVBQUUsTUFBTTtRQUNmQyxXQUFXLEVBQUUsS0FBSztRQUNsQmYsU0FBUyxFQUFFLDBCQUEwQjtRQUNyQ2dCLE1BQU0sRUFBRSxjQUFjO1FBQ3RCQyxVQUFVLEVBQUUsSUFBSTtRQUNoQkMsVUFBVSxFQUFFLElBQUk7UUFDaEJDLFdBQVcsRUFBRSxJQUFJO1FBQ2pCQyxrQkFBa0IsRUFBRSxJQUFJO1FBQ3hCQyxhQUFhLEVBQUUsQ0FBQztRQUNoQkMsU0FBUyxFQUFFO01BQ2IsQ0FBQztJQUVMLENBQUMsQ0FBQztFQUNKLENBQUMsQ0FBQyxPQUFPMUMsS0FBSyxFQUFFO0lBQ2RDLE9BQU8sQ0FBQ0QsS0FBSyxDQUFDLHlDQUF5QyxFQUFFQSxLQUFLLENBQUM7SUFDL0RJLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDbkJDLE9BQU8sRUFBRSxLQUFLO01BQ2RFLE9BQU8sRUFBRTtJQUNYLENBQUMsQ0FBQztFQUNKO0FBQ0YsQ0FBQyxDQUFDOztBQUVGO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQXRCLE1BQU0sQ0FBQ1osR0FBRyxDQUFDLHNCQUFzQixFQUFFLE9BQU8wQixHQUFHLEVBQUVDLEdBQUcsS0FBSztFQUNyRCxJQUFJO0lBQ0YsTUFBTTtNQUFFdUMsVUFBVSxHQUFHLENBQUMsU0FBUyxFQUFFLFVBQVUsRUFBRSxRQUFRLENBQUM7TUFBRUMsV0FBVyxHQUFHLFNBQVM7TUFBRUMsV0FBVyxHQUFHLGVBQWU7TUFBRUMsUUFBUSxHQUFHO0lBQUssQ0FBQyxHQUFHM0MsR0FBRyxDQUFDVSxLQUFLO0lBRTdJLE1BQU07TUFBRWtDO0lBQWUsQ0FBQyxHQUFHLE1BQU12RCxRQUFRLENBQUMsaUNBQWlDLENBQUM7SUFDNUUsTUFBTXdELFFBQVEsR0FBRyxNQUFNRCxjQUFjLENBQUMsQ0FBQztJQUV2QyxNQUFNO01BQUVFO0lBQTRCLENBQUMsR0FBRyxNQUFNekQsUUFBUSxDQUFDLG9DQUFvQyxDQUFDO0lBRTVGLE1BQU0wRCxPQUFPLEdBQUc7TUFDZFAsVUFBVSxFQUFFUSxLQUFLLENBQUNDLE9BQU8sQ0FBQ1QsVUFBVSxDQUFDLEdBQUdBLFVBQVUsR0FBR0EsVUFBVSxDQUFDNUIsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxHQUFHLENBQUNxQyxDQUFDLElBQUlBLENBQUMsQ0FBQ25DLElBQUksQ0FBQyxDQUFDLENBQUM7TUFDN0YwQixXQUFXO01BQ1hDLFdBQVc7TUFDWEM7SUFDRixDQUFDO0lBRUQsTUFBTVEsU0FBUyxHQUFHLE1BQU1MLDJCQUEyQixDQUFDRCxRQUFRLEVBQUVFLE9BQU8sQ0FBQztJQUV0RTlDLEdBQUcsQ0FBQ0csTUFBTSxDQUFDLEdBQUcsQ0FBQyxDQUFDQyxJQUFJLENBQUM7TUFDbkJDLE9BQU8sRUFBRSxJQUFJO01BQ2JGLE1BQU0sRUFBRSxJQUFJO01BQ1pHLE1BQU0sRUFBRSw2QkFBNkI7TUFDckNVLFNBQVMsRUFBRSxJQUFJQyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxXQUFXLENBQUMsQ0FBQztNQUNuQ2hCLElBQUksRUFBRWdEO0lBQ1IsQ0FBQyxDQUFDO0VBQ0osQ0FBQyxDQUFDLE9BQU90RCxLQUFLLEVBQUU7SUFDZEMsT0FBTyxDQUFDRCxLQUFLLENBQUMsK0JBQStCLEVBQUVBLEtBQUssQ0FBQztJQUNyREksR0FBRyxDQUFDRyxNQUFNLENBQUMsR0FBRyxDQUFDLENBQUNDLElBQUksQ0FBQztNQUNuQkMsT0FBTyxFQUFFLEtBQUs7TUFDZEUsT0FBTyxFQUFFO0lBQ1gsQ0FBQyxDQUFDO0VBQ0o7QUFDRixDQUFDLENBQUM7QUFBQyxJQUFBNEMsUUFBQSxHQUFBQyxPQUFBLENBQUExRixPQUFBLEdBRVl1QixNQUFNIiwiaWdub3JlTGlzdCI6W119