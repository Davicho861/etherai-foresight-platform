de3f1e3ff98f5083cd48bf254afd806f
"use strict";

/*! Based on fetch-blob. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource> & David Frank */
var __classPrivateFieldGet = this && this.__classPrivateFieldGet || function (receiver, state, kind, f) {
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a getter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot read private member from an object whose class did not declare it");
  return kind === "m" ? f : kind === "a" ? f.call(receiver) : f ? f.value : state.get(receiver);
};
var __classPrivateFieldSet = this && this.__classPrivateFieldSet || function (receiver, state, value, kind, f) {
  if (kind === "m") throw new TypeError("Private method is not writable");
  if (kind === "a" && !f) throw new TypeError("Private accessor was defined without a setter");
  if (typeof state === "function" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError("Cannot write private member to an object whose class did not declare it");
  return kind === "a" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value), value;
};
var _Blob_parts, _Blob_type, _Blob_size;
Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.Blob = void 0;
const web_streams_polyfill_1 = require("web-streams-polyfill");
const isFunction_1 = require("./isFunction");
const blobHelpers_1 = require("./blobHelpers");
class Blob {
  constructor(blobParts = [], options = {}) {
    _Blob_parts.set(this, []);
    _Blob_type.set(this, "");
    _Blob_size.set(this, 0);
    options !== null && options !== void 0 ? options : options = {};
    if (typeof blobParts !== "object" || blobParts === null) {
      throw new TypeError("Failed to construct 'Blob': " + "The provided value cannot be converted to a sequence.");
    }
    if (!(0, isFunction_1.isFunction)(blobParts[Symbol.iterator])) {
      throw new TypeError("Failed to construct 'Blob': " + "The object must have a callable @@iterator property.");
    }
    if (typeof options !== "object" && !(0, isFunction_1.isFunction)(options)) {
      throw new TypeError("Failed to construct 'Blob': parameter 2 cannot convert to dictionary.");
    }
    const encoder = new TextEncoder();
    for (const raw of blobParts) {
      let part;
      if (ArrayBuffer.isView(raw)) {
        part = new Uint8Array(raw.buffer.slice(raw.byteOffset, raw.byteOffset + raw.byteLength));
      } else if (raw instanceof ArrayBuffer) {
        part = new Uint8Array(raw.slice(0));
      } else if (raw instanceof Blob) {
        part = raw;
      } else {
        part = encoder.encode(String(raw));
      }
      __classPrivateFieldSet(this, _Blob_size, __classPrivateFieldGet(this, _Blob_size, "f") + (ArrayBuffer.isView(part) ? part.byteLength : part.size), "f");
      __classPrivateFieldGet(this, _Blob_parts, "f").push(part);
    }
    const type = options.type === undefined ? "" : String(options.type);
    __classPrivateFieldSet(this, _Blob_type, /^[\x20-\x7E]*$/.test(type) ? type : "", "f");
  }
  static [(_Blob_parts = new WeakMap(), _Blob_type = new WeakMap(), _Blob_size = new WeakMap(), Symbol.hasInstance)](value) {
    return Boolean(value && typeof value === "object" && (0, isFunction_1.isFunction)(value.constructor) && ((0, isFunction_1.isFunction)(value.stream) || (0, isFunction_1.isFunction)(value.arrayBuffer)) && /^(Blob|File)$/.test(value[Symbol.toStringTag]));
  }
  get type() {
    return __classPrivateFieldGet(this, _Blob_type, "f");
  }
  get size() {
    return __classPrivateFieldGet(this, _Blob_size, "f");
  }
  slice(start, end, contentType) {
    return new Blob((0, blobHelpers_1.sliceBlob)(__classPrivateFieldGet(this, _Blob_parts, "f"), this.size, start, end), {
      type: contentType
    });
  }
  async text() {
    const decoder = new TextDecoder();
    let result = "";
    for await (const chunk of (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, "f"))) {
      result += decoder.decode(chunk, {
        stream: true
      });
    }
    result += decoder.decode();
    return result;
  }
  async arrayBuffer() {
    const view = new Uint8Array(this.size);
    let offset = 0;
    for await (const chunk of (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, "f"))) {
      view.set(chunk, offset);
      offset += chunk.length;
    }
    return view.buffer;
  }
  stream() {
    const iterator = (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, "f"), true);
    return new web_streams_polyfill_1.ReadableStream({
      async pull(controller) {
        const {
          value,
          done
        } = await iterator.next();
        if (done) {
          return queueMicrotask(() => controller.close());
        }
        controller.enqueue(value);
      },
      async cancel() {
        await iterator.return();
      }
    });
  }
  get [Symbol.toStringTag]() {
    return "Blob";
  }
}
exports.Blob = Blob;
Object.defineProperties(Blob.prototype, {
  type: {
    enumerable: true
  },
  size: {
    enumerable: true
  },
  slice: {
    enumerable: true
  },
  stream: {
    enumerable: true
  },
  text: {
    enumerable: true
  },
  arrayBuffer: {
    enumerable: true
  }
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0IiwicmVjZWl2ZXIiLCJzdGF0ZSIsImtpbmQiLCJmIiwiVHlwZUVycm9yIiwiaGFzIiwiY2FsbCIsInZhbHVlIiwiZ2V0IiwiX19jbGFzc1ByaXZhdGVGaWVsZFNldCIsInNldCIsIl9CbG9iX3BhcnRzIiwiX0Jsb2JfdHlwZSIsIl9CbG9iX3NpemUiLCJPYmplY3QiLCJkZWZpbmVQcm9wZXJ0eSIsImV4cG9ydHMiLCJCbG9iIiwid2ViX3N0cmVhbXNfcG9seWZpbGxfMSIsInJlcXVpcmUiLCJpc0Z1bmN0aW9uXzEiLCJibG9iSGVscGVyc18xIiwiY29uc3RydWN0b3IiLCJibG9iUGFydHMiLCJvcHRpb25zIiwiaXNGdW5jdGlvbiIsIlN5bWJvbCIsIml0ZXJhdG9yIiwiZW5jb2RlciIsIlRleHRFbmNvZGVyIiwicmF3IiwicGFydCIsIkFycmF5QnVmZmVyIiwiaXNWaWV3IiwiVWludDhBcnJheSIsImJ1ZmZlciIsInNsaWNlIiwiYnl0ZU9mZnNldCIsImJ5dGVMZW5ndGgiLCJlbmNvZGUiLCJTdHJpbmciLCJzaXplIiwicHVzaCIsInR5cGUiLCJ1bmRlZmluZWQiLCJ0ZXN0IiwiV2Vha01hcCIsImhhc0luc3RhbmNlIiwiQm9vbGVhbiIsInN0cmVhbSIsImFycmF5QnVmZmVyIiwidG9TdHJpbmdUYWciLCJzdGFydCIsImVuZCIsImNvbnRlbnRUeXBlIiwic2xpY2VCbG9iIiwidGV4dCIsImRlY29kZXIiLCJUZXh0RGVjb2RlciIsInJlc3VsdCIsImNodW5rIiwiY29uc3VtZUJsb2JQYXJ0cyIsImRlY29kZSIsInZpZXciLCJvZmZzZXQiLCJsZW5ndGgiLCJSZWFkYWJsZVN0cmVhbSIsInB1bGwiLCJjb250cm9sbGVyIiwiZG9uZSIsIm5leHQiLCJxdWV1ZU1pY3JvdGFzayIsImNsb3NlIiwiZW5xdWV1ZSIsImNhbmNlbCIsInJldHVybiIsImRlZmluZVByb3BlcnRpZXMiLCJwcm90b3R5cGUiLCJlbnVtZXJhYmxlIl0sInNvdXJjZXMiOlsiQmxvYi5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyJcInVzZSBzdHJpY3RcIjtcbi8qISBCYXNlZCBvbiBmZXRjaC1ibG9iLiBNSVQgTGljZW5zZS4gSmltbXkgV8OkcnRpbmcgPGh0dHBzOi8vamltbXkud2FydGluZy5zZS9vcGVuc291cmNlPiAmIERhdmlkIEZyYW5rICovXG52YXIgX19jbGFzc1ByaXZhdGVGaWVsZEdldCA9ICh0aGlzICYmIHRoaXMuX19jbGFzc1ByaXZhdGVGaWVsZEdldCkgfHwgZnVuY3Rpb24gKHJlY2VpdmVyLCBzdGF0ZSwga2luZCwgZikge1xuICAgIGlmIChraW5kID09PSBcImFcIiAmJiAhZikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgYWNjZXNzb3Igd2FzIGRlZmluZWQgd2l0aG91dCBhIGdldHRlclwiKTtcbiAgICBpZiAodHlwZW9mIHN0YXRlID09PSBcImZ1bmN0aW9uXCIgPyByZWNlaXZlciAhPT0gc3RhdGUgfHwgIWYgOiAhc3RhdGUuaGFzKHJlY2VpdmVyKSkgdGhyb3cgbmV3IFR5cGVFcnJvcihcIkNhbm5vdCByZWFkIHByaXZhdGUgbWVtYmVyIGZyb20gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcbiAgICByZXR1cm4ga2luZCA9PT0gXCJtXCIgPyBmIDoga2luZCA9PT0gXCJhXCIgPyBmLmNhbGwocmVjZWl2ZXIpIDogZiA/IGYudmFsdWUgOiBzdGF0ZS5nZXQocmVjZWl2ZXIpO1xufTtcbnZhciBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0ID0gKHRoaXMgJiYgdGhpcy5fX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KSB8fCBmdW5jdGlvbiAocmVjZWl2ZXIsIHN0YXRlLCB2YWx1ZSwga2luZCwgZikge1xuICAgIGlmIChraW5kID09PSBcIm1cIikgdGhyb3cgbmV3IFR5cGVFcnJvcihcIlByaXZhdGUgbWV0aG9kIGlzIG5vdCB3cml0YWJsZVwiKTtcbiAgICBpZiAoa2luZCA9PT0gXCJhXCIgJiYgIWYpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJQcml2YXRlIGFjY2Vzc29yIHdhcyBkZWZpbmVkIHdpdGhvdXQgYSBzZXR0ZXJcIik7XG4gICAgaWYgKHR5cGVvZiBzdGF0ZSA9PT0gXCJmdW5jdGlvblwiID8gcmVjZWl2ZXIgIT09IHN0YXRlIHx8ICFmIDogIXN0YXRlLmhhcyhyZWNlaXZlcikpIHRocm93IG5ldyBUeXBlRXJyb3IoXCJDYW5ub3Qgd3JpdGUgcHJpdmF0ZSBtZW1iZXIgdG8gYW4gb2JqZWN0IHdob3NlIGNsYXNzIGRpZCBub3QgZGVjbGFyZSBpdFwiKTtcbiAgICByZXR1cm4gKGtpbmQgPT09IFwiYVwiID8gZi5jYWxsKHJlY2VpdmVyLCB2YWx1ZSkgOiBmID8gZi52YWx1ZSA9IHZhbHVlIDogc3RhdGUuc2V0KHJlY2VpdmVyLCB2YWx1ZSkpLCB2YWx1ZTtcbn07XG52YXIgX0Jsb2JfcGFydHMsIF9CbG9iX3R5cGUsIF9CbG9iX3NpemU7XG5PYmplY3QuZGVmaW5lUHJvcGVydHkoZXhwb3J0cywgXCJfX2VzTW9kdWxlXCIsIHsgdmFsdWU6IHRydWUgfSk7XG5leHBvcnRzLkJsb2IgPSB2b2lkIDA7XG5jb25zdCB3ZWJfc3RyZWFtc19wb2x5ZmlsbF8xID0gcmVxdWlyZShcIndlYi1zdHJlYW1zLXBvbHlmaWxsXCIpO1xuY29uc3QgaXNGdW5jdGlvbl8xID0gcmVxdWlyZShcIi4vaXNGdW5jdGlvblwiKTtcbmNvbnN0IGJsb2JIZWxwZXJzXzEgPSByZXF1aXJlKFwiLi9ibG9iSGVscGVyc1wiKTtcbmNsYXNzIEJsb2Ige1xuICAgIGNvbnN0cnVjdG9yKGJsb2JQYXJ0cyA9IFtdLCBvcHRpb25zID0ge30pIHtcbiAgICAgICAgX0Jsb2JfcGFydHMuc2V0KHRoaXMsIFtdKTtcbiAgICAgICAgX0Jsb2JfdHlwZS5zZXQodGhpcywgXCJcIik7XG4gICAgICAgIF9CbG9iX3NpemUuc2V0KHRoaXMsIDApO1xuICAgICAgICBvcHRpb25zICE9PSBudWxsICYmIG9wdGlvbnMgIT09IHZvaWQgMCA/IG9wdGlvbnMgOiAob3B0aW9ucyA9IHt9KTtcbiAgICAgICAgaWYgKHR5cGVvZiBibG9iUGFydHMgIT09IFwib2JqZWN0XCIgfHwgYmxvYlBhcnRzID09PSBudWxsKSB7XG4gICAgICAgICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKFwiRmFpbGVkIHRvIGNvbnN0cnVjdCAnQmxvYic6IFwiXG4gICAgICAgICAgICAgICAgKyBcIlRoZSBwcm92aWRlZCB2YWx1ZSBjYW5ub3QgYmUgY29udmVydGVkIHRvIGEgc2VxdWVuY2UuXCIpO1xuICAgICAgICB9XG4gICAgICAgIGlmICghKDAsIGlzRnVuY3Rpb25fMS5pc0Z1bmN0aW9uKShibG9iUGFydHNbU3ltYm9sLml0ZXJhdG9yXSkpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdCbG9iJzogXCJcbiAgICAgICAgICAgICAgICArIFwiVGhlIG9iamVjdCBtdXN0IGhhdmUgYSBjYWxsYWJsZSBAQGl0ZXJhdG9yIHByb3BlcnR5LlwiKTtcbiAgICAgICAgfVxuICAgICAgICBpZiAodHlwZW9mIG9wdGlvbnMgIT09IFwib2JqZWN0XCIgJiYgISgwLCBpc0Z1bmN0aW9uXzEuaXNGdW5jdGlvbikob3B0aW9ucykpIHtcbiAgICAgICAgICAgIHRocm93IG5ldyBUeXBlRXJyb3IoXCJGYWlsZWQgdG8gY29uc3RydWN0ICdCbG9iJzogcGFyYW1ldGVyIDIgY2Fubm90IGNvbnZlcnQgdG8gZGljdGlvbmFyeS5cIik7XG4gICAgICAgIH1cbiAgICAgICAgY29uc3QgZW5jb2RlciA9IG5ldyBUZXh0RW5jb2RlcigpO1xuICAgICAgICBmb3IgKGNvbnN0IHJhdyBvZiBibG9iUGFydHMpIHtcbiAgICAgICAgICAgIGxldCBwYXJ0O1xuICAgICAgICAgICAgaWYgKEFycmF5QnVmZmVyLmlzVmlldyhyYXcpKSB7XG4gICAgICAgICAgICAgICAgcGFydCA9IG5ldyBVaW50OEFycmF5KHJhdy5idWZmZXIuc2xpY2UocmF3LmJ5dGVPZmZzZXQsIHJhdy5ieXRlT2Zmc2V0ICsgcmF3LmJ5dGVMZW5ndGgpKTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2UgaWYgKHJhdyBpbnN0YW5jZW9mIEFycmF5QnVmZmVyKSB7XG4gICAgICAgICAgICAgICAgcGFydCA9IG5ldyBVaW50OEFycmF5KHJhdy5zbGljZSgwKSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBlbHNlIGlmIChyYXcgaW5zdGFuY2VvZiBCbG9iKSB7XG4gICAgICAgICAgICAgICAgcGFydCA9IHJhdztcbiAgICAgICAgICAgIH1cbiAgICAgICAgICAgIGVsc2Uge1xuICAgICAgICAgICAgICAgIHBhcnQgPSBlbmNvZGVyLmVuY29kZShTdHJpbmcocmF3KSk7XG4gICAgICAgICAgICB9XG4gICAgICAgICAgICBfX2NsYXNzUHJpdmF0ZUZpZWxkU2V0KHRoaXMsIF9CbG9iX3NpemUsIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2Jfc2l6ZSwgXCJmXCIpICsgKEFycmF5QnVmZmVyLmlzVmlldyhwYXJ0KSA/IHBhcnQuYnl0ZUxlbmd0aCA6IHBhcnQuc2l6ZSksIFwiZlwiKTtcbiAgICAgICAgICAgIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2JfcGFydHMsIFwiZlwiKS5wdXNoKHBhcnQpO1xuICAgICAgICB9XG4gICAgICAgIGNvbnN0IHR5cGUgPSBvcHRpb25zLnR5cGUgPT09IHVuZGVmaW5lZCA/IFwiXCIgOiBTdHJpbmcob3B0aW9ucy50eXBlKTtcbiAgICAgICAgX19jbGFzc1ByaXZhdGVGaWVsZFNldCh0aGlzLCBfQmxvYl90eXBlLCAvXltcXHgyMC1cXHg3RV0qJC8udGVzdCh0eXBlKSA/IHR5cGUgOiBcIlwiLCBcImZcIik7XG4gICAgfVxuICAgIHN0YXRpYyBbKF9CbG9iX3BhcnRzID0gbmV3IFdlYWtNYXAoKSwgX0Jsb2JfdHlwZSA9IG5ldyBXZWFrTWFwKCksIF9CbG9iX3NpemUgPSBuZXcgV2Vha01hcCgpLCBTeW1ib2wuaGFzSW5zdGFuY2UpXSh2YWx1ZSkge1xuICAgICAgICByZXR1cm4gQm9vbGVhbih2YWx1ZVxuICAgICAgICAgICAgJiYgdHlwZW9mIHZhbHVlID09PSBcIm9iamVjdFwiXG4gICAgICAgICAgICAmJiAoMCwgaXNGdW5jdGlvbl8xLmlzRnVuY3Rpb24pKHZhbHVlLmNvbnN0cnVjdG9yKVxuICAgICAgICAgICAgJiYgKCgwLCBpc0Z1bmN0aW9uXzEuaXNGdW5jdGlvbikodmFsdWUuc3RyZWFtKVxuICAgICAgICAgICAgICAgIHx8ICgwLCBpc0Z1bmN0aW9uXzEuaXNGdW5jdGlvbikodmFsdWUuYXJyYXlCdWZmZXIpKVxuICAgICAgICAgICAgJiYgL14oQmxvYnxGaWxlKSQvLnRlc3QodmFsdWVbU3ltYm9sLnRvU3RyaW5nVGFnXSkpO1xuICAgIH1cbiAgICBnZXQgdHlwZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2JfdHlwZSwgXCJmXCIpO1xuICAgIH1cbiAgICBnZXQgc2l6ZSgpIHtcbiAgICAgICAgcmV0dXJuIF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2Jfc2l6ZSwgXCJmXCIpO1xuICAgIH1cbiAgICBzbGljZShzdGFydCwgZW5kLCBjb250ZW50VHlwZSkge1xuICAgICAgICByZXR1cm4gbmV3IEJsb2IoKDAsIGJsb2JIZWxwZXJzXzEuc2xpY2VCbG9iKShfX2NsYXNzUHJpdmF0ZUZpZWxkR2V0KHRoaXMsIF9CbG9iX3BhcnRzLCBcImZcIiksIHRoaXMuc2l6ZSwgc3RhcnQsIGVuZCksIHtcbiAgICAgICAgICAgIHR5cGU6IGNvbnRlbnRUeXBlXG4gICAgICAgIH0pO1xuICAgIH1cbiAgICBhc3luYyB0ZXh0KCkge1xuICAgICAgICBjb25zdCBkZWNvZGVyID0gbmV3IFRleHREZWNvZGVyKCk7XG4gICAgICAgIGxldCByZXN1bHQgPSBcIlwiO1xuICAgICAgICBmb3IgYXdhaXQgKGNvbnN0IGNodW5rIG9mICgwLCBibG9iSGVscGVyc18xLmNvbnN1bWVCbG9iUGFydHMpKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2JfcGFydHMsIFwiZlwiKSkpIHtcbiAgICAgICAgICAgIHJlc3VsdCArPSBkZWNvZGVyLmRlY29kZShjaHVuaywgeyBzdHJlYW06IHRydWUgfSk7XG4gICAgICAgIH1cbiAgICAgICAgcmVzdWx0ICs9IGRlY29kZXIuZGVjb2RlKCk7XG4gICAgICAgIHJldHVybiByZXN1bHQ7XG4gICAgfVxuICAgIGFzeW5jIGFycmF5QnVmZmVyKCkge1xuICAgICAgICBjb25zdCB2aWV3ID0gbmV3IFVpbnQ4QXJyYXkodGhpcy5zaXplKTtcbiAgICAgICAgbGV0IG9mZnNldCA9IDA7XG4gICAgICAgIGZvciBhd2FpdCAoY29uc3QgY2h1bmsgb2YgKDAsIGJsb2JIZWxwZXJzXzEuY29uc3VtZUJsb2JQYXJ0cykoX19jbGFzc1ByaXZhdGVGaWVsZEdldCh0aGlzLCBfQmxvYl9wYXJ0cywgXCJmXCIpKSkge1xuICAgICAgICAgICAgdmlldy5zZXQoY2h1bmssIG9mZnNldCk7XG4gICAgICAgICAgICBvZmZzZXQgKz0gY2h1bmsubGVuZ3RoO1xuICAgICAgICB9XG4gICAgICAgIHJldHVybiB2aWV3LmJ1ZmZlcjtcbiAgICB9XG4gICAgc3RyZWFtKCkge1xuICAgICAgICBjb25zdCBpdGVyYXRvciA9ICgwLCBibG9iSGVscGVyc18xLmNvbnN1bWVCbG9iUGFydHMpKF9fY2xhc3NQcml2YXRlRmllbGRHZXQodGhpcywgX0Jsb2JfcGFydHMsIFwiZlwiKSwgdHJ1ZSk7XG4gICAgICAgIHJldHVybiBuZXcgd2ViX3N0cmVhbXNfcG9seWZpbGxfMS5SZWFkYWJsZVN0cmVhbSh7XG4gICAgICAgICAgICBhc3luYyBwdWxsKGNvbnRyb2xsZXIpIHtcbiAgICAgICAgICAgICAgICBjb25zdCB7IHZhbHVlLCBkb25lIH0gPSBhd2FpdCBpdGVyYXRvci5uZXh0KCk7XG4gICAgICAgICAgICAgICAgaWYgKGRvbmUpIHtcbiAgICAgICAgICAgICAgICAgICAgcmV0dXJuIHF1ZXVlTWljcm90YXNrKCgpID0+IGNvbnRyb2xsZXIuY2xvc2UoKSk7XG4gICAgICAgICAgICAgICAgfVxuICAgICAgICAgICAgICAgIGNvbnRyb2xsZXIuZW5xdWV1ZSh2YWx1ZSk7XG4gICAgICAgICAgICB9LFxuICAgICAgICAgICAgYXN5bmMgY2FuY2VsKCkge1xuICAgICAgICAgICAgICAgIGF3YWl0IGl0ZXJhdG9yLnJldHVybigpO1xuICAgICAgICAgICAgfVxuICAgICAgICB9KTtcbiAgICB9XG4gICAgZ2V0IFtTeW1ib2wudG9TdHJpbmdUYWddKCkge1xuICAgICAgICByZXR1cm4gXCJCbG9iXCI7XG4gICAgfVxufVxuZXhwb3J0cy5CbG9iID0gQmxvYjtcbk9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKEJsb2IucHJvdG90eXBlLCB7XG4gICAgdHlwZTogeyBlbnVtZXJhYmxlOiB0cnVlIH0sXG4gICAgc2l6ZTogeyBlbnVtZXJhYmxlOiB0cnVlIH0sXG4gICAgc2xpY2U6IHsgZW51bWVyYWJsZTogdHJ1ZSB9LFxuICAgIHN0cmVhbTogeyBlbnVtZXJhYmxlOiB0cnVlIH0sXG4gICAgdGV4dDogeyBlbnVtZXJhYmxlOiB0cnVlIH0sXG4gICAgYXJyYXlCdWZmZXI6IHsgZW51bWVyYWJsZTogdHJ1ZSB9XG59KTtcbiJdLCJtYXBwaW5ncyI6IkFBQUEsWUFBWTs7QUFDWjtBQUNBLElBQUlBLHNCQUFzQixHQUFJLElBQUksSUFBSSxJQUFJLENBQUNBLHNCQUFzQixJQUFLLFVBQVVDLFFBQVEsRUFBRUMsS0FBSyxFQUFFQyxJQUFJLEVBQUVDLENBQUMsRUFBRTtFQUN0RyxJQUFJRCxJQUFJLEtBQUssR0FBRyxJQUFJLENBQUNDLENBQUMsRUFBRSxNQUFNLElBQUlDLFNBQVMsQ0FBQywrQ0FBK0MsQ0FBQztFQUM1RixJQUFJLE9BQU9ILEtBQUssS0FBSyxVQUFVLEdBQUdELFFBQVEsS0FBS0MsS0FBSyxJQUFJLENBQUNFLENBQUMsR0FB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QUFFSSxNQUFNLENBQUM7TUFDdkJBLE1BQU0sSUFBSUosS0FBSyxDQUFDSyxNQUFNO0lBQzFCO0lBQ0EsT0FBT0YsSUFBSSxDQUFDNUIsTUFBTTtFQUN0QjtFQUNBYyxNQUFNQSxDQUFBLEVBQUc7SUFDTCxNQUFNdEIsUUFBUSxHQUFHLENBQUMsQ0FBQyxFQUFFTixhQUFhLENBQUN3QyxnQkFBZ0IsRUFBRTlELHNCQUFzQixDQUFDLElBQUksRUFBRVksV0FBVyxFQUFFLEdBQUcsQ0FBQyxFQUFFLElBQUksQ0FBQztJQUMxRyxPQUFPLElBQUlPLHNCQUFzQixDQUFDZ0QsY0FBYyxDQUFDO01BQzdDLE1BQU1DLElBQUlBLENBQUNDLFVBQVUsRUFBRTtRQUNuQixNQUFNO1VBQUU3RCxLQUFLO1VBQUU4RDtRQUFLLENBQUMsR0FBRyxNQUFNMUMsUUFBUSxDQUFDMkMsSUFBSSxDQUFDLENBQUM7UUFDN0MsSUFBSUQsSUFBSSxFQUFFO1VBQ04sT0FBT0UsY0FBYyxDQUFDLE1BQU1ILFVBQVUsQ0FBQ0ksS0FBSyxDQUFDLENBQUMsQ0FBQztRQUNuRDtRQUNBSixVQUFVLENBQUNLLE9BQU8sQ0FBQ2xFLEtBQUssQ0FBQztNQUM3QixDQUFDO01BQ0QsTUFBTW1FLE1BQU1BLENBQUEsRUFBRztRQUNYLE1BQU0vQyxRQUFRLENBQUNnRCxNQUFNLENBQUMsQ0FBQztNQUMzQjtJQUNKLENBQUMsQ0FBQztFQUNOO0VBQ0EsS0FBS2pELE1BQU0sQ0FBQ3lCLFdBQVcsSUFBSTtJQUN2QixPQUFPLE1BQU07RUFDakI7QUFDSjtBQUNBbkMsT0FBTyxDQUFDQyxJQUFJLEdBQUdBLElBQUk7QUFDbkJILE1BQU0sQ0FBQzhELGdCQUFnQixDQUFDM0QsSUFBSSxDQUFDNEQsU0FBUyxFQUFFO0VBQ3BDbEMsSUFBSSxFQUFFO0lBQUVtQyxVQUFVLEVBQUU7RUFBSyxDQUFDO0VBQzFCckMsSUFBSSxFQUFFO0lBQUVxQyxVQUFVLEVBQUU7RUFBSyxDQUFDO0VBQzFCMUMsS0FBSyxFQUFFO0lBQUUwQyxVQUFVLEVBQUU7RUFBSyxDQUFDO0VBQzNCN0IsTUFBTSxFQUFFO0lBQUU2QixVQUFVLEVBQUU7RUFBSyxDQUFDO0VBQzVCdEIsSUFBSSxFQUFFO0lBQUVzQixVQUFVLEVBQUU7RUFBSyxDQUFDO0VBQzFCNUIsV0FBVyxFQUFFO0lBQUU0QixVQUFVLEVBQUU7RUFBSztBQUNwQyxDQUFDLENBQUMiLCJpZ25vcmVMaXN0IjpbXX0=