{"version":3,"names":["__classPrivateFieldGet","receiver","state","kind","f","TypeError","has","call","value","get","__classPrivateFieldSet","set","_Blob_parts","_Blob_type","_Blob_size","Object","defineProperty","exports","Blob","web_streams_polyfill_1","require","isFunction_1","blobHelpers_1","constructor","blobParts","options","isFunction","Symbol","iterator","encoder","TextEncoder","raw","part","ArrayBuffer","isView","Uint8Array","buffer","slice","byteOffset","byteLength","encode","String","size","push","type","undefined","test","WeakMap","hasInstance","Boolean","stream","arrayBuffer","toStringTag","start","end","contentType","sliceBlob","text","decoder","TextDecoder","result","chunk","consumeBlobParts","decode","view","offset","length","ReadableStream","pull","controller","done","next","queueMicrotask","close","enqueue","cancel","return","defineProperties","prototype","enumerable"],"sources":["Blob.js"],"sourcesContent":["\"use strict\";\n/*! Based on fetch-blob. MIT License. Jimmy WÃ¤rting <https://jimmy.warting.se/opensource> & David Frank */\nvar __classPrivateFieldGet = (this && this.__classPrivateFieldGet) || function (receiver, state, kind, f) {\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a getter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot read private member from an object whose class did not declare it\");\n    return kind === \"m\" ? f : kind === \"a\" ? f.call(receiver) : f ? f.value : state.get(receiver);\n};\nvar __classPrivateFieldSet = (this && this.__classPrivateFieldSet) || function (receiver, state, value, kind, f) {\n    if (kind === \"m\") throw new TypeError(\"Private method is not writable\");\n    if (kind === \"a\" && !f) throw new TypeError(\"Private accessor was defined without a setter\");\n    if (typeof state === \"function\" ? receiver !== state || !f : !state.has(receiver)) throw new TypeError(\"Cannot write private member to an object whose class did not declare it\");\n    return (kind === \"a\" ? f.call(receiver, value) : f ? f.value = value : state.set(receiver, value)), value;\n};\nvar _Blob_parts, _Blob_type, _Blob_size;\nObject.defineProperty(exports, \"__esModule\", { value: true });\nexports.Blob = void 0;\nconst web_streams_polyfill_1 = require(\"web-streams-polyfill\");\nconst isFunction_1 = require(\"./isFunction\");\nconst blobHelpers_1 = require(\"./blobHelpers\");\nclass Blob {\n    constructor(blobParts = [], options = {}) {\n        _Blob_parts.set(this, []);\n        _Blob_type.set(this, \"\");\n        _Blob_size.set(this, 0);\n        options !== null && options !== void 0 ? options : (options = {});\n        if (typeof blobParts !== \"object\" || blobParts === null) {\n            throw new TypeError(\"Failed to construct 'Blob': \"\n                + \"The provided value cannot be converted to a sequence.\");\n        }\n        if (!(0, isFunction_1.isFunction)(blobParts[Symbol.iterator])) {\n            throw new TypeError(\"Failed to construct 'Blob': \"\n                + \"The object must have a callable @@iterator property.\");\n        }\n        if (typeof options !== \"object\" && !(0, isFunction_1.isFunction)(options)) {\n            throw new TypeError(\"Failed to construct 'Blob': parameter 2 cannot convert to dictionary.\");\n        }\n        const encoder = new TextEncoder();\n        for (const raw of blobParts) {\n            let part;\n            if (ArrayBuffer.isView(raw)) {\n                part = new Uint8Array(raw.buffer.slice(raw.byteOffset, raw.byteOffset + raw.byteLength));\n            }\n            else if (raw instanceof ArrayBuffer) {\n                part = new Uint8Array(raw.slice(0));\n            }\n            else if (raw instanceof Blob) {\n                part = raw;\n            }\n            else {\n                part = encoder.encode(String(raw));\n            }\n            __classPrivateFieldSet(this, _Blob_size, __classPrivateFieldGet(this, _Blob_size, \"f\") + (ArrayBuffer.isView(part) ? part.byteLength : part.size), \"f\");\n            __classPrivateFieldGet(this, _Blob_parts, \"f\").push(part);\n        }\n        const type = options.type === undefined ? \"\" : String(options.type);\n        __classPrivateFieldSet(this, _Blob_type, /^[\\x20-\\x7E]*$/.test(type) ? type : \"\", \"f\");\n    }\n    static [(_Blob_parts = new WeakMap(), _Blob_type = new WeakMap(), _Blob_size = new WeakMap(), Symbol.hasInstance)](value) {\n        return Boolean(value\n            && typeof value === \"object\"\n            && (0, isFunction_1.isFunction)(value.constructor)\n            && ((0, isFunction_1.isFunction)(value.stream)\n                || (0, isFunction_1.isFunction)(value.arrayBuffer))\n            && /^(Blob|File)$/.test(value[Symbol.toStringTag]));\n    }\n    get type() {\n        return __classPrivateFieldGet(this, _Blob_type, \"f\");\n    }\n    get size() {\n        return __classPrivateFieldGet(this, _Blob_size, \"f\");\n    }\n    slice(start, end, contentType) {\n        return new Blob((0, blobHelpers_1.sliceBlob)(__classPrivateFieldGet(this, _Blob_parts, \"f\"), this.size, start, end), {\n            type: contentType\n        });\n    }\n    async text() {\n        const decoder = new TextDecoder();\n        let result = \"\";\n        for await (const chunk of (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, \"f\"))) {\n            result += decoder.decode(chunk, { stream: true });\n        }\n        result += decoder.decode();\n        return result;\n    }\n    async arrayBuffer() {\n        const view = new Uint8Array(this.size);\n        let offset = 0;\n        for await (const chunk of (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, \"f\"))) {\n            view.set(chunk, offset);\n            offset += chunk.length;\n        }\n        return view.buffer;\n    }\n    stream() {\n        const iterator = (0, blobHelpers_1.consumeBlobParts)(__classPrivateFieldGet(this, _Blob_parts, \"f\"), true);\n        return new web_streams_polyfill_1.ReadableStream({\n            async pull(controller) {\n                const { value, done } = await iterator.next();\n                if (done) {\n                    return queueMicrotask(() => controller.close());\n                }\n                controller.enqueue(value);\n            },\n            async cancel() {\n                await iterator.return();\n            }\n        });\n    }\n    get [Symbol.toStringTag]() {\n        return \"Blob\";\n    }\n}\nexports.Blob = Blob;\nObject.defineProperties(Blob.prototype, {\n    type: { enumerable: true },\n    size: { enumerable: true },\n    slice: { enumerable: true },\n    stream: { enumerable: true },\n    text: { enumerable: true },\n    arrayBuffer: { enumerable: true }\n});\n"],"mappings":"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","ignoreList":[]}