2dc8443ec6b45d877a6672ca13efe212
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;
function _nodeFetch() {
  const data = _interopRequireDefault(require("node-fetch"));
  _nodeFetch = function () {
    return data;
  };
  return data;
}
function _fs() {
  const data = _interopRequireDefault(require("fs"));
  _fs = function () {
    return data;
  };
  return data;
}
function _path() {
  const data = _interopRequireDefault(require("path"));
  _path = function () {
    return data;
  };
  return data;
}
function _interopRequireDefault(e) { return e && e.__esModule ? e : { default: e }; }
// Minimal safeFetch helper: timeout, retries, JSON parse guard

// Prefer a global fetch (jest mock) when available so tests that set global.mockFetch
// or global.fetch will be effective. Otherwise fall back to imported node-fetch.
const defaultFetch = typeof global.fetch !== 'undefined' ? global.fetch : _nodeFetch().default;
const USER_AGENTS = ['Mozilla/5.0 (X11; Linux x86_64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36', 'Praevisio/1.0 (+https://praevisio.local)'];
async function safeFetch(url, opts = {}, {
  timeout = 8000,
  retries = 2
} = {}) {
  for (let attempt = 0; attempt <= retries; attempt++) {
    const controller = new AbortController();
    const id = setTimeout(() => controller.abort(), timeout);
    try {
      const headers = {
        ...(opts.headers || {}),
        'Accept': 'application/json, text/plain, */*',
        'User-Agent': USER_AGENTS[attempt % USER_AGENTS.length]
      };
      const fetchImpl = typeof defaultFetch === 'function' ? defaultFetch : _nodeFetch().default;
      const res = await fetchImpl(url, {
        ...opts,
        headers,
        signal: controller.signal
      });
      clearTimeout(id);
      if (!res.ok) {
        // Try to safely read body/text for error reporting. Some test mocks may not
        // implement res.text(), so guard against that.
        let errText = '';
        if (res && typeof res.text === 'function') {
          errText = await res.text().catch(() => '');
        } else if (res && typeof res.json === 'function') {
          try {
            const j = await res.json();
            errText = typeof j === 'string' ? j : JSON.stringify(j);
          } catch (_e) {
            errText = '';
          }
        }
        // Log raw error response for debugging
        try {
          const logPath = _path().default.resolve(process.cwd(), 'tmp', 'integration_errors.log');
          _fs().default.mkdirSync(_path().default.dirname(logPath), {
            recursive: true
          });
          const entry = `[${new Date().toISOString()}] HTTP ${res.status} GET ${url} \n${errText.slice(0, 200)}\n\n`;
          _fs().default.appendFileSync(logPath, entry);
        } catch (e) {
          // ignore logging errors
        }
        throw new Error(`HTTP ${res.status}: ${errText}`);
      }
      // Detect content-type in a defensive way: test mocks may supply headers as a
      // simple object without a .get() method. Prefer headers.get if available.
      let ct = '';
      try {
        if (res && res.headers) {
          if (typeof res.headers.get === 'function') {
            ct = res.headers.get('content-type') || '';
          } else if (res.headers['content-type']) {
            ct = res.headers['content-type'];
          }
        }
      } catch (e) {
        ct = '';
      }

      // Some mocks simply provide a json() method but no headers â€” assume JSON
      if (!ct && res && typeof res.json === 'function') {
        ct = 'application/json';
      }
      if (ct && ct.toLowerCase().includes('application/json')) {
        try {
          return await (typeof res.json === 'function' ? res.json() : Promise.resolve(null));
        } catch (parseErr) {
          // Log invalid JSON parse for debugging
          try {
            const logPath = _path().default.resolve(process.cwd(), 'tmp', 'integration_errors.log');
            _fs().default.mkdirSync(_path().default.dirname(logPath), {
              recursive: true
            });
            const entry = `[${new Date().toISOString()}] Invalid JSON GET ${url} \nparseError: ${parseErr && parseErr.message ? parseErr.message : String(parseErr)}\n\n`;
            _fs().default.appendFileSync(logPath, entry);
          } catch (e) {}
          throw new Error(`Invalid JSON response: ${parseErr && parseErr.message ? parseErr.message : String(parseErr)}`);
        }
      }

      // If we received a non-JSON body (likely HTML blocking page), try to read text()
      let bodyText = '';
      if (res && typeof res.text === 'function') {
        bodyText = await res.text().catch(() => '');
      } else if (res && typeof res.json === 'function') {
        try {
          const j = await res.json();
          bodyText = typeof j === 'string' ? j : JSON.stringify(j);
        } catch (_e) {
          bodyText = '';
        }
      }
      // Log non-JSON body for debugging (first 2000 chars)
      try {
        const logPath = _path().default.resolve(process.cwd(), 'tmp', 'integration_errors.log');
        _fs().default.mkdirSync(_path().default.dirname(logPath), {
          recursive: true
        });
        const entry = `[${new Date().toISOString()}] Non-JSON GET ${url} \ncontent-type: ${ct} \nbody: ${bodyText.slice(0, 2000)}\n\n`;
        _fs().default.appendFileSync(logPath, entry);
      } catch (e) {}
      throw new Error(`Non-JSON response (content-type: ${ct}): ${bodyText.slice(0, 200)}`);
    } catch (err) {
      clearTimeout(id);
      if (attempt === retries) throw err;
      // exponential-ish backoff with jitter
      const delay = 300 + attempt * 500 + Math.floor(Math.random() * 200);
      await new Promise(r => setTimeout(r, delay));
    }
  }
}
var _default = exports.default = safeFetch;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfbm9kZUZldGNoIiwiZGF0YSIsIl9pbnRlcm9wUmVxdWlyZURlZmF1bHQiLCJyZXF1aXJlIiwiX2ZzIiwiX3BhdGgiLCJlIiwiX19lc01vZHVsZSIsImRlZmF1bHQiLCJkZWZhdWx0RmV0Y2giLCJnbG9iYWwiLCJmZXRjaCIsIlVTRVJfQUdFTlRTIiwic2FmZUZldGNoIiwidXJsIiwib3B0cyIsInRpbWVvdXQiLCJyZXRyaWVzIiwiYXR0ZW1wdCIsImNvbnRyb2xsZXIiLCJBYm9ydENvbnRyb2xsZXIiLCJpZCIsInNldFRpbWVvdXQiLCJhYm9ydCIsImhlYWRlcnMiLCJsZW5ndGgiLCJmZXRjaEltcGwiLCJyZXMiLCJzaWduYWwiLCJjbGVhclRpbWVvdXQiLCJvayIsImVyclRleHQiLCJ0ZXh0IiwiY2F0Y2giLCJqc29uIiwiaiIsIkpTT04iLCJzdHJpbmdpZnkiLCJfZSIsImxvZ1BhdGgiLCJwYXRoIiwicmVzb2x2ZSIsInByb2Nlc3MiLCJjd2QiLCJmcyIsIm1rZGlyU3luYyIsImRpcm5hbWUiLCJyZWN1cnNpdmUiLCJlbnRyeSIsIkRhdGUiLCJ0b0lTT1N0cmluZyIsInN0YXR1cyIsInNsaWNlIiwiYXBwZW5kRmlsZVN5bmMiLCJFcnJvciIsImN0IiwiZ2V0IiwidG9Mb3dlckNhc2UiLCJpbmNsdWRlcyIsIlByb21pc2UiLCJwYXJzZUVyciIsIm1lc3NhZ2UiLCJTdHJpbmciLCJib2R5VGV4dCIsImVyciIsImRlbGF5IiwiTWF0aCIsImZsb29yIiwicmFuZG9tIiwiciIsIl9kZWZhdWx0IiwiZXhwb3J0cyJdLCJzb3VyY2VzIjpbInNhZmVGZXRjaC5qcyJdLCJzb3VyY2VzQ29udGVudCI6WyIvLyBNaW5pbWFsIHNhZmVGZXRjaCBoZWxwZXI6IHRpbWVvdXQsIHJldHJpZXMsIEpTT04gcGFyc2UgZ3VhcmRcbmltcG9ydCBmZXRjaCBmcm9tICdub2RlLWZldGNoJztcbi8vIFByZWZlciBhIGdsb2JhbCBmZXRjaCAoamVzdCBtb2NrKSB3aGVuIGF2YWlsYWJsZSBzbyB0ZXN0cyB0aGF0IHNldCBnbG9iYWwubW9ja0ZldGNoXG4vLyBvciBnbG9iYWwuZmV0Y2ggd2lsbCBiZSBlZmZlY3RpdmUuIE90aGVyd2lzZSBmYWxsIGJhY2sgdG8gaW1wb3J0ZWQgbm9kZS1mZXRjaC5cbmNvbnN0IGRlZmF1bHRGZXRjaCA9IHR5cGVvZiBnbG9iYWwuZmV0Y2ggIT09ICd1bmRlZmluZWQnID8gZ2xvYmFsLmZldGNoIDogZmV0Y2g7XG5pbXBvcnQgZnMgZnJvbSAnZnMnO1xuaW1wb3J0IHBhdGggZnJvbSAncGF0aCc7XG5cbmNvbnN0IFVTRVJfQUdFTlRTID0gW1xuICAnTW96aWxsYS81LjAgKFgxMTsgTGludXggeDg2XzY0KSBBcHBsZVdlYktpdC81MzcuMzYgKEtIVE1MLCBsaWtlIEdlY2tvKSBDaHJvbWUvMTIwLjAuMC4wIFNhZmFyaS81MzcuMzYnLFxuICAnUHJhZXZpc2lvLzEuMCAoK2h0dHBzOi8vcHJhZXZpc2lvLmxvY2FsKSdcbl07XG5cbmFzeW5jIGZ1bmN0aW9uIHNhZmVGZXRjaCh1cmwsIG9wdHMgPSB7fSwgeyB0aW1lb3V0ID0gODAwMCwgcmV0cmllcyA9IDIgfSA9IHt9KSB7XG4gIGZvciAobGV0IGF0dGVtcHQgPSAwOyBhdHRlbXB0IDw9IHJldHJpZXM7IGF0dGVtcHQrKykge1xuICAgIGNvbnN0IGNvbnRyb2xsZXIgPSBuZXcgQWJvcnRDb250cm9sbGVyKCk7XG4gICAgY29uc3QgaWQgPSBzZXRUaW1lb3V0KCgpID0+IGNvbnRyb2xsZXIuYWJvcnQoKSwgdGltZW91dCk7XG4gICAgdHJ5IHtcbiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7IC4uLihvcHRzLmhlYWRlcnMgfHwge30pLCAnQWNjZXB0JzogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvcGxhaW4sICovKicsICdVc2VyLUFnZW50JzogVVNFUl9BR0VOVFNbYXR0ZW1wdCAlIFVTRVJfQUdFTlRTLmxlbmd0aF0gfTtcbiAgICAgIGNvbnN0IGZldGNoSW1wbCA9IHR5cGVvZiBkZWZhdWx0RmV0Y2ggPT09ICdmdW5jdGlvbicgPyBkZWZhdWx0RmV0Y2ggOiBmZXRjaDtcbiAgICAgIGNvbnN0IHJlcyA9IGF3YWl0IGZldGNoSW1wbCh1cmwsIHsgLi4ub3B0cywgaGVhZGVycywgc2lnbmFsOiBjb250cm9sbGVyLnNpZ25hbCB9KTtcbiAgICAgIGNsZWFyVGltZW91dChpZCk7XG4gICAgICBpZiAoIXJlcy5vaykge1xuICAgICAgICAgIC8vIFRyeSB0byBzYWZlbHkgcmVhZCBib2R5L3RleHQgZm9yIGVycm9yIHJlcG9ydGluZy4gU29tZSB0ZXN0IG1vY2tzIG1heSBub3RcbiAgICAgICAgICAvLyBpbXBsZW1lbnQgcmVzLnRleHQoKSwgc28gZ3VhcmQgYWdhaW5zdCB0aGF0LlxuICAgICAgICAgIGxldCBlcnJUZXh0ID0gJyc7XG4gICAgICAgICAgaWYgKHJlcyAmJiB0eXBlb2YgcmVzLnRleHQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIGVyclRleHQgPSBhd2FpdCByZXMudGV4dCgpLmNhdGNoKCgpID0+ICcnKTtcbiAgICAgICAgICB9IGVsc2UgaWYgKHJlcyAmJiB0eXBlb2YgcmVzLmpzb24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGogPSBhd2FpdCByZXMuanNvbigpO1xuICAgICAgICAgICAgICBlcnJUZXh0ID0gdHlwZW9mIGogPT09ICdzdHJpbmcnID8gaiA6IEpTT04uc3RyaW5naWZ5KGopO1xuICAgICAgICAgICAgfSBjYXRjaCAoX2UpIHtcbiAgICAgICAgICAgICAgZXJyVGV4dCA9ICcnO1xuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgICAvLyBMb2cgcmF3IGVycm9yIHJlc3BvbnNlIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgbG9nUGF0aCA9IHBhdGgucmVzb2x2ZShwcm9jZXNzLmN3ZCgpLCAndG1wJywgJ2ludGVncmF0aW9uX2Vycm9ycy5sb2cnKTtcbiAgICAgICAgICAgIGZzLm1rZGlyU3luYyhwYXRoLmRpcm5hbWUobG9nUGF0aCksIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgICAgICAgY29uc3QgZW50cnkgPSBgWyR7bmV3IERhdGUoKS50b0lTT1N0cmluZygpfV0gSFRUUCAke3Jlcy5zdGF0dXN9IEdFVCAke3VybH0gXFxuJHtlcnJUZXh0LnNsaWNlKDAsMjAwKX1cXG5cXG5gO1xuICAgICAgICAgICAgZnMuYXBwZW5kRmlsZVN5bmMobG9nUGF0aCwgZW50cnkpO1xuICAgICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICAgIC8vIGlnbm9yZSBsb2dnaW5nIGVycm9yc1xuICAgICAgICAgIH1cbiAgICAgICAgICB0aHJvdyBuZXcgRXJyb3IoYEhUVFAgJHtyZXMuc3RhdHVzfTogJHtlcnJUZXh0fWApO1xuICAgICAgfVxuICAgICAgICAvLyBEZXRlY3QgY29udGVudC10eXBlIGluIGEgZGVmZW5zaXZlIHdheTogdGVzdCBtb2NrcyBtYXkgc3VwcGx5IGhlYWRlcnMgYXMgYVxuICAgICAgICAvLyBzaW1wbGUgb2JqZWN0IHdpdGhvdXQgYSAuZ2V0KCkgbWV0aG9kLiBQcmVmZXIgaGVhZGVycy5nZXQgaWYgYXZhaWxhYmxlLlxuICAgICAgICBsZXQgY3QgPSAnJztcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBpZiAocmVzICYmIHJlcy5oZWFkZXJzKSB7XG4gICAgICAgICAgICBpZiAodHlwZW9mIHJlcy5oZWFkZXJzLmdldCA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgICAgICBjdCA9IHJlcy5oZWFkZXJzLmdldCgnY29udGVudC10eXBlJykgfHwgJyc7XG4gICAgICAgICAgICB9IGVsc2UgaWYgKHJlcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXSkge1xuICAgICAgICAgICAgICBjdCA9IHJlcy5oZWFkZXJzWydjb250ZW50LXR5cGUnXTtcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIH0gY2F0Y2ggKGUpIHtcbiAgICAgICAgICBjdCA9ICcnO1xuICAgICAgICB9XG5cbiAgICAgICAgLy8gU29tZSBtb2NrcyBzaW1wbHkgcHJvdmlkZSBhIGpzb24oKSBtZXRob2QgYnV0IG5vIGhlYWRlcnMg4oCUIGFzc3VtZSBKU09OXG4gICAgICAgIGlmICghY3QgJiYgcmVzICYmIHR5cGVvZiByZXMuanNvbiA9PT0gJ2Z1bmN0aW9uJykge1xuICAgICAgICAgIGN0ID0gJ2FwcGxpY2F0aW9uL2pzb24nO1xuICAgICAgICB9XG5cbiAgICAgICAgaWYgKGN0ICYmIGN0LnRvTG93ZXJDYXNlKCkuaW5jbHVkZXMoJ2FwcGxpY2F0aW9uL2pzb24nKSkge1xuICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICByZXR1cm4gYXdhaXQgKHR5cGVvZiByZXMuanNvbiA9PT0gJ2Z1bmN0aW9uJyA/IHJlcy5qc29uKCkgOiBQcm9taXNlLnJlc29sdmUobnVsbCkpO1xuICAgICAgICAgIH0gY2F0Y2ggKHBhcnNlRXJyKSB7XG4gICAgICAgICAgICAvLyBMb2cgaW52YWxpZCBKU09OIHBhcnNlIGZvciBkZWJ1Z2dpbmdcbiAgICAgICAgICAgIHRyeSB7XG4gICAgICAgICAgICAgIGNvbnN0IGxvZ1BhdGggPSBwYXRoLnJlc29sdmUocHJvY2Vzcy5jd2QoKSwgJ3RtcCcsICdpbnRlZ3JhdGlvbl9lcnJvcnMubG9nJyk7XG4gICAgICAgICAgICAgIGZzLm1rZGlyU3luYyhwYXRoLmRpcm5hbWUobG9nUGF0aCksIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgICAgICAgICBjb25zdCBlbnRyeSA9IGBbJHtuZXcgRGF0ZSgpLnRvSVNPU3RyaW5nKCl9XSBJbnZhbGlkIEpTT04gR0VUICR7dXJsfSBcXG5wYXJzZUVycm9yOiAke3BhcnNlRXJyICYmIHBhcnNlRXJyLm1lc3NhZ2UgPyBwYXJzZUVyci5tZXNzYWdlIDogU3RyaW5nKHBhcnNlRXJyKX1cXG5cXG5gO1xuICAgICAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhsb2dQYXRoLCBlbnRyeSk7XG4gICAgICAgICAgICB9IGNhdGNoIChlKSB7fVxuICAgICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBJbnZhbGlkIEpTT04gcmVzcG9uc2U6ICR7cGFyc2VFcnIgJiYgcGFyc2VFcnIubWVzc2FnZSA/IHBhcnNlRXJyLm1lc3NhZ2UgOiBTdHJpbmcocGFyc2VFcnIpfWApO1xuICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIC8vIElmIHdlIHJlY2VpdmVkIGEgbm9uLUpTT04gYm9keSAobGlrZWx5IEhUTUwgYmxvY2tpbmcgcGFnZSksIHRyeSB0byByZWFkIHRleHQoKVxuICAgICAgICBsZXQgYm9keVRleHQgPSAnJztcbiAgICAgICAgaWYgKHJlcyAmJiB0eXBlb2YgcmVzLnRleHQgPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICBib2R5VGV4dCA9IGF3YWl0IHJlcy50ZXh0KCkuY2F0Y2goKCkgPT4gJycpO1xuICAgICAgICB9IGVsc2UgaWYgKHJlcyAmJiB0eXBlb2YgcmVzLmpzb24gPT09ICdmdW5jdGlvbicpIHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3QgaiA9IGF3YWl0IHJlcy5qc29uKCk7XG4gICAgICAgICAgICBib2R5VGV4dCA9IHR5cGVvZiBqID09PSAnc3RyaW5nJyA/IGogOiBKU09OLnN0cmluZ2lmeShqKTtcbiAgICAgICAgICB9IGNhdGNoIChfZSkge1xuICAgICAgICAgICAgYm9keVRleHQgPSAnJztcbiAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgLy8gTG9nIG5vbi1KU09OIGJvZHkgZm9yIGRlYnVnZ2luZyAoZmlyc3QgMjAwMCBjaGFycylcbiAgICAgICAgdHJ5IHtcbiAgICAgICAgICBjb25zdCBsb2dQYXRoID0gcGF0aC5yZXNvbHZlKHByb2Nlc3MuY3dkKCksICd0bXAnLCAnaW50ZWdyYXRpb25fZXJyb3JzLmxvZycpO1xuICAgICAgICAgIGZzLm1rZGlyU3luYyhwYXRoLmRpcm5hbWUobG9nUGF0aCksIHsgcmVjdXJzaXZlOiB0cnVlIH0pO1xuICAgICAgICAgIGNvbnN0IGVudHJ5ID0gYFske25ldyBEYXRlKCkudG9JU09TdHJpbmcoKX1dIE5vbi1KU09OIEdFVCAke3VybH0gXFxuY29udGVudC10eXBlOiAke2N0fSBcXG5ib2R5OiAke2JvZHlUZXh0LnNsaWNlKDAsMjAwMCl9XFxuXFxuYDtcbiAgICAgICAgICBmcy5hcHBlbmRGaWxlU3luYyhsb2dQYXRoLCBlbnRyeSk7XG4gICAgICAgIH0gY2F0Y2ggKGUpIHt9XG4gICAgICAgIHRocm93IG5ldyBFcnJvcihgTm9uLUpTT04gcmVzcG9uc2UgKGNvbnRlbnQtdHlwZTogJHtjdH0pOiAke2JvZHlUZXh0LnNsaWNlKDAsIDIwMCl9YCk7XG4gICAgfSBjYXRjaCAoZXJyKSB7XG4gICAgICBjbGVhclRpbWVvdXQoaWQpO1xuICAgICAgaWYgKGF0dGVtcHQgPT09IHJldHJpZXMpIHRocm93IGVycjtcbiAgICAgIC8vIGV4cG9uZW50aWFsLWlzaCBiYWNrb2ZmIHdpdGggaml0dGVyXG4gICAgICBjb25zdCBkZWxheSA9IDMwMCArIGF0dGVtcHQgKiA1MDAgKyBNYXRoLmZsb29yKE1hdGgucmFuZG9tKCkgKiAyMDApO1xuICAgICAgYXdhaXQgbmV3IFByb21pc2UociA9PiBzZXRUaW1lb3V0KHIsIGRlbGF5KSk7XG4gICAgfVxuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IHNhZmVGZXRjaDtcbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7O0FBQ0EsU0FBQUEsV0FBQTtFQUFBLE1BQUFDLElBQUEsR0FBQUMsc0JBQUEsQ0FBQUMsT0FBQTtFQUFBSCxVQUFBLFlBQUFBLENBQUE7SUFBQSxPQUFBQyxJQUFBO0VBQUE7RUFBQSxPQUFBQSxJQUFBO0FBQUE7QUFJQSxTQUFBRyxJQUFBO0VBQUEsTUFBQUgsSUFBQSxHQUFBQyxzQkFBQSxDQUFBQyxPQUFBO0VBQUFDLEdBQUEsWUFBQUEsQ0FBQTtJQUFBLE9BQUFILElBQUE7RUFBQTtFQUFBLE9BQUFBLElBQUE7QUFBQTtBQUNBLFNBQUFJLE1BQUE7RUFBQSxNQUFBSixJQUFBLEdBQUFDLHNCQUFBLENBQUFDLE9BQUE7RUFBQUUsS0FBQSxZQUFBQSxDQUFBO0lBQUEsT0FBQUosSUFBQTtFQUFBO0VBQUEsT0FBQUEsSUFBQTtBQUFBO0FBQXdCLFNBQUFDLHVCQUFBSSxDQUFBLFdBQUFBLENBQUEsSUFBQUEsQ0FBQSxDQUFBQyxVQUFBLEdBQUFELENBQUEsS0FBQUUsT0FBQSxFQUFBRixDQUFBO0FBTnhCOztBQUVBO0FBQ0E7QUFDQSxNQUFNRyxZQUFZLEdBQUcsT0FBT0MsTUFBTSxDQUFDQyxLQUFLLEtBQUssV0FBVyxHQUFHRCxNQUFNLENBQUNDLEtBQUssR0FBR0Esb0JBQUs7QUFJL0UsTUFBTUMsV0FBVyxHQUFHLENBQ2xCLHVHQUF1RyxFQUN2RywwQ0FBMEMsQ0FDM0M7QUFFRCxlQUFlQyxTQUFTQSxDQUFDQyxHQUFHLEVBQUVDLElBQUksR0FBRyxDQUFDLENBQUMsRUFBRTtFQUFFQyxPQUFPLEdBQUcsSUFBSTtFQUFFQyxPQUFPLEdBQUc7QUFBRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLEVBQUU7RUFDN0UsS0FBSyxJQUFJQyxPQUFPLEdBQUcsQ0FBQyxFQUFFQSxPQUFPLElBQUlELE9BQU8sRUFBRUMsT0FBTyxFQUFFLEVBQUU7SUFDbkQsTUFBTUMsVUFBVSxHQUFHLElBQUlDLGVBQWUsQ0FBQyxDQUFDO0lBQ3hDLE1BQU1DLEVBQUUsR0FBR0MsVUFBVSxDQUFDLE1BQU1ILFVBQVUsQ0FBQ0ksS0FBSyxDQUFDLENBQUMsRUFBRVAsT0FBTyxDQUFDO0lBQ3hELElBQUk7TUFDRixNQUFNUSxPQUFPLEdBQUc7UUFBRSxJQUFJVCxJQUFJLENBQUNTLE9BQU8sSUFBSSxDQUFDLENBQUMsQ0FBQztRQUFFLFFBQVEsRUFBRSxtQ0FBbUM7UUFBRSxZQUFZLEVBQUVaLFdBQVcsQ0FBQ00sT0FBTyxHQUFHTixXQUFXLENBQUNhLE1BQU07TUFBRSxDQUFDO01BQ25KLE1BQU1DLFNBQVMsR0FBRyxPQUFPakIsWUFBWSxLQUFLLFVBQVUsR0FBR0EsWUFBWSxHQUFHRSxvQkFBSztNQUMzRSxNQUFNZ0IsR0FBRyxHQUFHLE1BQU1ELFNBQVMsQ0FBQ1osR0FBRyxFQUFFO1FBQUUsR0FBR0MsSUFBSTtRQUFFUyxPQUFPO1FBQUVJLE1BQU0sRUFBRVQsVUFBVSxDQUFDUztNQUFPLENBQUMsQ0FBQztNQUNqRkMsWUFBWSxDQUFDUixFQUFFLENBQUM7TUFDaEIsSUFBSSxDQUFDTSxHQUFHLENBQUNHLEVBQUUsRUFBRTtRQUNUO1FBQ0E7UUFDQSxJQUFJQyxPQUFPLEdBQUcsRUFBRTtRQUNoQixJQUFJSixHQUFHLElBQUksT0FBT0EsR0FBRyxDQUFDSyxJQUFJLEtBQUssVUFBVSxFQUFFO1VBQ3pDRCxPQUFPLEdBQUcsTUFBTUosR0FBRyxDQUFDSyxJQUFJLENBQUMsQ0FBQyxDQUFDQyxLQUFLLENBQUMsTUFBTSxFQUFFLENBQUM7UUFDNUMsQ0FBQyxNQUFNLElBQUlOLEdBQUcsSUFBSSxPQUFPQSxHQUFHLENBQUNPLElBQUksS0FBSyxVQUFVLEVBQUU7VUFDaEQsSUFBSTtZQUNGLE1BQU1DLENBQUMsR0FBRyxNQUFNUixHQUFHLENBQUNPLElBQUksQ0FBQyxDQUFDO1lBQzFCSCxPQUFPLEdBQUcsT0FBT0ksQ0FBQyxLQUFLLFFBQVEsR0FBR0EsQ0FBQyxHQUFHQyxJQUFJLENBQUNDLFNBQVMsQ0FBQ0YsQ0FBQyxDQUFDO1VBQ3pELENBQUMsQ0FBQyxPQUFPRyxFQUFFLEVBQUU7WUFDWFAsT0FBTyxHQUFHLEVBQUU7VUFDZDtRQUNGO1FBQ0E7UUFDQSxJQUFJO1VBQ0YsTUFBTVEsT0FBTyxHQUFHQyxlQUFJLENBQUNDLE9BQU8sQ0FBQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSx3QkFBd0IsQ0FBQztVQUM1RUMsYUFBRSxDQUFDQyxTQUFTLENBQUNMLGVBQUksQ0FBQ00sT0FBTyxDQUFDUCxPQUFPLENBQUMsRUFBRTtZQUFFUSxTQUFTLEVBQUU7VUFBSyxDQUFDLENBQUM7VUFDeEQsTUFBTUMsS0FBSyxHQUFHLElBQUksSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUMsVUFBVXZCLEdBQUcsQ0FBQ3dCLE1BQU0sUUFBUXJDLEdBQUcsTUFBTWlCLE9BQU8sQ0FBQ3FCLEtBQUssQ0FBQyxDQUFDLEVBQUMsR0FBRyxDQUFDLE1BQU07VUFDekdSLGFBQUUsQ0FBQ1MsY0FBYyxDQUFDZCxPQUFPLEVBQUVTLEtBQUssQ0FBQztRQUNuQyxDQUFDLENBQUMsT0FBTzFDLENBQUMsRUFBRTtVQUNWO1FBQUE7UUFFRixNQUFNLElBQUlnRCxLQUFLLENBQUMsUUFBUTNCLEdBQUcsQ0FBQ3dCLE1BQU0sS0FBS3BCLE9BQU8sRUFBRSxDQUFDO01BQ3JEO01BQ0U7TUFDQTtNQUNBLElBQUl3QixFQUFFLEdBQUcsRUFBRTtNQUNYLElBQUk7UUFDRixJQUFJNUIsR0FBRyxJQUFJQSxHQUFHLENBQUNILE9BQU8sRUFBRTtVQUN0QixJQUFJLE9BQU9HLEdBQUcsQ0FBQ0gsT0FBTyxDQUFDZ0MsR0FBRyxLQUFLLFVBQVUsRUFBRTtZQUN6Q0QsRUFBRSxHQUFHNUIsR0FBRyxDQUFDSCxPQUFPLENBQUNnQyxHQUFHLENBQUMsY0FBYyxDQUFDLElBQUksRUFBRTtVQUM1QyxDQUFDLE1BQU0sSUFBSTdCLEdBQUcsQ0FBQ0gsT0FBTyxDQUFDLGNBQWMsQ0FBQyxFQUFFO1lBQ3RDK0IsRUFBRSxHQUFHNUIsR0FBRyxDQUFDSCxPQUFPLENBQUMsY0FBYyxDQUFDO1VBQ2xDO1FBQ0Y7TUFDRixDQUFDLENBQUMsT0FBT2xCLENBQUMsRUFBRTtRQUNWaUQsRUFBRSxHQUFHLEVBQUU7TUFDVDs7TUFFQTtNQUNBLElBQUksQ0FBQ0EsRUFBRSxJQUFJNUIsR0FBRyxJQUFJLE9BQU9BLEdBQUcsQ0FBQ08sSUFBSSxLQUFLLFVBQVUsRUFBRTtRQUNoRHFCLEVBQUUsR0FBRyxrQkFBa0I7TUFDekI7TUFFQSxJQUFJQSxFQUFFLElBQUlBLEVBQUUsQ0FBQ0UsV0FBVyxDQUFDLENBQUMsQ0FBQ0MsUUFBUSxDQUFDLGtCQUFrQixDQUFDLEVBQUU7UUFDdkQsSUFBSTtVQUNGLE9BQU8sT0FBTyxPQUFPL0IsR0FBRyxDQUFDTyxJQUFJLEtBQUssVUFBVSxHQUFHUCxHQUFHLENBQUNPLElBQUksQ0FBQyxDQUFDLEdBQUd5QixPQUFPLENBQUNsQixPQUFPLENBQUMsSUFBSSxDQUFDLENBQUM7UUFDcEYsQ0FBQyxDQUFDLE9BQU9tQixRQUFRLEVBQUU7VUFDakI7VUFDQSxJQUFJO1lBQ0YsTUFBTXJCLE9BQU8sR0FBR0MsZUFBSSxDQUFDQyxPQUFPLENBQUNDLE9BQU8sQ0FBQ0MsR0FBRyxDQUFDLENBQUMsRUFBRSxLQUFLLEVBQUUsd0JBQXdCLENBQUM7WUFDNUVDLGFBQUUsQ0FBQ0MsU0FBUyxDQUFDTCxlQUFJLENBQUNNLE9BQU8sQ0FBQ1AsT0FBTyxDQUFDLEVBQUU7Y0FBRVEsU0FBUyxFQUFFO1lBQUssQ0FBQyxDQUFDO1lBQ3hELE1BQU1DLEtBQUssR0FBRyxJQUFJLElBQUlDLElBQUksQ0FBQyxDQUFDLENBQUNDLFdBQVcsQ0FBQyxDQUFDLHNCQUFzQnBDLEdBQUcsa0JBQWtCOEMsUUFBUSxJQUFJQSxRQUFRLENBQUNDLE9BQU8sR0FBR0QsUUFBUSxDQUFDQyxPQUFPLEdBQUdDLE1BQU0sQ0FBQ0YsUUFBUSxDQUFDLE1BQU07WUFDN0poQixhQUFFLENBQUNTLGNBQWMsQ0FBQ2QsT0FBTyxFQUFFUyxLQUFLLENBQUM7VUFDbkMsQ0FBQyxDQUFDLE9BQU8xQyxDQUFDLEVBQUUsQ0FBQztVQUNiLE1BQU0sSUFBSWdELEtBQUssQ0FBQywwQkFBMEJNLFFBQVEsSUFBSUEsUUFBUSxDQUFDQyxPQUFPLEdBQUdELFFBQVEsQ0FBQ0MsT0FBTyxHQUFHQyxNQUFNLENBQUNGLFFBQVEsQ0FBQyxFQUFFLENBQUM7UUFDakg7TUFDRjs7TUFFQTtNQUNBLElBQUlHLFFBQVEsR0FBRyxFQUFFO01BQ2pCLElBQUlwQyxHQUFHLElBQUksT0FBT0EsR0FBRyxDQUFDSyxJQUFJLEtBQUssVUFBVSxFQUFFO1FBQ3pDK0IsUUFBUSxHQUFHLE1BQU1wQyxHQUFHLENBQUNLLElBQUksQ0FBQyxDQUFDLENBQUNDLEtBQUssQ0FBQyxNQUFNLEVBQUUsQ0FBQztNQUM3QyxDQUFDLE1BQU0sSUFBSU4sR0FBRyxJQUFJLE9BQU9BLEdBQUcsQ0FBQ08sSUFBSSxLQUFLLFVBQVUsRUFBRTtRQUNoRCxJQUFJO1VBQ0YsTUFBTUMsQ0FBQyxHQUFHLE1BQU1SLEdBQUcsQ0FBQ08sSUFBSSxDQUFDLENBQUM7VUFDMUI2QixRQUFRLEdBQUcsT0FBTzVCLENBQUMsS0FBSyxRQUFRLEdBQUdBLENBQUMsR0FBR0MsSUFBSSxDQUFDQyxTQUFTLENBQUNGLENBQUMsQ0FBQztRQUMxRCxDQUFDLENBQUMsT0FBT0csRUFBRSxFQUFFO1VBQ1h5QixRQUFRLEdBQUcsRUFBRTtRQUNmO01BQ0Y7TUFDQTtNQUNBLElBQUk7UUFDRixNQUFNeEIsT0FBTyxHQUFHQyxlQUFJLENBQUNDLE9BQU8sQ0FBQ0MsT0FBTyxDQUFDQyxHQUFHLENBQUMsQ0FBQyxFQUFFLEtBQUssRUFBRSx3QkFBd0IsQ0FBQztRQUM1RUMsYUFBRSxDQUFDQyxTQUFTLENBQUNMLGVBQUksQ0FBQ00sT0FBTyxDQUFDUCxPQUFPLENBQUMsRUFBRTtVQUFFUSxTQUFTLEVBQUU7UUFBSyxDQUFDLENBQUM7UUFDeEQsTUFBTUMsS0FBSyxHQUFHLElBQUksSUFBSUMsSUFBSSxDQUFDLENBQUMsQ0FBQ0MsV0FBVyxDQUFDLENBQUMsa0JBQWtCcEMsR0FBRyxvQkFBb0J5QyxFQUFFLFlBQVlRLFFBQVEsQ0FBQ1gsS0FBSyxDQUFDLENBQUMsRUFBQyxJQUFJLENBQUMsTUFBTTtRQUM3SFIsYUFBRSxDQUFDUyxjQUFjLENBQUNkLE9BQU8sRUFBRVMsS0FBSyxDQUFDO01BQ25DLENBQUMsQ0FBQyxPQUFPMUMsQ0FBQyxFQUFFLENBQUM7TUFDYixNQUFNLElBQUlnRCxLQUFLLENBQUMsb0NBQW9DQyxFQUFFLE1BQU1RLFFBQVEsQ0FBQ1gsS0FBSyxDQUFDLENBQUMsRUFBRSxHQUFHLENBQUMsRUFBRSxDQUFDO0lBQ3pGLENBQUMsQ0FBQyxPQUFPWSxHQUFHLEVBQUU7TUFDWm5DLFlBQVksQ0FBQ1IsRUFBRSxDQUFDO01BQ2hCLElBQUlILE9BQU8sS0FBS0QsT0FBTyxFQUFFLE1BQU0rQyxHQUFHO01BQ2xDO01BQ0EsTUFBTUMsS0FBSyxHQUFHLEdBQUcsR0FBRy9DLE9BQU8sR0FBRyxHQUFHLEdBQUdnRCxJQUFJLENBQUNDLEtBQUssQ0FBQ0QsSUFBSSxDQUFDRSxNQUFNLENBQUMsQ0FBQyxHQUFHLEdBQUcsQ0FBQztNQUNuRSxNQUFNLElBQUlULE9BQU8sQ0FBQ1UsQ0FBQyxJQUFJL0MsVUFBVSxDQUFDK0MsQ0FBQyxFQUFFSixLQUFLLENBQUMsQ0FBQztJQUM5QztFQUNGO0FBQ0Y7QUFBQyxJQUFBSyxRQUFBLEdBQUFDLE9BQUEsQ0FBQS9ELE9BQUEsR0FFY0ssU0FBUyIsImlnbm9yZUxpc3QiOltdfQ==