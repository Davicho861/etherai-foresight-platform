{"version":3,"names":["process","env","FORCE_MOCKS","NODE_ENV","cache","require","runProphecyCycle","getRiskIndices","describe","beforeEach","jest","resetModules","default","clear","test","before","expect","multiDomainRiskIndex","value","toBeNull","after","not","riskIndices","famineRisk","geophysicalRisk","supplyChainRisk","climateExtremesRisk","ethicalAssessment","toBeDefined","lastUpdated"],"sources":["predictionEngine.unit.test.js"],"sourcesContent":["process.env.FORCE_MOCKS = 'true';\nprocess.env.NODE_ENV = 'test';\n\nconst cache = require('../../src/cache.js');\n\nconst { runProphecyCycle, getRiskIndices } = require('../../src/services/predictionEngine.js');\n\ndescribe('predictionEngine - runProphecyCycle with FORCE_MOCKS', () => {\n  beforeEach(() => {\n    jest.resetModules();\n    // clear the cache singleton\n    cache.default.clear();\n  });\n\n  test('updates famine, geophysical, supply chain, climate indices and ethical assessment', async () => {\n    process.env.FORCE_MOCKS = 'true';\n    const before = getRiskIndices();\n    expect(before.multiDomainRiskIndex.value).toBeNull();\n\n    await runProphecyCycle();\n\n    const after = getRiskIndices();\n    expect(after.multiDomainRiskIndex.value).not.toBeNull();\n    expect(after.riskIndices.famineRisk.value).not.toBeNull();\n    expect(after.riskIndices.geophysicalRisk.value).not.toBeNull();\n    expect(after.riskIndices.supplyChainRisk.value).not.toBeNull();\n    expect(after.riskIndices.climateExtremesRisk.value).not.toBeNull();\n    expect(after.ethicalAssessment).toBeDefined();\n    expect(after.lastUpdated).toBeDefined();\n  });\n});\n"],"mappings":";;AAAAA,OAAO,CAACC,GAAG,CAACC,WAAW,GAAG,MAAM;AAChCF,OAAO,CAACC,GAAG,CAACE,QAAQ,GAAG,MAAM;AAE7B,MAAMC,KAAK,GAAGC,OAAO,CAAC,oBAAoB,CAAC;AAE3C,MAAM;EAAEC,gBAAgB;EAAEC;AAAe,CAAC,GAAGF,OAAO,CAAC,wCAAwC,CAAC;AAE9FG,QAAQ,CAAC,sDAAsD,EAAE,MAAM;EACrEC,UAAU,CAAC,MAAM;IACfC,IAAI,CAACC,YAAY,CAAC,CAAC;IACnB;IACAP,KAAK,CAACQ,OAAO,CAACC,KAAK,CAAC,CAAC;EACvB,CAAC,CAAC;EAEFC,IAAI,CAAC,mFAAmF,EAAE,YAAY;IACpGd,OAAO,CAACC,GAAG,CAACC,WAAW,GAAG,MAAM;IAChC,MAAMa,MAAM,GAAGR,cAAc,CAAC,CAAC;IAC/BS,MAAM,CAACD,MAAM,CAACE,oBAAoB,CAACC,KAAK,CAAC,CAACC,QAAQ,CAAC,CAAC;IAEpD,MAAMb,gBAAgB,CAAC,CAAC;IAExB,MAAMc,KAAK,GAAGb,cAAc,CAAC,CAAC;IAC9BS,MAAM,CAACI,KAAK,CAACH,oBAAoB,CAACC,KAAK,CAAC,CAACG,GAAG,CAACF,QAAQ,CAAC,CAAC;IACvDH,MAAM,CAACI,KAAK,CAACE,WAAW,CAACC,UAAU,CAACL,KAAK,CAAC,CAACG,GAAG,CAACF,QAAQ,CAAC,CAAC;IACzDH,MAAM,CAACI,KAAK,CAACE,WAAW,CAACE,eAAe,CAACN,KAAK,CAAC,CAACG,GAAG,CAACF,QAAQ,CAAC,CAAC;IAC9DH,MAAM,CAACI,KAAK,CAACE,WAAW,CAACG,eAAe,CAACP,KAAK,CAAC,CAACG,GAAG,CAACF,QAAQ,CAAC,CAAC;IAC9DH,MAAM,CAACI,KAAK,CAACE,WAAW,CAACI,mBAAmB,CAACR,KAAK,CAAC,CAACG,GAAG,CAACF,QAAQ,CAAC,CAAC;IAClEH,MAAM,CAACI,KAAK,CAACO,iBAAiB,CAAC,CAACC,WAAW,CAAC,CAAC;IAC7CZ,MAAM,CAACI,KAAK,CAACS,WAAW,CAAC,CAACD,WAAW,CAAC,CAAC;EACzC,CAAC,CAAC;AACJ,CAAC,CAAC","ignoreList":[]}