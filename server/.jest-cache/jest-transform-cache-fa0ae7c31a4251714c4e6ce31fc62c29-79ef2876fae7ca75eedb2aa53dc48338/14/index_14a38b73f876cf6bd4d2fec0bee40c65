d19c7a0b98aca961e02e188eebbeced6
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
var _chunk2HUMWGRDjs = require('../../chunk-2HUMWGRD.js');
var _chunkTIPR373Rjs = require('../../chunk-TIPR373R.js');

// src/interceptors/WebSocket/utils/bindEvent.ts
function bindEvent(target, event) {
  Object.defineProperties(event, {
    target: {
      value: target,
      enumerable: true,
      writable: true
    },
    currentTarget: {
      value: target,
      enumerable: true,
      writable: true
    }
  });
  return event;
}

// src/interceptors/WebSocket/utils/events.ts
var kCancelable = Symbol("kCancelable");
var kDefaultPrevented = Symbol("kDefaultPrevented");
var CancelableMessageEvent = class extends MessageEvent {
  constructor(type, init) {
    super(type, init);
    this[kCancelable] = !!init.cancelable;
    this[kDefaultPrevented] = false;
  }
  get cancelable() {
    return this[kCancelable];
  }
  set cancelable(nextCancelable) {
    this[kCancelable] = nextCancelable;
  }
  get defaultPrevented() {
    return this[kDefaultPrevented];
  }
  set defaultPrevented(nextDefaultPrevented) {
    this[kDefaultPrevented] = nextDefaultPrevented;
  }
  preventDefault() {
    if (this.cancelable && !this[kDefaultPrevented]) {
      this[kDefaultPrevented] = true;
    }
  }
};
kCancelable, kDefaultPrevented;
var CloseEvent = class extends Event {
  constructor(type, init = {}) {
    super(type, init);
    this.code = init.code === void 0 ? 0 : init.code;
    this.reason = init.reason === void 0 ? "" : init.reason;
    this.wasClean = init.wasClean === void 0 ? false : init.wasClean;
  }
};
var CancelableCloseEvent = class extends CloseEvent {
  constructor(type, init = {}) {
    super(type, init);
    this[kCancelable] = !!init.cancelable;
    this[kDefaultPrevented] = false;
  }
  get cancelable() {
    return this[kCancelable];
  }
  set cancelable(nextCancelable) {
    this[kCancelable] = nextCancelable;
  }
  get defaultPrevented() {
    return this[kDefaultPrevented];
  }
  set defaultPrevented(nextDefaultPrevented) {
    this[kDefaultPrevented] = nextDefaultPrevented;
  }
  preventDefault() {
    if (this.cancelable && !this[kDefaultPrevented]) {
      this[kDefaultPrevented] = true;
    }
  }
};
kCancelable, kDefaultPrevented;

// src/interceptors/WebSocket/WebSocketClientConnection.ts
var kEmitter = Symbol("kEmitter");
var kBoundListener = Symbol("kBoundListener");
var WebSocketClientConnectionProtocol = class {};
var WebSocketClientConnection = class {
  constructor(socket, transport) {
    this.socket = socket;
    this.transport = transport;
    this.id = _chunkTIPR373Rjs.createRequestId.call(void 0);
    this.url = new URL(socket.url);
    this[kEmitter] = new EventTarget();
    this.transport.addEventListener("outgoing", event => {
      const message = bindEvent(this.socket, new CancelableMessageEvent("message", {
        data: event.data,
        origin: event.origin,
        cancelable: true
      }));
      this[kEmitter].dispatchEvent(message);
      if (message.defaultPrevented) {
        event.preventDefault();
      }
    });
    this.transport.addEventListener("close", event => {
      this[kEmitter].dispatchEvent(bindEvent(this.socket, new CloseEvent("close", event)));
    });
  }
  /**
   * Listen for the outgoing events from the connected WebSocket client.
   */
  addEventListener(type, listener, options) {
    if (!Reflect.has(listener, kBoundListener)) {
      const boundListener = listener.bind(this.socket);
      Object.defineProperty(listener, kBoundListener, {
        value: boundListener,
        enumerable: false,
        configurable: false
      });
    }
    this[kEmitter].addEventListener(type, Reflect.get(listener, kBoundListener), options);
  }
  /**
   * Removes the listener for the given event.
   */
  removeEventListener(event, listener, options) {
    this[kEmitter].removeEventListener(event, Reflect.get(listener, kBoundListener), options);
  }
  /**
   * Send data to the connected client.
   */
  send(data) {
    this.transport.send(data);
  }
  /**
   * Close the WebSocket connection.
   * @param {number} code A status code (see https://www.rfc-editor.org/rfc/rfc6455#section-7.4.1).
   * @param {string} reason A custom connection close reason.
   */
  close(code, reason) {
    this.transport.close(code, reason);
  }
};
kEmitter;

// src/interceptors/WebSocket/WebSocketServerConnection.ts
var _outvariant = require('outvariant');

// src/interceptors/WebSocket/WebSocketOverride.ts

var _deferredpromise = require('@open-draft/deferred-promise');
var WEBSOCKET_CLOSE_CODE_RANGE_ERROR = "InvalidAccessError: close code out of user configurable range";
var kPassthroughPromise = Symbol("kPassthroughPromise");
var kOnSend = Symbol("kOnSend");
var kClose = Symbol("kClose");
var WebSocketOverride = class extends EventTarget {
  constructor(url, protocols) {
    super();
    this.CONNECTING = 0;
    this.OPEN = 1;
    this.CLOSING = 2;
    this.CLOSED = 3;
    this._onopen = null;
    this._onmessage = null;
    this._onerror = null;
    this._onclose = null;
    this.url = url.toString();
    this.protocol = "";
    this.extensions = "";
    this.binaryType = "blob";
    this.readyState = this.CONNECTING;
    this.bufferedAmount = 0;
    this[kPassthroughPromise] = new (0, _deferredpromise.DeferredPromise)();
    queueMicrotask(async () => {
      if (await this[kPassthroughPromise]) {
        return;
      }
      this.protocol = typeof protocols === "string" ? protocols : Array.isArray(protocols) && protocols.length > 0 ? protocols[0] : "";
      if (this.readyState === this.CONNECTING) {
        this.readyState = this.OPEN;
        this.dispatchEvent(bindEvent(this, new Event("open")));
      }
    });
  }
  set onopen(listener) {
    this.removeEventListener("open", this._onopen);
    this._onopen = listener;
    if (listener !== null) {
      this.addEventListener("open", listener);
    }
  }
  get onopen() {
    return this._onopen;
  }
  set onmessage(listener) {
    this.removeEventListener("message", this._onmessage);
    this._onmessage = listener;
    if (listener !== null) {
      this.addEventListener("message", listener);
    }
  }
  get onmessage() {
    return this._onmessage;
  }
  set onerror(listener) {
    this.removeEventListener("error", this._onerror);
    this._onerror = listener;
    if (listener !== null) {
      this.addEventListener("error", listener);
    }
  }
  get onerror() {
    return this._onerror;
  }
  set onclose(listener) {
    this.removeEventListener("close", this._onclose);
    this._onclose = listener;
    if (listener !== null) {
      this.addEventListener("close", listener);
    }
  }
  get onclose() {
    return this._onclose;
  }
  /**
   * @see https://websockets.spec.whatwg.org/#ref-for-dom-websocket-send%E2%91%A0
   */
  send(data) {
    if (this.readyState === this.CONNECTING) {
      this.close();
      throw new DOMException("InvalidStateError");
    }
    if (this.readyState === this.CLOSING || this.readyState === this.CLOSED) {
      return;
    }
    this.bufferedAmount += getDataSize(data);
    queueMicrotask(() => {
      var _a;
      this.bufferedAmount = 0;
      (_a = this[kOnSend]) == null ? void 0 : _a.call(this, data);
    });
  }
  close(code = 1e3, reason) {
    _outvariant.invariant.call(void 0, code, WEBSOCKET_CLOSE_CODE_RANGE_ERROR);
    _outvariant.invariant.call(void 0, code === 1e3 || code >= 3e3 && code <= 4999, WEBSOCKET_CLOSE_CODE_RANGE_ERROR);
    this[kClose](code, reason);
  }
  [(kPassthroughPromise, kOnSend, kClose)](code = 1e3, reason, wasClean = true) {
    if (this.readyState === this.CLOSING || this.readyState === this.CLOSED) {
      return;
    }
    this.readyState = this.CLOSING;
    queueMicrotask(() => {
      this.readyState = this.CLOSED;
      this.dispatchEvent(bindEvent(this, new CloseEvent("close", {
        code,
        reason,
        wasClean
      })));
      this._onopen = null;
      this._onmessage = null;
      this._onerror = null;
      this._onclose = null;
    });
  }
  addEventListener(type, listener, options) {
    return super.addEventListener(type, listener, options);
  }
  removeEventListener(type, callback, options) {
    return super.removeEventListener(type, callback, options);
  }
};
WebSocketOverride.CONNECTING = 0;
WebSocketOverride.OPEN = 1;
WebSocketOverride.CLOSING = 2;
WebSocketOverride.CLOSED = 3;
function getDataSize(data) {
  if (typeof data === "string") {
    return data.length;
  }
  if (data instanceof Blob) {
    return data.size;
  }
  return data.byteLength;
}

// src/interceptors/WebSocket/WebSocketServerConnection.ts
var kEmitter2 = Symbol("kEmitter");
var kBoundListener2 = Symbol("kBoundListener");
var kSend = Symbol("kSend");
var WebSocketServerConnectionProtocol = class {};
var WebSocketServerConnection = class {
  constructor(client, transport, createConnection) {
    this.client = client;
    this.transport = transport;
    this.createConnection = createConnection;
    this[kEmitter2] = new EventTarget();
    this.mockCloseController = new AbortController();
    this.realCloseController = new AbortController();
    this.transport.addEventListener("outgoing", event => {
      if (typeof this.realWebSocket === "undefined") {
        return;
      }
      queueMicrotask(() => {
        if (!event.defaultPrevented) {
          this[kSend](event.data);
        }
      });
    });
    this.transport.addEventListener("incoming", this.handleIncomingMessage.bind(this));
  }
  /**
   * The `WebSocket` instance connected to the original server.
   * Accessing this before calling `server.connect()` will throw.
   */
  get socket() {
    _outvariant.invariant.call(void 0, this.realWebSocket, 'Cannot access "socket" on the original WebSocket server object: the connection is not open. Did you forget to call `server.connect()`?');
    return this.realWebSocket;
  }
  /**
   * Open connection to the original WebSocket server.
   */
  connect() {
    _outvariant.invariant.call(void 0, !this.realWebSocket || this.realWebSocket.readyState !== WebSocket.OPEN, 'Failed to call "connect()" on the original WebSocket instance: the connection already open');
    const realWebSocket = this.createConnection();
    realWebSocket.binaryType = this.client.binaryType;
    realWebSocket.addEventListener("open", event => {
      this[kEmitter2].dispatchEvent(bindEvent(this.realWebSocket, new Event("open", event)));
    }, {
      once: true
    });
    realWebSocket.addEventListener("message", event => {
      this.transport.dispatchEvent(bindEvent(this.realWebSocket, new MessageEvent("incoming", {
        data: event.data,
        origin: event.origin
      })));
    });
    this.client.addEventListener("close", event => {
      this.handleMockClose(event);
    }, {
      signal: this.mockCloseController.signal
    });
    realWebSocket.addEventListener("close", event => {
      this.handleRealClose(event);
    }, {
      signal: this.realCloseController.signal
    });
    realWebSocket.addEventListener("error", () => {
      const errorEvent = bindEvent(realWebSocket, new Event("error", {
        cancelable: true
      }));
      this[kEmitter2].dispatchEvent(errorEvent);
      if (!errorEvent.defaultPrevented) {
        this.client.dispatchEvent(bindEvent(this.client, new Event("error")));
      }
    });
    this.realWebSocket = realWebSocket;
  }
  /**
   * Listen for the incoming events from the original WebSocket server.
   */
  addEventListener(event, listener, options) {
    if (!Reflect.has(listener, kBoundListener2)) {
      const boundListener = listener.bind(this.client);
      Object.defineProperty(listener, kBoundListener2, {
        value: boundListener,
        enumerable: false
      });
    }
    this[kEmitter2].addEventListener(event, Reflect.get(listener, kBoundListener2), options);
  }
  /**
   * Remove the listener for the given event.
   */
  removeEventListener(event, listener, options) {
    this[kEmitter2].removeEventListener(event, Reflect.get(listener, kBoundListener2), options);
  }
  /**
   * Send data to the original WebSocket server.
   * @example
   * server.send('hello')
   * server.send(new Blob(['hello']))
   * server.send(new TextEncoder().encode('hello'))
   */
  send(data) {
    this[kSend](data);
  }
  [(kEmitter2, kSend)](data) {
    const {
      realWebSocket
    } = this;
    _outvariant.invariant.call(void 0, realWebSocket, 'Failed to call "server.send()" for "%s": the connection is not open. Did you forget to call "server.connect()"?', this.client.url);
    if (realWebSocket.readyState === WebSocket.CLOSING || realWebSocket.readyState === WebSocket.CLOSED) {
      return;
    }
    if (realWebSocket.readyState === WebSocket.CONNECTING) {
      realWebSocket.addEventListener("open", () => {
        realWebSocket.send(data);
      }, {
        once: true
      });
      return;
    }
    realWebSocket.send(data);
  }
  /**
   * Close the actual server connection.
   */
  close() {
    const {
      realWebSocket
    } = this;
    _outvariant.invariant.call(void 0, realWebSocket, 'Failed to close server connection for "%s": the connection is not open. Did you forget to call "server.connect()"?', this.client.url);
    this.realCloseController.abort();
    if (realWebSocket.readyState === WebSocket.CLOSING || realWebSocket.readyState === WebSocket.CLOSED) {
      return;
    }
    realWebSocket.close();
    queueMicrotask(() => {
      this[kEmitter2].dispatchEvent(bindEvent(this.realWebSocket, new CancelableCloseEvent("close", {
        /**
         * @note `server.close()` in the interceptor
         * always results in clean closures.
         */
        code: 1e3,
        cancelable: true
      })));
    });
  }
  handleIncomingMessage(event) {
    const messageEvent = bindEvent(event.target, new CancelableMessageEvent("message", {
      data: event.data,
      origin: event.origin,
      cancelable: true
    }));
    this[kEmitter2].dispatchEvent(messageEvent);
    if (!messageEvent.defaultPrevented) {
      this.client.dispatchEvent(bindEvent(
      /**
       * @note Bind the forwarded original server events
       * to the mock WebSocket instance so it would
       * dispatch them straight away.
       */
      this.client,
      // Clone the message event again to prevent
      // the "already being dispatched" exception.
      new MessageEvent("message", {
        data: event.data,
        origin: event.origin
      })));
    }
  }
  handleMockClose(_event) {
    if (this.realWebSocket) {
      this.realWebSocket.close();
    }
  }
  handleRealClose(event) {
    this.mockCloseController.abort();
    const closeEvent = bindEvent(this.realWebSocket, new CancelableCloseEvent("close", {
      code: event.code,
      reason: event.reason,
      wasClean: event.wasClean,
      cancelable: true
    }));
    this[kEmitter2].dispatchEvent(closeEvent);
    if (!closeEvent.defaultPrevented) {
      this.client[kClose](event.code, event.reason);
    }
  }
};

// src/interceptors/WebSocket/WebSocketClassTransport.ts
var WebSocketClassTransport = class extends EventTarget {
  constructor(socket) {
    super();
    this.socket = socket;
    this.socket.addEventListener("close", event => {
      this.dispatchEvent(bindEvent(this.socket, new CloseEvent("close", event)));
    });
    this.socket[kOnSend] = data => {
      this.dispatchEvent(bindEvent(this.socket,
      // Dispatch this as cancelable because "client" connection
      // re-creates this message event (cannot dispatch the same event).
      new CancelableMessageEvent("outgoing", {
        data,
        origin: this.socket.url,
        cancelable: true
      })));
    };
  }
  addEventListener(type, callback, options) {
    return super.addEventListener(type, callback, options);
  }
  dispatchEvent(event) {
    return super.dispatchEvent(event);
  }
  send(data) {
    queueMicrotask(() => {
      if (this.socket.readyState === this.socket.CLOSING || this.socket.readyState === this.socket.CLOSED) {
        return;
      }
      const dispatchEvent = () => {
        this.socket.dispatchEvent(bindEvent(
        /**
         * @note Setting this event's "target" to the
         * WebSocket override instance is important.
         * This way it can tell apart original incoming events
         * (must be forwarded to the transport) from the
         * mocked message events like the one below
         * (must be dispatched on the client instance).
         */
        this.socket, new MessageEvent("message", {
          data,
          origin: this.socket.url
        })));
      };
      if (this.socket.readyState === this.socket.CONNECTING) {
        this.socket.addEventListener("open", () => {
          dispatchEvent();
        }, {
          once: true
        });
      } else {
        dispatchEvent();
      }
    });
  }
  close(code, reason) {
    this.socket[kClose](code, reason);
  }
};

// src/interceptors/WebSocket/index.ts
var _WebSocketInterceptor = class extends _chunkTIPR373Rjs.Interceptor {
  constructor() {
    super(_WebSocketInterceptor.symbol);
  }
  checkEnvironment() {
    return _chunk2HUMWGRDjs.hasConfigurableGlobal.call(void 0, "WebSocket");
  }
  setup() {
    const originalWebSocketDescriptor = Object.getOwnPropertyDescriptor(globalThis, "WebSocket");
    const WebSocketProxy = new Proxy(globalThis.WebSocket, {
      construct: (target, args, newTarget) => {
        const [url, protocols] = args;
        const createConnection = () => {
          return Reflect.construct(target, args, newTarget);
        };
        const socket = new WebSocketOverride(url, protocols);
        const transport = new WebSocketClassTransport(socket);
        queueMicrotask(async () => {
          try {
            const server = new WebSocketServerConnection(socket, transport, createConnection);
            const hasConnectionListeners = this.emitter.listenerCount("connection") > 0;
            await _chunk2HUMWGRDjs.emitAsync.call(void 0, this.emitter, "connection", {
              client: new WebSocketClientConnection(socket, transport),
              server,
              info: {
                protocols
              }
            });
            if (hasConnectionListeners) {
              socket[kPassthroughPromise].resolve(false);
            } else {
              socket[kPassthroughPromise].resolve(true);
              server.connect();
              server.addEventListener("open", () => {
                socket.dispatchEvent(bindEvent(socket, new Event("open")));
                if (server["realWebSocket"]) {
                  socket.protocol = server["realWebSocket"].protocol;
                }
              });
            }
          } catch (error) {
            if (error instanceof Error) {
              socket.dispatchEvent(new Event("error"));
              if (socket.readyState !== WebSocket.CLOSING && socket.readyState !== WebSocket.CLOSED) {
                socket[kClose](1011, error.message, false);
              }
              console.error(error);
            }
          }
        });
        return socket;
      }
    });
    Object.defineProperty(globalThis, "WebSocket", {
      value: WebSocketProxy,
      configurable: true
    });
    this.subscriptions.push(() => {
      Object.defineProperty(globalThis, "WebSocket", originalWebSocketDescriptor);
    });
  }
};
var WebSocketInterceptor = _WebSocketInterceptor;
WebSocketInterceptor.symbol = Symbol("websocket");
exports.CancelableCloseEvent = CancelableCloseEvent;
exports.CancelableMessageEvent = CancelableMessageEvent;
exports.CloseEvent = CloseEvent;
exports.WebSocketClientConnection = WebSocketClientConnection;
exports.WebSocketClientConnectionProtocol = WebSocketClientConnectionProtocol;
exports.WebSocketInterceptor = WebSocketInterceptor;
exports.WebSocketServerConnection = WebSocketServerConnection;
exports.WebSocketServerConnectionProtocol = WebSocketServerConnectionProtocol;
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJiaW5kRXZlbnQiLCJ0YXJnZXQiLCJldmVudCIsIk9iamVjdCIsImRlZmluZVByb3BlcnRpZXMiLCJ2YWx1ZSIsImVudW1lcmFibGUiLCJ3cml0YWJsZSIsImN1cnJlbnRUYXJnZXQiLCJrQ2FuY2VsYWJsZSIsIlN5bWJvbCIsImtEZWZhdWx0UHJldmVudGVkIiwiQ2FuY2VsYWJsZU1lc3NhZ2VFdmVudCIsIk1lc3NhZ2VFdmVudCIsImNvbnN0cnVjdG9yIiwidHlwZSIsImluaXQiLCJjYW5jZWxhYmxlIiwibmV4dENhbmNlbGFibGUiLCJkZWZhdWx0UHJldmVudGVkIiwibmV4dERlZmF1bHRQcmV2ZW50ZWQiLCJwcmV2ZW50RGVmYXVsdCIsIkNsb3NlRXZlbnQiLCJFdmVudCIsImNvZGUiLCJyZWFzb24iLCJ3YXNDbGVhbiIsIkNhbmNlbGFibGVDbG9zZUV2ZW50Iiwia0VtaXR0ZXIiLCJrQm91bmRMaXN0ZW5lciIsIldlYlNvY2tldENsaWVudENvbm5lY3Rpb25Qcm90b2NvbCIsIldlYlNvY2tldENsaWVudENvbm5lY3Rpb24iLCJzb2NrZXQiLCJ0cmFuc3BvcnQiLCJpZCIsIl9jaHVua1RJUFIzNzNSanMiLCJjcmVhdGVSZXF1ZXN0SWQiLCJjYWxsIiwidXJsIiwiVVJMIiwiRXZlbnRUYXJnZXQiLCJhZGRFdmVudExpc3RlbmVyIiwibWVzc2FnZSIsImRhdGEiLCJvcmlnaW4iLCJkaXNwYXRjaEV2ZW50IiwibGlzdGVuZXIiLCJvcHRpb25zIiwiUmVmbGVjdCIsImhhcyIsImJvdW5kTGlzdGVuZXIiLCJiaW5kIiwiZGVmaW5lUHJvcGVydHkiLCJjb25maWd1cmFibGUiLCJnZXQiLCJyZW1vdmVFdmVudExpc3RlbmVyIiwic2VuZCIsImNsb3NlIiwiX291dHZhcmlhbnQiLCJyZXF1aXJlIiwiX2RlZmVycmVkcHJvbWlzZSIsIldFQlNPQ0tFVF9DTE9TRV9DT0RFX1JBTkdFX0VSUk9SIiwia1Bhc3N0aHJvdWdoUHJvbWlzZSIsImtPblNlbmQiLCJrQ2xvc2UiLCJXZWJTb2NrZXRPdmVycmlkZSIsInByb3RvY29scyIsIkNPTk5FQ1RJTkciLCJPUEVOIiwiQ0xPU0lORyIsIkNMT1NFRCIsIl9vbm9wZW4iLCJfb25tZXNzYWdlIiwiX29uZXJyb3IiLCJfb25jbG9zZSIsInRvU3RyaW5nIiwicHJvdG9jb2wiLCJleHRlbnNpb25zIiwiYmluYXJ5VHlwZSIsInJlYWR5U3RhdGUiLCJidWZmZXJlZEFtb3VudCIsIkRlZmVycmVkUHJvbWlzZSIsInF1ZXVlTWljcm90YXNrIiwiQXJyYXkiLCJpc0FycmF5IiwibGVuZ3RoIiwib25vcGVuIiwib25tZXNzYWdlIiwib25lcnJvciIsIm9uY2xvc2UiLCJET01FeGNlcHRpb24iLCJnZXREYXRhU2l6ZSIsIl9hIiwiaW52YXJpYW50IiwiY2FsbGJhY2siLCJCbG9iIiwic2l6ZSIsImJ5dGVMZW5ndGgiLCJrRW1pdHRlcjIiLCJrQm91bmRMaXN0ZW5lcjIiLCJrU2VuZCIsIldlYlNvY2tldFNlcnZlckNvbm5lY3Rpb25Qcm90b2NvbCIsIldlYlNvY2tldFNlcnZlckNvbm5lY3Rpb24iLCJjbGllbnQiLCJjcmVhdGVDb25uZWN0aW9uIiwibW9ja0Nsb3NlQ29udHJvbGxlciIsIkFib3J0Q29udHJvbGxlciIsInJlYWxDbG9zZUNvbnRyb2xsZXIiLCJyZWFsV2ViU29ja2V0IiwiaGFuZGxlSW5jb21pbmdNZXNzYWdlIiwiY29ubmVjdCIsIldlYlNvY2tldCIsIm9uY2UiLCJoYW5kbGVNb2NrQ2xvc2UiLCJzaWduYWwiLCJoYW5kbGVSZWFsQ2xvc2UiLCJlcnJvckV2ZW50IiwiYWJvcnQiLCJtZXNzYWdlRXZlbnQiLCJfZXZlbnQiLCJjbG9zZUV2ZW50IiwiV2ViU29ja2V0Q2xhc3NUcmFuc3BvcnQiLCJfV2ViU29ja2V0SW50ZXJjZXB0b3IiLCJJbnRlcmNlcHRvciIsInN5bWJvbCIsImNoZWNrRW52aXJvbm1lbnQiLCJfY2h1bmsySFVNV0dSRGpzIiwiaGFzQ29uZmlndXJhYmxlR2xvYmFsIiwic2V0dXAiLCJvcmlnaW5hbFdlYlNvY2tldERlc2NyaXB0b3IiLCJnZXRPd25Qcm9wZXJ0eURlc2NyaXB0b3IiLCJnbG9iYWxUaGlzIiwiV2ViU29ja2V0UHJveHkiLCJQcm94eSIsImNvbnN0cnVjdCIsImFyZ3MiLCJuZXdUYXJnZXQiLCJzZXJ2ZXIiLCJoYXNDb25uZWN0aW9uTGlzdGVuZXJzIiwiZW1pdHRlciIsImxpc3RlbmVyQ291bnQiLCJlbWl0QXN5bmMiLCJpbmZvIiwicmVzb2x2ZSIsImVycm9yIiwiRXJyb3IiLCJjb25zb2xlIiwic3Vic2NyaXB0aW9ucyIsInB1c2giLCJXZWJTb2NrZXRJbnRlcmNlcHRvciJdLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uL3NyYy9pbnRlcmNlcHRvcnMvV2ViU29ja2V0L3V0aWxzL2JpbmRFdmVudC50cyIsIi4uLy4uLy4uLy4uL3NyYy9pbnRlcmNlcHRvcnMvV2ViU29ja2V0L3V0aWxzL2V2ZW50cy50cyIsIi4uLy4uLy4uLy4uL3NyYy9pbnRlcmNlcHRvcnMvV2ViU29ja2V0L1dlYlNvY2tldENsaWVudENvbm5lY3Rpb24udHMiLCIuLi8uLi8uLi8uLi9zcmMvaW50ZXJjZXB0b3JzL1dlYlNvY2tldC9XZWJTb2NrZXRTZXJ2ZXJDb25uZWN0aW9uLnRzIiwiLi4vLi4vLi4vLi4vc3JjL2ludGVyY2VwdG9ycy9XZWJTb2NrZXQvV2ViU29ja2V0T3ZlcnJpZGUudHMiLCIuLi8uLi8uLi8uLi9zcmMvaW50ZXJjZXB0b3JzL1dlYlNvY2tldC9XZWJTb2NrZXRDbGFzc1RyYW5zcG9ydC50cyIsIi4uLy4uLy4uLy4uL3NyYy9pbnRlcmNlcHRvcnMvV2ViU29ja2V0L2luZGV4LnRzIl0sInNvdXJjZXNDb250ZW50IjpbInR5cGUgRXZlbnRXaXRoVGFyZ2V0PEUgZXh0ZW5kcyBFdmVudCwgVD4gPSBFICYgeyB0YXJnZXQ6IFQgfVxuXG5leHBvcnQgZnVuY3Rpb24gYmluZEV2ZW50PEUgZXh0ZW5kcyBFdmVudCwgVD4oXG4gIHRhcmdldDogVCxcbiAgZXZlbnQ6IEVcbik6IEV2ZW50V2l0aFRhcmdldDxFLCBUPiB7XG4gIE9iamVjdC5kZWZpbmVQcm9wZXJ0aWVzKGV2ZW50LCB7XG4gICAgdGFyZ2V0OiB7XG4gICAgICB2YWx1ZTogdGFyZ2V0LFxuICAgICAgZW51bWVyYWJsZTogdHJ1ZSxcbiAgICAgIHdyaXRhYmxlOiB0cnVlLFxuICAgIH0sXG4gICAgY3VycmVudFRhcmdldDoge1xuICAgICAgdmFsdWU6IHRhcmdldCxcbiAgICAgIGVudW1lcmFibGU6IHRydWUsXG4gICAgICB3cml0YWJsZTogdHJ1ZSxcbiAgICB9LFxuICB9KVxuXG4gIHJldHVybiBldmVudCBhcyBFdmVudFdpdGhUYXJnZXQ8RSwgVD5cbn1cbiIsImNvbnN0IGtDYW5jZWxhYmxlID0gU3ltYm9sKCdrQ2FuY2VsYWJsZScpXG5jb25zdCBrRGVmYXVsdFByZXZlbnRlZCA9IFN5bWJvbCgna0RlZmF1bHRQcmV2ZW50ZWQnKVxuXG4vKipcbiAqIEEgYE1lc3NhZ2VFdmVudGAgc3VwZXJzZXQgdGhhdCBzdXBwb3J0cyBldmVudCBjYW5jZWxsYXRpb25cbiAqIGluIE5vZGUuanMuIEl0J3MgcmF0aGVyIG5vbi1pbnRydXNpdmUgc28gaXQgY2FuIGJlIHNhZmVseVxuICogdXNlZCBpbiB0aGUgYnJvd3NlciBhcyB3ZWxsLlxuICpcbiAqIEBzZWUgaHR0cHM6Ly9naXRodWIuY29tL25vZGVqcy9ub2RlL2lzc3Vlcy81MTc2N1xuICovXG5leHBvcnQgY2xhc3MgQ2FuY2VsYWJsZU1lc3NhZ2VFdmVudDxUID0gYW55PiBleHRlbmRzIE1lc3NhZ2VFdmVudDxUPiB7XG4gIFtrQ2FuY2VsYWJsZV06IGJvb2xlYW47XG4gIFtrRGVmYXVsdFByZXZlbnRlZF06IGJvb2xlYW5cblxuICBjb25zdHJ1Y3Rvcih0eXBlOiBzdHJpbmcsIGluaXQ6IE1lc3NhZ2VFdmVudEluaXQ8VD4pIHtcbiAgICBzdXBlcih0eXBlLCBpbml0KVxuICAgIHRoaXNba0NhbmNlbGFibGVdID0gISFpbml0LmNhbmNlbGFibGVcbiAgICB0aGlzW2tEZWZhdWx0UHJldmVudGVkXSA9IGZhbHNlXG4gIH1cblxuICBnZXQgY2FuY2VsYWJsZSgpIHtcbiAgICByZXR1cm4gdGhpc1trQ2FuY2VsYWJsZV1cbiAgfVxuXG4gIHNldCBjYW5jZWxhYmxlKG5leHRDYW5jZWxhYmxlKSB7XG4gICAgdGhpc1trQ2FuY2VsYWJsZV0gPSBuZXh0Q2FuY2VsYWJsZVxuICB9XG5cbiAgZ2V0IGRlZmF1bHRQcmV2ZW50ZWQoKSB7XG4gICAgcmV0dXJuIHRoaXNba0RlZmF1bHRQcmV2ZW50ZWRdXG4gIH1cblxuICBzZXQgZGVmYXVsdFByZXZlbnRlZChuZXh0RGVmYXVsdFByZXZlbnRlZCkge1xuICAgIHRoaXNba0RlZmF1bHRQcmV2ZW50ZWRdID0gbmV4dERlZmF1bHRQcmV2ZW50ZWRcbiAgfVxuXG4gIHB1YmxpYyBwcmV2ZW50RGVmYXVsdCgpOiB2b2lkIHtcbiAgICBpZiAodGhpcy5jYW5jZWxhYmxlICYmICF0aGlzW2tEZWZhdWx0UHJldmVudGVkXSkge1xuICAgICAgdGhpc1trRGVmYXVsdFByZXZlbnRlZF0gPSB0cnVlXG4gICAgfVxuICB9XG59XG5cbmludGVyZmFjZSBDbG9zZUV2ZW50SW5pdCBleHRlbmRzIEV2ZW50SW5pdCB7XG4gIGNvZGU/OiBudW1iZXJcbiAgcmVhc29uPzogc3RyaW5nXG4gIHdhc0NsZWFuPzogYm9vbGVhblxufVxuXG5leHBvcnQgY2xhc3MgQ2xvc2VFdmVudCBleHRlbmRzIEV2ZW50IHtcbiAgcHVibGljIGNvZGU6IG51bWJlclxuICBwdWJsaWMgcmVhc29uOiBzdHJpbmdcbiAgcHVibGljIHdhc0NsZWFuOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IodHlwZTogc3RyaW5nLCBpbml0OiBDbG9zZUV2ZW50SW5pdCA9IHt9KSB7XG4gICAgc3VwZXIodHlwZSwgaW5pdClcbiAgICB0aGlzLmNvZGUgPSBpbml0LmNvZGUgPT09IHVuZGVmaW5lZCA/IDAgOiBpbml0LmNvZGVcbiAgICB0aGlzLnJlYXNvbiA9IGluaXQucmVhc29uID09PSB1bmRlZmluZWQgPyAnJyA6IGluaXQucmVhc29uXG4gICAgdGhpcy53YXNDbGVhbiA9IGluaXQud2FzQ2xlYW4gPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogaW5pdC53YXNDbGVhblxuICB9XG59XG5cbmV4cG9ydCBjbGFzcyBDYW5jZWxhYmxlQ2xvc2VFdmVudCBleHRlbmRzIENsb3NlRXZlbnQge1xuICBba0NhbmNlbGFibGVdOiBib29sZWFuO1xuICBba0RlZmF1bHRQcmV2ZW50ZWRdOiBib29sZWFuXG5cbiAgY29uc3RydWN0b3IodHlwZTogc3RyaW5nLCBpbml0OiBDbG9zZUV2ZW50SW5pdCA9IHt9KSB7XG4gICAgc3VwZXIodHlwZSwgaW5pdClcbiAgICB0aGlzW2tDYW5jZWxhYmxlXSA9ICEhaW5pdC5jYW5jZWxhYmxlXG4gICAgdGhpc1trRGVmYXVsdFByZXZlbnRlZF0gPSBmYWxzZVxuICB9XG5cbiAgZ2V0IGNhbmNlbGFibGUoKSB7XG4gICAgcmV0dXJuIHRoaXNba0NhbmNlbGFibGVdXG4gIH1cblxuICBzZXQgY2FuY2VsYWJsZShuZXh0Q2FuY2VsYWJsZSkge1xuICAgIHRoaXNba0NhbmNlbGFibGVdID0gbmV4dENhbmNlbGFibGVcbiAgfVxuXG4gIGdldCBkZWZhdWx0UHJldmVudGVkKCkge1xuICAgIHJldHVybiB0aGlzW2tEZWZhdWx0UHJldmVudGVkXVxuICB9XG5cbiAgc2V0IGRlZmF1bHRQcmV2ZW50ZWQobmV4dERlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICB0aGlzW2tEZWZhdWx0UHJldmVudGVkXSA9IG5leHREZWZhdWx0UHJldmVudGVkXG4gIH1cblxuICBwdWJsaWMgcHJldmVudERlZmF1bHQoKTogdm9pZCB7XG4gICAgaWYgKHRoaXMuY2FuY2VsYWJsZSAmJiAhdGhpc1trRGVmYXVsdFByZXZlbnRlZF0pIHtcbiAgICAgIHRoaXNba0RlZmF1bHRQcmV2ZW50ZWRdID0gdHJ1ZVxuICAgIH1cbiAgfVxufVxuIiwiaW1wb3J0IHR5cGUgeyBXZWJTb2NrZXREYXRhLCBXZWJTb2NrZXRUcmFuc3BvcnQgfSBmcm9tICcuL1dlYlNvY2tldFRyYW5zcG9ydCdcbmltcG9ydCB0eXBlIHsgV2ViU29ja2V0RXZlbnRMaXN0ZW5lciB9IGZyb20gJy4vV2ViU29ja2V0T3ZlcnJpZGUnXG5pbXBvcnQgeyBiaW5kRXZlbnQgfSBmcm9tICcuL3V0aWxzL2JpbmRFdmVudCdcbmltcG9ydCB7IENhbmNlbGFibGVNZXNzYWdlRXZlbnQsIENsb3NlRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cydcbmltcG9ydCB7IGNyZWF0ZVJlcXVlc3RJZCB9IGZyb20gJy4uLy4uL2NyZWF0ZVJlcXVlc3RJZCdcblxuY29uc3Qga0VtaXR0ZXIgPSBTeW1ib2woJ2tFbWl0dGVyJylcbmNvbnN0IGtCb3VuZExpc3RlbmVyID0gU3ltYm9sKCdrQm91bmRMaXN0ZW5lcicpXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0Q2xpZW50RXZlbnRNYXAge1xuICBtZXNzYWdlOiBNZXNzYWdlRXZlbnQ8V2ViU29ja2V0RGF0YT5cbiAgY2xvc2U6IENsb3NlRXZlbnRcbn1cblxuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFdlYlNvY2tldENsaWVudENvbm5lY3Rpb25Qcm90b2NvbCB7XG4gIGFic3RyYWN0IGlkOiBzdHJpbmdcbiAgYWJzdHJhY3QgdXJsOiBVUkxcbiAgcHVibGljIGFic3RyYWN0IHNlbmQoZGF0YTogV2ViU29ja2V0RGF0YSk6IHZvaWRcbiAgcHVibGljIGFic3RyYWN0IGNsb3NlKGNvZGU/OiBudW1iZXIsIHJlYXNvbj86IHN0cmluZyk6IHZvaWRcblxuICBwdWJsaWMgYWJzdHJhY3QgYWRkRXZlbnRMaXN0ZW5lcjxcbiAgICBFdmVudFR5cGUgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRDbGllbnRFdmVudE1hcFxuICA+KFxuICAgIHR5cGU6IEV2ZW50VHlwZSxcbiAgICBsaXN0ZW5lcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxXZWJTb2NrZXRDbGllbnRFdmVudE1hcFtFdmVudFR5cGVdPixcbiAgICBvcHRpb25zPzogQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnMgfCBib29sZWFuXG4gICk6IHZvaWRcblxuICBwdWJsaWMgYWJzdHJhY3QgcmVtb3ZlRXZlbnRMaXN0ZW5lcjxcbiAgICBFdmVudFR5cGUgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRDbGllbnRFdmVudE1hcFxuICA+KFxuICAgIGV2ZW50OiBFdmVudFR5cGUsXG4gICAgbGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8V2ViU29ja2V0Q2xpZW50RXZlbnRNYXBbRXZlbnRUeXBlXT4sXG4gICAgb3B0aW9ucz86IEV2ZW50TGlzdGVuZXJPcHRpb25zIHwgYm9vbGVhblxuICApOiB2b2lkXG59XG5cbi8qKlxuICogVGhlIFdlYlNvY2tldCBjbGllbnQgaW5zdGFuY2UgcmVwcmVzZW50cyBhbiBpbmNvbWluZ1xuICogY2xpZW50IGNvbm5lY3Rpb24uIFRoZSB1c2VyIGNhbiBjb250cm9sIHRoZSBjb25uZWN0aW9uLFxuICogc2VuZCBhbmQgcmVjZWl2ZSBldmVudHMuXG4gKi9cbmV4cG9ydCBjbGFzcyBXZWJTb2NrZXRDbGllbnRDb25uZWN0aW9uXG4gIGltcGxlbWVudHMgV2ViU29ja2V0Q2xpZW50Q29ubmVjdGlvblByb3RvY29sXG57XG4gIHB1YmxpYyByZWFkb25seSBpZDogc3RyaW5nXG4gIHB1YmxpYyByZWFkb25seSB1cmw6IFVSTFxuXG4gIHByaXZhdGUgW2tFbWl0dGVyXTogRXZlbnRUYXJnZXRcblxuICBjb25zdHJ1Y3RvcihcbiAgICBwdWJsaWMgcmVhZG9ubHkgc29ja2V0OiBXZWJTb2NrZXQsXG4gICAgcHJpdmF0ZSByZWFkb25seSB0cmFuc3BvcnQ6IFdlYlNvY2tldFRyYW5zcG9ydFxuICApIHtcbiAgICB0aGlzLmlkID0gY3JlYXRlUmVxdWVzdElkKClcbiAgICB0aGlzLnVybCA9IG5ldyBVUkwoc29ja2V0LnVybClcbiAgICB0aGlzW2tFbWl0dGVyXSA9IG5ldyBFdmVudFRhcmdldCgpXG5cbiAgICAvLyBFbWl0IG91dGdvaW5nIGNsaWVudCBkYXRhIChcIndzLnNlbmQoKVwiKSBhcyBcIm1lc3NhZ2VcIlxuICAgIC8vIGV2ZW50cyBvbiB0aGUgXCJjbGllbnRcIiBjb25uZWN0aW9uLlxuICAgIHRoaXMudHJhbnNwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ291dGdvaW5nJywgKGV2ZW50KSA9PiB7XG4gICAgICBjb25zdCBtZXNzYWdlID0gYmluZEV2ZW50KFxuICAgICAgICB0aGlzLnNvY2tldCxcbiAgICAgICAgbmV3IENhbmNlbGFibGVNZXNzYWdlRXZlbnQoJ21lc3NhZ2UnLCB7XG4gICAgICAgICAgZGF0YTogZXZlbnQuZGF0YSxcbiAgICAgICAgICBvcmlnaW46IGV2ZW50Lm9yaWdpbixcbiAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgICB9KVxuICAgICAgKVxuXG4gICAgICB0aGlzW2tFbWl0dGVyXS5kaXNwYXRjaEV2ZW50KG1lc3NhZ2UpXG5cbiAgICAgIC8vIFRoaXMgaXMgYSBiaXQgc2lsbHkgYnV0IGZvcndhcmQgdGhlIGNhbmNlbGxhdGlvbiBzdGF0ZVxuICAgICAgLy8gb2YgdGhlIFwiY2xpZW50XCIgbWVzc2FnZSBldmVudCB0byB0aGUgXCJvdXRnb2luZ1wiIHRyYW5zcG9ydCBldmVudC5cbiAgICAgIC8vIFRoaXMgd2F5LCBvdGhlciBhZ2VucyAobGlrZSBcInNlcnZlclwiIGNvbm5lY3Rpb24pIGNhbiBrbm93XG4gICAgICAvLyB3aGV0aGVyIHRoZSBjbGllbnQgbGlzdGVuZXIgaGFzIHBlcnZlbnRlZCB0aGUgZGVmYXVsdC5cbiAgICAgIGlmIChtZXNzYWdlLmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKVxuICAgICAgfVxuICAgIH0pXG5cbiAgICAvKipcbiAgICAgKiBFbWl0IHRoZSBcImNsb3NlXCIgZXZlbnQgb24gdGhlIFwiY2xpZW50XCIgY29ubmVjdGlvblxuICAgICAqIHdoZW5ldmVyIHRoZSB1bmRlcmx5aW5nIHRyYW5zcG9ydCBpcyBjbG9zZWQuXG4gICAgICogQG5vdGUgXCJjbGllbnQuY2xvc2UoKVwiIGRvZXMgTk9UIGRpc3BhdGNoIHRoZSBcImNsb3NlXCJcbiAgICAgKiBldmVudCBvbiB0aGUgV2ViU29ja2V0IGJlY2F1c2UgaXQgdXNlcyBub24tY29uZmlndXJhYmxlXG4gICAgICogY2xvc2Ugc3RhdHVzIGNvZGUuIFRodXMsIHdlIGxpc3RlbiB0byB0aGUgdHJhbnNwb3J0XG4gICAgICogaW5zdGVhZCBvZiB0aGUgV2ViU29ja2V0J3MgXCJjbG9zZVwiIGV2ZW50LlxuICAgICAqL1xuICAgIHRoaXMudHJhbnNwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ2Nsb3NlJywgKGV2ZW50KSA9PiB7XG4gICAgICB0aGlzW2tFbWl0dGVyXS5kaXNwYXRjaEV2ZW50KFxuICAgICAgICBiaW5kRXZlbnQodGhpcy5zb2NrZXQsIG5ldyBDbG9zZUV2ZW50KCdjbG9zZScsIGV2ZW50KSlcbiAgICAgIClcbiAgICB9KVxuICB9XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgdGhlIG91dGdvaW5nIGV2ZW50cyBmcm9tIHRoZSBjb25uZWN0ZWQgV2ViU29ja2V0IGNsaWVudC5cbiAgICovXG4gIHB1YmxpYyBhZGRFdmVudExpc3RlbmVyPEV2ZW50VHlwZSBleHRlbmRzIGtleW9mIFdlYlNvY2tldENsaWVudEV2ZW50TWFwPihcbiAgICB0eXBlOiBFdmVudFR5cGUsXG4gICAgbGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8V2ViU29ja2V0Q2xpZW50RXZlbnRNYXBbRXZlbnRUeXBlXT4sXG4gICAgb3B0aW9ucz86IEFkZEV2ZW50TGlzdGVuZXJPcHRpb25zIHwgYm9vbGVhblxuICApOiB2b2lkIHtcbiAgICBpZiAoIVJlZmxlY3QuaGFzKGxpc3RlbmVyLCBrQm91bmRMaXN0ZW5lcikpIHtcbiAgICAgIGNvbnN0IGJvdW5kTGlzdGVuZXIgPSBsaXN0ZW5lci5iaW5kKHRoaXMuc29ja2V0KVxuXG4gICAgICAvLyBTdG9yZSB0aGUgYm91bmQgbGlzdGVuZXIgb24gdGhlIG9yaWdpbmFsIGxpc3RlbmVyXG4gICAgICAvLyBzbyB0aGUgZXhhY3QgYm91bmQgZnVuY3Rpb24gY2FuIGJlIGFjY2Vzc2VkIGluIFwicmVtb3ZlRXZlbnRMaXN0ZW5lcigpXCIuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobGlzdGVuZXIsIGtCb3VuZExpc3RlbmVyLCB7XG4gICAgICAgIHZhbHVlOiBib3VuZExpc3RlbmVyLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgICAgY29uZmlndXJhYmxlOiBmYWxzZSxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpc1trRW1pdHRlcl0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIHR5cGUsXG4gICAgICBSZWZsZWN0LmdldChsaXN0ZW5lciwga0JvdW5kTGlzdGVuZXIpIGFzIEV2ZW50TGlzdGVuZXIsXG4gICAgICBvcHRpb25zXG4gICAgKVxuICB9XG5cbiAgLyoqXG4gICAqIFJlbW92ZXMgdGhlIGxpc3RlbmVyIGZvciB0aGUgZ2l2ZW4gZXZlbnQuXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlRXZlbnRMaXN0ZW5lcjxFdmVudFR5cGUgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRDbGllbnRFdmVudE1hcD4oXG4gICAgZXZlbnQ6IEV2ZW50VHlwZSxcbiAgICBsaXN0ZW5lcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxXZWJTb2NrZXRDbGllbnRFdmVudE1hcFtFdmVudFR5cGVdPixcbiAgICBvcHRpb25zPzogRXZlbnRMaXN0ZW5lck9wdGlvbnMgfCBib29sZWFuXG4gICk6IHZvaWQge1xuICAgIHRoaXNba0VtaXR0ZXJdLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudCxcbiAgICAgIFJlZmxlY3QuZ2V0KGxpc3RlbmVyLCBrQm91bmRMaXN0ZW5lcikgYXMgRXZlbnRMaXN0ZW5lcixcbiAgICAgIG9wdGlvbnNcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogU2VuZCBkYXRhIHRvIHRoZSBjb25uZWN0ZWQgY2xpZW50LlxuICAgKi9cbiAgcHVibGljIHNlbmQoZGF0YTogV2ViU29ja2V0RGF0YSk6IHZvaWQge1xuICAgIHRoaXMudHJhbnNwb3J0LnNlbmQoZGF0YSlcbiAgfVxuXG4gIC8qKlxuICAgKiBDbG9zZSB0aGUgV2ViU29ja2V0IGNvbm5lY3Rpb24uXG4gICAqIEBwYXJhbSB7bnVtYmVyfSBjb2RlIEEgc3RhdHVzIGNvZGUgKHNlZSBodHRwczovL3d3dy5yZmMtZWRpdG9yLm9yZy9yZmMvcmZjNjQ1NSNzZWN0aW9uLTcuNC4xKS5cbiAgICogQHBhcmFtIHtzdHJpbmd9IHJlYXNvbiBBIGN1c3RvbSBjb25uZWN0aW9uIGNsb3NlIHJlYXNvbi5cbiAgICovXG4gIHB1YmxpYyBjbG9zZShjb2RlPzogbnVtYmVyLCByZWFzb24/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICB0aGlzLnRyYW5zcG9ydC5jbG9zZShjb2RlLCByZWFzb24pXG4gIH1cbn1cbiIsImltcG9ydCB7IGludmFyaWFudCB9IGZyb20gJ291dHZhcmlhbnQnXG5pbXBvcnQge1xuICBrQ2xvc2UsXG4gIFdlYlNvY2tldEV2ZW50TGlzdGVuZXIsXG4gIFdlYlNvY2tldE92ZXJyaWRlLFxufSBmcm9tICcuL1dlYlNvY2tldE92ZXJyaWRlJ1xuaW1wb3J0IHR5cGUgeyBXZWJTb2NrZXREYXRhIH0gZnJvbSAnLi9XZWJTb2NrZXRUcmFuc3BvcnQnXG5pbXBvcnQgdHlwZSB7IFdlYlNvY2tldENsYXNzVHJhbnNwb3J0IH0gZnJvbSAnLi9XZWJTb2NrZXRDbGFzc1RyYW5zcG9ydCdcbmltcG9ydCB7IGJpbmRFdmVudCB9IGZyb20gJy4vdXRpbHMvYmluZEV2ZW50J1xuaW1wb3J0IHtcbiAgQ2FuY2VsYWJsZU1lc3NhZ2VFdmVudCxcbiAgQ2FuY2VsYWJsZUNsb3NlRXZlbnQsXG4gIENsb3NlRXZlbnQsXG59IGZyb20gJy4vdXRpbHMvZXZlbnRzJ1xuXG5jb25zdCBrRW1pdHRlciA9IFN5bWJvbCgna0VtaXR0ZXInKVxuY29uc3Qga0JvdW5kTGlzdGVuZXIgPSBTeW1ib2woJ2tCb3VuZExpc3RlbmVyJylcbmNvbnN0IGtTZW5kID0gU3ltYm9sKCdrU2VuZCcpXG5cbmV4cG9ydCBpbnRlcmZhY2UgV2ViU29ja2V0U2VydmVyRXZlbnRNYXAge1xuICBvcGVuOiBFdmVudFxuICBtZXNzYWdlOiBNZXNzYWdlRXZlbnQ8V2ViU29ja2V0RGF0YT5cbiAgZXJyb3I6IEV2ZW50XG4gIGNsb3NlOiBDbG9zZUV2ZW50XG59XG5cbmV4cG9ydCBhYnN0cmFjdCBjbGFzcyBXZWJTb2NrZXRTZXJ2ZXJDb25uZWN0aW9uUHJvdG9jb2wge1xuICBwdWJsaWMgYWJzdHJhY3QgY29ubmVjdCgpOiB2b2lkXG4gIHB1YmxpYyBhYnN0cmFjdCBzZW5kKGRhdGE6IFdlYlNvY2tldERhdGEpOiB2b2lkXG4gIHB1YmxpYyBhYnN0cmFjdCBjbG9zZSgpOiB2b2lkXG5cbiAgcHVibGljIGFic3RyYWN0IGFkZEV2ZW50TGlzdGVuZXI8XG4gICAgRXZlbnRUeXBlIGV4dGVuZHMga2V5b2YgV2ViU29ja2V0U2VydmVyRXZlbnRNYXBcbiAgPihcbiAgICBldmVudDogRXZlbnRUeXBlLFxuICAgIGxpc3RlbmVyOiBXZWJTb2NrZXRFdmVudExpc3RlbmVyPFdlYlNvY2tldFNlcnZlckV2ZW50TWFwW0V2ZW50VHlwZV0+LFxuICAgIG9wdGlvbnM/OiBBZGRFdmVudExpc3RlbmVyT3B0aW9ucyB8IGJvb2xlYW5cbiAgKTogdm9pZFxuXG4gIHB1YmxpYyBhYnN0cmFjdCByZW1vdmVFdmVudExpc3RlbmVyPFxuICAgIEV2ZW50VHlwZSBleHRlbmRzIGtleW9mIFdlYlNvY2tldFNlcnZlckV2ZW50TWFwXG4gID4oXG4gICAgZXZlbnQ6IEV2ZW50VHlwZSxcbiAgICBsaXN0ZW5lcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxXZWJTb2NrZXRTZXJ2ZXJFdmVudE1hcFtFdmVudFR5cGVdPixcbiAgICBvcHRpb25zPzogRXZlbnRMaXN0ZW5lck9wdGlvbnMgfCBib29sZWFuXG4gICk6IHZvaWRcbn1cblxuLyoqXG4gKiBUaGUgV2ViU29ja2V0IHNlcnZlciBpbnN0YW5jZSByZXByZXNlbnRzIHRoZSBhY3R1YWwgcHJvZHVjdGlvblxuICogV2ViU29ja2V0IHNlcnZlciBjb25uZWN0aW9uLiBJdCdzIGlkbGUgYnkgZGVmYXVsdCBidXQgeW91IGNhblxuICogZXN0YWJsaXNoIGl0IGJ5IGNhbGxpbmcgYHNlcnZlci5jb25uZWN0KClgLlxuICovXG5leHBvcnQgY2xhc3MgV2ViU29ja2V0U2VydmVyQ29ubmVjdGlvblxuICBpbXBsZW1lbnRzIFdlYlNvY2tldFNlcnZlckNvbm5lY3Rpb25Qcm90b2NvbFxue1xuICAvKipcbiAgICogQSBXZWJTb2NrZXQgaW5zdGFuY2UgY29ubmVjdGVkIHRvIHRoZSBvcmlnaW5hbCBzZXJ2ZXIuXG4gICAqL1xuICBwcml2YXRlIHJlYWxXZWJTb2NrZXQ/OiBXZWJTb2NrZXRcbiAgcHJpdmF0ZSBtb2NrQ2xvc2VDb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXJcbiAgcHJpdmF0ZSByZWFsQ2xvc2VDb250cm9sbGVyOiBBYm9ydENvbnRyb2xsZXJcbiAgcHJpdmF0ZSBba0VtaXR0ZXJdOiBFdmVudFRhcmdldFxuXG4gIGNvbnN0cnVjdG9yKFxuICAgIHByaXZhdGUgcmVhZG9ubHkgY2xpZW50OiBXZWJTb2NrZXRPdmVycmlkZSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHRyYW5zcG9ydDogV2ViU29ja2V0Q2xhc3NUcmFuc3BvcnQsXG4gICAgcHJpdmF0ZSByZWFkb25seSBjcmVhdGVDb25uZWN0aW9uOiAoKSA9PiBXZWJTb2NrZXRcbiAgKSB7XG4gICAgdGhpc1trRW1pdHRlcl0gPSBuZXcgRXZlbnRUYXJnZXQoKVxuICAgIHRoaXMubW9ja0Nsb3NlQ29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuICAgIHRoaXMucmVhbENsb3NlQ29udHJvbGxlciA9IG5ldyBBYm9ydENvbnRyb2xsZXIoKVxuXG4gICAgLy8gQXV0b21hdGljYWxseSBmb3J3YXJkIG91dGdvaW5nIGNsaWVudCBldmVudHNcbiAgICAvLyB0byB0aGUgYWN0dWFsIHNlcnZlciB1bmxlc3MgdGhlIG91dGdvaW5nIG1lc3NhZ2UgZXZlbnRcbiAgICAvLyBoYXMgYmVlbiBwcmV2ZW50ZWQuIFRoZSBcIm91dGdvaW5nXCIgdHJhbnNwb3J0IGV2ZW50IGl0XG4gICAgLy8gZGlzcGF0Y2hlZCBieSB0aGUgXCJjbGllbnRcIiBjb25uZWN0aW9uLlxuICAgIHRoaXMudHJhbnNwb3J0LmFkZEV2ZW50TGlzdGVuZXIoJ291dGdvaW5nJywgKGV2ZW50KSA9PiB7XG4gICAgICAvLyBJZ25vcmUgY2xpZW50IG1lc3NhZ2VzIGlmIHRoZSBzZXJ2ZXIgY29ubmVjdGlvblxuICAgICAgLy8gaGFzbid0IGJlZW4gZXN0YWJsaXNoZWQgeWV0LiBOb3doZXJlIHRvIGZvcndhcmQuXG4gICAgICBpZiAodHlwZW9mIHRoaXMucmVhbFdlYlNvY2tldCA9PT0gJ3VuZGVmaW5lZCcpIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIC8vIEV2ZXJ5IG91dGdvaW5nIGNsaWVudCBtZXNzYWdlIGNhbiBwcmV2ZW50IHRoaXMgZm9yd2FyZGluZ1xuICAgICAgLy8gYnkgcHJldmVudGluZyB0aGUgZGVmYXVsdCBvZiB0aGUgb3V0Z29pbmcgbWVzc2FnZSBldmVudC5cbiAgICAgIC8vIFRoaXMgbGlzdGVuZXIgd2lsbCBiZSBhZGRlZCBiZWZvcmUgdXNlci1kZWZpbmVkIGxpc3RlbmVycyxcbiAgICAgIC8vIHNvIGV4ZWN1dGUgdGhlIGxvZ2ljIG9uIHRoZSBuZXh0IHRpY2suXG4gICAgICBxdWV1ZU1pY3JvdGFzaygoKSA9PiB7XG4gICAgICAgIGlmICghZXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBub3RlIFVzZSB0aGUgaW50ZXJuYWwgc2VuZCBtZWNoYW5pc20gc28gY29uc3VtZXJzIGNhbiB0ZWxsXG4gICAgICAgICAgICogYXBhcnQgZGlyZWN0IHVzZXIgY2FsbHMgdG8gYHNlcnZlci5zZW5kKClgIGFuZCBpbnRlcm5hbCBjYWxscy5cbiAgICAgICAgICAgKiBFLmcuIE1TVyBoYXMgdG8gaWdub3JlIHRoaXMgaW50ZXJuYWwgY2FsbCB0byBsb2cgb3V0IG1lc3NhZ2VzIGNvcnJlY3RseS5cbiAgICAgICAgICAgKi9cbiAgICAgICAgICB0aGlzW2tTZW5kXShldmVudC5kYXRhKVxuICAgICAgICB9XG4gICAgICB9KVxuICAgIH0pXG5cbiAgICB0aGlzLnRyYW5zcG9ydC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ2luY29taW5nJyxcbiAgICAgIHRoaXMuaGFuZGxlSW5jb21pbmdNZXNzYWdlLmJpbmQodGhpcylcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogVGhlIGBXZWJTb2NrZXRgIGluc3RhbmNlIGNvbm5lY3RlZCB0byB0aGUgb3JpZ2luYWwgc2VydmVyLlxuICAgKiBBY2Nlc3NpbmcgdGhpcyBiZWZvcmUgY2FsbGluZyBgc2VydmVyLmNvbm5lY3QoKWAgd2lsbCB0aHJvdy5cbiAgICovXG4gIHB1YmxpYyBnZXQgc29ja2V0KCk6IFdlYlNvY2tldCB7XG4gICAgaW52YXJpYW50KFxuICAgICAgdGhpcy5yZWFsV2ViU29ja2V0LFxuICAgICAgJ0Nhbm5vdCBhY2Nlc3MgXCJzb2NrZXRcIiBvbiB0aGUgb3JpZ2luYWwgV2ViU29ja2V0IHNlcnZlciBvYmplY3Q6IHRoZSBjb25uZWN0aW9uIGlzIG5vdCBvcGVuLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIGBzZXJ2ZXIuY29ubmVjdCgpYD8nXG4gICAgKVxuXG4gICAgcmV0dXJuIHRoaXMucmVhbFdlYlNvY2tldFxuICB9XG5cbiAgLyoqXG4gICAqIE9wZW4gY29ubmVjdGlvbiB0byB0aGUgb3JpZ2luYWwgV2ViU29ja2V0IHNlcnZlci5cbiAgICovXG4gIHB1YmxpYyBjb25uZWN0KCk6IHZvaWQge1xuICAgIGludmFyaWFudChcbiAgICAgICF0aGlzLnJlYWxXZWJTb2NrZXQgfHwgdGhpcy5yZWFsV2ViU29ja2V0LnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5PUEVOLFxuICAgICAgJ0ZhaWxlZCB0byBjYWxsIFwiY29ubmVjdCgpXCIgb24gdGhlIG9yaWdpbmFsIFdlYlNvY2tldCBpbnN0YW5jZTogdGhlIGNvbm5lY3Rpb24gYWxyZWFkeSBvcGVuJ1xuICAgIClcblxuICAgIGNvbnN0IHJlYWxXZWJTb2NrZXQgPSB0aGlzLmNyZWF0ZUNvbm5lY3Rpb24oKVxuXG4gICAgLy8gSW5oZXJpdCB0aGUgYmluYXJ5IHR5cGUgZnJvbSB0aGUgbW9jayBXZWJTb2NrZXQgY2xpZW50LlxuICAgIHJlYWxXZWJTb2NrZXQuYmluYXJ5VHlwZSA9IHRoaXMuY2xpZW50LmJpbmFyeVR5cGVcblxuICAgIC8vIEFsbG93IHRoZSBpbnRlcmNlcHRvciB0byBsaXN0ZW4gdG8gd2hlbiB0aGUgc2VydmVyIGNvbm5lY3Rpb25cbiAgICAvLyBoYXMgYmVlbiBlc3RhYmxpc2hlZC4gVGhpcyBpc24ndCBuZWNlc3NhcnkgdG8gb3BlcmF0ZSB3aXRoIHRoZSBjb25uZWN0aW9uXG4gICAgLy8gYnV0IG1heSBiZSBiZW5lZmljaWFsIGluIHNvbWUgY2FzZXMgKGxpa2UgY29uZGl0aW9uYWxseSBhZGRpbmcgbG9nZ2luZykuXG4gICAgcmVhbFdlYlNvY2tldC5hZGRFdmVudExpc3RlbmVyKFxuICAgICAgJ29wZW4nLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXNba0VtaXR0ZXJdLmRpc3BhdGNoRXZlbnQoXG4gICAgICAgICAgYmluZEV2ZW50KHRoaXMucmVhbFdlYlNvY2tldCEsIG5ldyBFdmVudCgnb3BlbicsIGV2ZW50KSlcbiAgICAgICAgKVxuICAgICAgfSxcbiAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgKVxuXG4gICAgcmVhbFdlYlNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgKGV2ZW50KSA9PiB7XG4gICAgICAvLyBEaXNwYXRjaCB0aGUgXCJpbmNvbWluZ1wiIHRyYW5zcG9ydCBldmVudCBpbnN0ZWFkIG9mXG4gICAgICAvLyBpbnZva2luZyB0aGUgaW50ZXJuYWwgaGFuZGxlciBkaXJlY3RseS4gVGhpcyB3YXksXG4gICAgICAvLyBhbnlvbmUgY2FuIGxpc3RlbiB0byB0aGUgXCJpbmNvbWluZ1wiIGV2ZW50IGJ1dCB0aGlzXG4gICAgICAvLyBjbGFzcyBpcyB0aGUgb25lIHJlc3VsdGluZyBpbiBpdC5cbiAgICAgIHRoaXMudHJhbnNwb3J0LmRpc3BhdGNoRXZlbnQoXG4gICAgICAgIGJpbmRFdmVudChcbiAgICAgICAgICB0aGlzLnJlYWxXZWJTb2NrZXQhLFxuICAgICAgICAgIG5ldyBNZXNzYWdlRXZlbnQoJ2luY29taW5nJywge1xuICAgICAgICAgICAgZGF0YTogZXZlbnQuZGF0YSxcbiAgICAgICAgICAgIG9yaWdpbjogZXZlbnQub3JpZ2luLFxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgICB9KVxuXG4gICAgLy8gQ2xvc2UgdGhlIG9yaWdpbmFsIGNvbm5lY3Rpb24gd2hlbiB0aGUgbW9jayBjbGllbnQgY2xvc2VzLlxuICAgIC8vIEUuZy4gXCJjbGllbnQuY2xvc2UoKVwiIHdhcyBjYWxsZWQuIFRoaXMgaXMgbmV2ZXIgZm9yd2FyZGVkIGFueXdoZXJlLlxuICAgIHRoaXMuY2xpZW50LmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICAnY2xvc2UnLFxuICAgICAgKGV2ZW50KSA9PiB7XG4gICAgICAgIHRoaXMuaGFuZGxlTW9ja0Nsb3NlKGV2ZW50KVxuICAgICAgfSxcbiAgICAgIHtcbiAgICAgICAgc2lnbmFsOiB0aGlzLm1vY2tDbG9zZUNvbnRyb2xsZXIuc2lnbmFsLFxuICAgICAgfVxuICAgIClcblxuICAgIC8vIEZvcndhcmQgdGhlIFwiY2xvc2VcIiBldmVudCB0byBsZXQgdGhlIGludGVyY2VwdG9yIGhhbmRsZVxuICAgIC8vIGNsb3N1cmVzIGluaXRpYXRlZCBieSB0aGUgb3JpZ2luYWwgc2VydmVyLlxuICAgIHJlYWxXZWJTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICdjbG9zZScsXG4gICAgICAoZXZlbnQpID0+IHtcbiAgICAgICAgdGhpcy5oYW5kbGVSZWFsQ2xvc2UoZXZlbnQpXG4gICAgICB9LFxuICAgICAge1xuICAgICAgICBzaWduYWw6IHRoaXMucmVhbENsb3NlQ29udHJvbGxlci5zaWduYWwsXG4gICAgICB9XG4gICAgKVxuXG4gICAgcmVhbFdlYlNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdlcnJvcicsICgpID0+IHtcbiAgICAgIGNvbnN0IGVycm9yRXZlbnQgPSBiaW5kRXZlbnQoXG4gICAgICAgIHJlYWxXZWJTb2NrZXQsXG4gICAgICAgIG5ldyBFdmVudCgnZXJyb3InLCB7IGNhbmNlbGFibGU6IHRydWUgfSlcbiAgICAgIClcblxuICAgICAgLy8gRW1pdCB0aGUgXCJlcnJvclwiIGV2ZW50IG9uIHRoZSBgc2VydmVyYCBjb25uZWN0aW9uXG4gICAgICAvLyB0byBsZXQgdGhlIGludGVyY2VwdG9yIHJlYWN0IHRvIG9yaWdpbmFsIHNlcnZlciBlcnJvcnMuXG4gICAgICB0aGlzW2tFbWl0dGVyXS5kaXNwYXRjaEV2ZW50KGVycm9yRXZlbnQpXG5cbiAgICAgIC8vIElmIHRoZSBlcnJvciBldmVudCBmcm9tIHRoZSBvcmlnaW5hbCBzZXJ2ZXIgaGFzbid0IGJlZW4gcHJldmVudGVkLFxuICAgICAgLy8gZm9yd2FyZCBpdCB0byB0aGUgdW5kZXJseWluZyBjbGllbnQuXG4gICAgICBpZiAoIWVycm9yRXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgICB0aGlzLmNsaWVudC5kaXNwYXRjaEV2ZW50KGJpbmRFdmVudCh0aGlzLmNsaWVudCwgbmV3IEV2ZW50KCdlcnJvcicpKSlcbiAgICAgIH1cbiAgICB9KVxuXG4gICAgdGhpcy5yZWFsV2ViU29ja2V0ID0gcmVhbFdlYlNvY2tldFxuICB9XG5cbiAgLyoqXG4gICAqIExpc3RlbiBmb3IgdGhlIGluY29taW5nIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBXZWJTb2NrZXQgc2VydmVyLlxuICAgKi9cbiAgcHVibGljIGFkZEV2ZW50TGlzdGVuZXI8RXZlbnRUeXBlIGV4dGVuZHMga2V5b2YgV2ViU29ja2V0U2VydmVyRXZlbnRNYXA+KFxuICAgIGV2ZW50OiBFdmVudFR5cGUsXG4gICAgbGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8V2ViU29ja2V0U2VydmVyRXZlbnRNYXBbRXZlbnRUeXBlXT4sXG4gICAgb3B0aW9ucz86IEFkZEV2ZW50TGlzdGVuZXJPcHRpb25zIHwgYm9vbGVhblxuICApOiB2b2lkIHtcbiAgICBpZiAoIVJlZmxlY3QuaGFzKGxpc3RlbmVyLCBrQm91bmRMaXN0ZW5lcikpIHtcbiAgICAgIGNvbnN0IGJvdW5kTGlzdGVuZXIgPSBsaXN0ZW5lci5iaW5kKHRoaXMuY2xpZW50KVxuXG4gICAgICAvLyBTdG9yZSB0aGUgYm91bmQgbGlzdGVuZXIgb24gdGhlIG9yaWdpbmFsIGxpc3RlbmVyXG4gICAgICAvLyBzbyB0aGUgZXhhY3QgYm91bmQgZnVuY3Rpb24gY2FuIGJlIGFjY2Vzc2VkIGluIFwicmVtb3ZlRXZlbnRMaXN0ZW5lcigpXCIuXG4gICAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkobGlzdGVuZXIsIGtCb3VuZExpc3RlbmVyLCB7XG4gICAgICAgIHZhbHVlOiBib3VuZExpc3RlbmVyLFxuICAgICAgICBlbnVtZXJhYmxlOiBmYWxzZSxcbiAgICAgIH0pXG4gICAgfVxuXG4gICAgdGhpc1trRW1pdHRlcl0uYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgIGV2ZW50LFxuICAgICAgUmVmbGVjdC5nZXQobGlzdGVuZXIsIGtCb3VuZExpc3RlbmVyKSBhcyBFdmVudExpc3RlbmVyLFxuICAgICAgb3B0aW9uc1xuICAgIClcbiAgfVxuXG4gIC8qKlxuICAgKiBSZW1vdmUgdGhlIGxpc3RlbmVyIGZvciB0aGUgZ2l2ZW4gZXZlbnQuXG4gICAqL1xuICBwdWJsaWMgcmVtb3ZlRXZlbnRMaXN0ZW5lcjxFdmVudFR5cGUgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRTZXJ2ZXJFdmVudE1hcD4oXG4gICAgZXZlbnQ6IEV2ZW50VHlwZSxcbiAgICBsaXN0ZW5lcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxXZWJTb2NrZXRTZXJ2ZXJFdmVudE1hcFtFdmVudFR5cGVdPixcbiAgICBvcHRpb25zPzogRXZlbnRMaXN0ZW5lck9wdGlvbnMgfCBib29sZWFuXG4gICk6IHZvaWQge1xuICAgIHRoaXNba0VtaXR0ZXJdLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICBldmVudCxcbiAgICAgIFJlZmxlY3QuZ2V0KGxpc3RlbmVyLCBrQm91bmRMaXN0ZW5lcikgYXMgRXZlbnRMaXN0ZW5lcixcbiAgICAgIG9wdGlvbnNcbiAgICApXG4gIH1cblxuICAvKipcbiAgICogU2VuZCBkYXRhIHRvIHRoZSBvcmlnaW5hbCBXZWJTb2NrZXQgc2VydmVyLlxuICAgKiBAZXhhbXBsZVxuICAgKiBzZXJ2ZXIuc2VuZCgnaGVsbG8nKVxuICAgKiBzZXJ2ZXIuc2VuZChuZXcgQmxvYihbJ2hlbGxvJ10pKVxuICAgKiBzZXJ2ZXIuc2VuZChuZXcgVGV4dEVuY29kZXIoKS5lbmNvZGUoJ2hlbGxvJykpXG4gICAqL1xuICBwdWJsaWMgc2VuZChkYXRhOiBXZWJTb2NrZXREYXRhKTogdm9pZCB7XG4gICAgdGhpc1trU2VuZF0oZGF0YSlcbiAgfVxuXG4gIHByaXZhdGUgW2tTZW5kXShkYXRhOiBXZWJTb2NrZXREYXRhKTogdm9pZCB7XG4gICAgY29uc3QgeyByZWFsV2ViU29ja2V0IH0gPSB0aGlzXG5cbiAgICBpbnZhcmlhbnQoXG4gICAgICByZWFsV2ViU29ja2V0LFxuICAgICAgJ0ZhaWxlZCB0byBjYWxsIFwic2VydmVyLnNlbmQoKVwiIGZvciBcIiVzXCI6IHRoZSBjb25uZWN0aW9uIGlzIG5vdCBvcGVuLiBEaWQgeW91IGZvcmdldCB0byBjYWxsIFwic2VydmVyLmNvbm5lY3QoKVwiPycsXG4gICAgICB0aGlzLmNsaWVudC51cmxcbiAgICApXG5cbiAgICAvLyBTaWxlbnRseSBpZ25vcmUgd3JpdGVzIG9uIHRoZSBjbG9zZWQgb3JpZ2luYWwgV2ViU29ja2V0LlxuICAgIGlmIChcbiAgICAgIHJlYWxXZWJTb2NrZXQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNMT1NJTkcgfHxcbiAgICAgIHJlYWxXZWJTb2NrZXQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNMT1NFRFxuICAgICkge1xuICAgICAgcmV0dXJuXG4gICAgfVxuXG4gICAgLy8gRGVsZWdhdGUgdGhlIHNlbmQgdG8gd2hlbiB0aGUgb3JpZ2luYWwgY29ubmVjdGlvbiBpcyBvcGVuLlxuICAgIC8vIFVubGlrZSB0aGUgbW9jaywgY29ubmVjdGluZyB0byB0aGUgb3JpZ2luYWwgc2VydmVyIG1heSB0YWtlIHRpbWVcbiAgICAvLyBzbyB3ZSBjYW5ub3QgY2FsbCB0aGlzIG9uIHRoZSBuZXh0IHRpY2suXG4gICAgaWYgKHJlYWxXZWJTb2NrZXQucmVhZHlTdGF0ZSA9PT0gV2ViU29ja2V0LkNPTk5FQ1RJTkcpIHtcbiAgICAgIHJlYWxXZWJTb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgJ29wZW4nLFxuICAgICAgICAoKSA9PiB7XG4gICAgICAgICAgcmVhbFdlYlNvY2tldC5zZW5kKGRhdGEpXG4gICAgICAgIH0sXG4gICAgICAgIHsgb25jZTogdHJ1ZSB9XG4gICAgICApXG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBTZW5kIHRoZSBkYXRhIHRvIHRoZSBvcmlnaW5hbCBXZWJTb2NrZXQgc2VydmVyLlxuICAgIHJlYWxXZWJTb2NrZXQuc2VuZChkYXRhKVxuICB9XG5cbiAgLyoqXG4gICAqIENsb3NlIHRoZSBhY3R1YWwgc2VydmVyIGNvbm5lY3Rpb24uXG4gICAqL1xuICBwdWJsaWMgY2xvc2UoKTogdm9pZCB7XG4gICAgY29uc3QgeyByZWFsV2ViU29ja2V0IH0gPSB0aGlzXG5cbiAgICBpbnZhcmlhbnQoXG4gICAgICByZWFsV2ViU29ja2V0LFxuICAgICAgJ0ZhaWxlZCB0byBjbG9zZSBzZXJ2ZXIgY29ubmVjdGlvbiBmb3IgXCIlc1wiOiB0aGUgY29ubmVjdGlvbiBpcyBub3Qgb3Blbi4gRGlkIHlvdSBmb3JnZXQgdG8gY2FsbCBcInNlcnZlci5jb25uZWN0KClcIj8nLFxuICAgICAgdGhpcy5jbGllbnQudXJsXG4gICAgKVxuXG4gICAgLy8gUmVtb3ZlIHRoZSBcImNsb3NlXCIgZXZlbnQgbGlzdGVuZXIgZnJvbSB0aGUgc2VydmVyXG4gICAgLy8gc28gaXQgZG9lc24ndCBjbG9zZSB0aGUgdW5kZXJseWluZyBXZWJTb2NrZXQgY2xpZW50XG4gICAgLy8gd2hlbiB5b3UgY2FsbCBcInNlcnZlci5jbG9zZSgpXCIuIFRoaXMgYWxzbyBwcmV2ZW50cyB0aGVcbiAgICAvLyBgY2xvc2VgIGV2ZW50IG9uIHRoZSBgc2VydmVyYCBjb25uZWN0aW9uIGZyb20gYmVpbmcgZGlzcGF0Y2hlZCB0d2ljZS5cbiAgICB0aGlzLnJlYWxDbG9zZUNvbnRyb2xsZXIuYWJvcnQoKVxuXG4gICAgaWYgKFxuICAgICAgcmVhbFdlYlNvY2tldC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0lORyB8fFxuICAgICAgcmVhbFdlYlNvY2tldC5yZWFkeVN0YXRlID09PSBXZWJTb2NrZXQuQ0xPU0VEXG4gICAgKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBDbG9zZSB0aGUgYWN0dWFsIGNsaWVudCBjb25uZWN0aW9uLlxuICAgIHJlYWxXZWJTb2NrZXQuY2xvc2UoKVxuXG4gICAgLy8gRGlzcGF0Y2ggdGhlIFwiY2xvc2VcIiBldmVudCBvbiB0aGUgYHNlcnZlcmAgY29ubmVjdGlvbi5cbiAgICBxdWV1ZU1pY3JvdGFzaygoKSA9PiB7XG4gICAgICB0aGlzW2tFbWl0dGVyXS5kaXNwYXRjaEV2ZW50KFxuICAgICAgICBiaW5kRXZlbnQoXG4gICAgICAgICAgdGhpcy5yZWFsV2ViU29ja2V0LFxuICAgICAgICAgIG5ldyBDYW5jZWxhYmxlQ2xvc2VFdmVudCgnY2xvc2UnLCB7XG4gICAgICAgICAgICAvKipcbiAgICAgICAgICAgICAqIEBub3RlIGBzZXJ2ZXIuY2xvc2UoKWAgaW4gdGhlIGludGVyY2VwdG9yXG4gICAgICAgICAgICAgKiBhbHdheXMgcmVzdWx0cyBpbiBjbGVhbiBjbG9zdXJlcy5cbiAgICAgICAgICAgICAqL1xuICAgICAgICAgICAgY29kZTogMTAwMCxcbiAgICAgICAgICAgIGNhbmNlbGFibGU6IHRydWUsXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuICAgIH0pXG4gIH1cblxuICBwcml2YXRlIGhhbmRsZUluY29taW5nTWVzc2FnZShldmVudDogTWVzc2FnZUV2ZW50PFdlYlNvY2tldERhdGE+KTogdm9pZCB7XG4gICAgLy8gQ2xvbmUgdGhlIGV2ZW50IHRvIGRpc3BhdGNoIGl0IG9uIHRoaXMgY2xhc3NcbiAgICAvLyBvbmNlIGFnYWluIGFuZCBwcmV2ZW50IHRoZSBcImFscmVhZHkgYmVpbmcgZGlzcGF0Y2hlZFwiXG4gICAgLy8gZXhjZXB0aW9uLiBDbG9uZSBpdCBoZXJlIHNvIHdlIGNhbiBvYnNlcnZlIHRoaXMgZXZlbnRcbiAgICAvLyBiZWluZyBwcmV2ZW50ZWQgaW4gdGhlIFwic2VydmVyLm9uKClcIiBsaXN0ZW5lcnMuXG4gICAgY29uc3QgbWVzc2FnZUV2ZW50ID0gYmluZEV2ZW50KFxuICAgICAgZXZlbnQudGFyZ2V0LFxuICAgICAgbmV3IENhbmNlbGFibGVNZXNzYWdlRXZlbnQoJ21lc3NhZ2UnLCB7XG4gICAgICAgIGRhdGE6IGV2ZW50LmRhdGEsXG4gICAgICAgIG9yaWdpbjogZXZlbnQub3JpZ2luLFxuICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgfSlcbiAgICApXG5cbiAgICAvKipcbiAgICAgKiBAbm90ZSBFbWl0IFwibWVzc2FnZVwiIGV2ZW50IG9uIHRoZSBzZXJ2ZXIgY29ubmVjdGlvblxuICAgICAqIGluc3RhbmNlIHRvIGxldCB0aGUgaW50ZXJjZXB0b3Iga25vdyBhYm91dCB0aGVzZVxuICAgICAqIGluY29taW5nIGV2ZW50cyBmcm9tIHRoZSBvcmlnaW5hbCBzZXJ2ZXIuIEluIHRoYXQgbGlzdGVuZXIsXG4gICAgICogdGhlIGludGVyY2VwdG9yIGNhbiBtb2RpZnkgb3Igc2tpcCB0aGUgZXZlbnQgZm9yd2FyZGluZ1xuICAgICAqIHRvIHRoZSBtb2NrIFdlYlNvY2tldCBpbnN0YW5jZS5cbiAgICAgKi9cbiAgICB0aGlzW2tFbWl0dGVyXS5kaXNwYXRjaEV2ZW50KG1lc3NhZ2VFdmVudClcblxuICAgIC8qKlxuICAgICAqIEBub3RlIEZvcndhcmQgdGhlIGluY29taW5nIHNlcnZlciBldmVudHMgdG8gdGhlIGNsaWVudC5cbiAgICAgKiBQcmV2ZW50aW5nIHRoZSBkZWZhdWx0IG9uIHRoZSBtZXNzYWdlIGV2ZW50IHN0b3BzIHRoaXMuXG4gICAgICovXG4gICAgaWYgKCFtZXNzYWdlRXZlbnQuZGVmYXVsdFByZXZlbnRlZCkge1xuICAgICAgdGhpcy5jbGllbnQuZGlzcGF0Y2hFdmVudChcbiAgICAgICAgYmluZEV2ZW50KFxuICAgICAgICAgIC8qKlxuICAgICAgICAgICAqIEBub3RlIEJpbmQgdGhlIGZvcndhcmRlZCBvcmlnaW5hbCBzZXJ2ZXIgZXZlbnRzXG4gICAgICAgICAgICogdG8gdGhlIG1vY2sgV2ViU29ja2V0IGluc3RhbmNlIHNvIGl0IHdvdWxkXG4gICAgICAgICAgICogZGlzcGF0Y2ggdGhlbSBzdHJhaWdodCBhd2F5LlxuICAgICAgICAgICAqL1xuICAgICAgICAgIHRoaXMuY2xpZW50LFxuICAgICAgICAgIC8vIENsb25lIHRoZSBtZXNzYWdlIGV2ZW50IGFnYWluIHRvIHByZXZlbnRcbiAgICAgICAgICAvLyB0aGUgXCJhbHJlYWR5IGJlaW5nIGRpc3BhdGNoZWRcIiBleGNlcHRpb24uXG4gICAgICAgICAgbmV3IE1lc3NhZ2VFdmVudCgnbWVzc2FnZScsIHtcbiAgICAgICAgICAgIGRhdGE6IGV2ZW50LmRhdGEsXG4gICAgICAgICAgICBvcmlnaW46IGV2ZW50Lm9yaWdpbixcbiAgICAgICAgICB9KVxuICAgICAgICApXG4gICAgICApXG4gICAgfVxuICB9XG5cbiAgcHJpdmF0ZSBoYW5kbGVNb2NrQ2xvc2UoX2V2ZW50OiBFdmVudCk6IHZvaWQge1xuICAgIC8vIENsb3NlIHRoZSBvcmlnaW5hbCBjb25uZWN0aW9uIGlmIHRoZSBtb2NrIGNsaWVudCBjbG9zZXMuXG4gICAgaWYgKHRoaXMucmVhbFdlYlNvY2tldCkge1xuICAgICAgdGhpcy5yZWFsV2ViU29ja2V0LmNsb3NlKClcbiAgICB9XG4gIH1cblxuICBwcml2YXRlIGhhbmRsZVJlYWxDbG9zZShldmVudDogQ2xvc2VFdmVudCk6IHZvaWQge1xuICAgIC8vIEZvciBjbG9zdXJlcyBvcmlnaW5hdGluZyBmcm9tIHRoZSBvcmlnaW5hbCBzZXJ2ZXIsXG4gICAgLy8gcmVtb3ZlIHRoZSBcImNsb3NlXCIgbGlzdGVuZXIgZnJvbSB0aGUgbW9jayBjbGllbnQuXG4gICAgLy8gb3JpZ2luYWwgY2xvc2UgLT4gKD8pIGNsaWVudFtrQ2xvc2VdKCkgLS1YLS0+IFwiY2xvc2VcIiAoYWdhaW4pLlxuICAgIHRoaXMubW9ja0Nsb3NlQ29udHJvbGxlci5hYm9ydCgpXG5cbiAgICBjb25zdCBjbG9zZUV2ZW50ID0gYmluZEV2ZW50KFxuICAgICAgdGhpcy5yZWFsV2ViU29ja2V0LFxuICAgICAgbmV3IENhbmNlbGFibGVDbG9zZUV2ZW50KCdjbG9zZScsIHtcbiAgICAgICAgY29kZTogZXZlbnQuY29kZSxcbiAgICAgICAgcmVhc29uOiBldmVudC5yZWFzb24sXG4gICAgICAgIHdhc0NsZWFuOiBldmVudC53YXNDbGVhbixcbiAgICAgICAgY2FuY2VsYWJsZTogdHJ1ZSxcbiAgICAgIH0pXG4gICAgKVxuXG4gICAgdGhpc1trRW1pdHRlcl0uZGlzcGF0Y2hFdmVudChjbG9zZUV2ZW50KVxuXG4gICAgLy8gSWYgdGhlIGNsb3NlIGV2ZW50IGZyb20gdGhlIHNlcnZlciBoYXNuJ3QgYmVlbiBwcmV2ZW50ZWQsXG4gICAgLy8gZm9yd2FyZCB0aGUgY2xvc3VyZSB0byB0aGUgbW9jayBjbGllbnQuXG4gICAgaWYgKCFjbG9zZUV2ZW50LmRlZmF1bHRQcmV2ZW50ZWQpIHtcbiAgICAgIC8vIENsb3NlIHRoZSBpbnRlcmNlcHRlZCBjbGllbnQgZm9yY2VmdWxseSB0b1xuICAgICAgLy8gYWxsb3cgbm9uLWNvbmZpZ3VyYWJsZSBzdGF0dXMgY29kZXMgZnJvbSB0aGUgc2VydmVyLlxuICAgICAgLy8gSWYgdGhlIHNvY2tldCBoYXMgYmVlbiBjbG9zZWQgYnkgbm93LCBubyBoYXJtIGNhbGxpbmdcbiAgICAgIC8vIHRoaXMgYWdhaW7igJRpdCB3aWxsIGhhdmUgbm8gZWZmZWN0LlxuICAgICAgdGhpcy5jbGllbnRba0Nsb3NlXShldmVudC5jb2RlLCBldmVudC5yZWFzb24pXG4gICAgfVxuICB9XG59XG4iLCJpbXBvcnQgeyBpbnZhcmlhbnQgfSBmcm9tICdvdXR2YXJpYW50J1xuaW1wb3J0IHR5cGUgeyBXZWJTb2NrZXREYXRhIH0gZnJvbSAnLi9XZWJTb2NrZXRUcmFuc3BvcnQnXG5pbXBvcnQgeyBiaW5kRXZlbnQgfSBmcm9tICcuL3V0aWxzL2JpbmRFdmVudCdcbmltcG9ydCB7IENsb3NlRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cydcbmltcG9ydCB7IERlZmVycmVkUHJvbWlzZSB9IGZyb20gJ0BvcGVuLWRyYWZ0L2RlZmVycmVkLXByb21pc2UnXG5cbmV4cG9ydCB0eXBlIFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8XG4gIEV2ZW50VHlwZSBleHRlbmRzIFdlYlNvY2tldEV2ZW50TWFwW2tleW9mIFdlYlNvY2tldEV2ZW50TWFwXSA9IEV2ZW50XG4+ID0gKHRoaXM6IFdlYlNvY2tldCwgZXZlbnQ6IEV2ZW50VHlwZSkgPT4gdm9pZFxuXG5jb25zdCBXRUJTT0NLRVRfQ0xPU0VfQ09ERV9SQU5HRV9FUlJPUiA9XG4gICdJbnZhbGlkQWNjZXNzRXJyb3I6IGNsb3NlIGNvZGUgb3V0IG9mIHVzZXIgY29uZmlndXJhYmxlIHJhbmdlJ1xuXG5leHBvcnQgY29uc3Qga1Bhc3N0aHJvdWdoUHJvbWlzZSA9IFN5bWJvbCgna1Bhc3N0aHJvdWdoUHJvbWlzZScpXG5leHBvcnQgY29uc3Qga09uU2VuZCA9IFN5bWJvbCgna09uU2VuZCcpXG5leHBvcnQgY29uc3Qga0Nsb3NlID0gU3ltYm9sKCdrQ2xvc2UnKVxuXG5leHBvcnQgY2xhc3MgV2ViU29ja2V0T3ZlcnJpZGUgZXh0ZW5kcyBFdmVudFRhcmdldCBpbXBsZW1lbnRzIFdlYlNvY2tldCB7XG4gIHN0YXRpYyByZWFkb25seSBDT05ORUNUSU5HID0gMFxuICBzdGF0aWMgcmVhZG9ubHkgT1BFTiA9IDFcbiAgc3RhdGljIHJlYWRvbmx5IENMT1NJTkcgPSAyXG4gIHN0YXRpYyByZWFkb25seSBDTE9TRUQgPSAzXG4gIHJlYWRvbmx5IENPTk5FQ1RJTkcgPSAwXG4gIHJlYWRvbmx5IE9QRU4gPSAxXG4gIHJlYWRvbmx5IENMT1NJTkcgPSAyXG4gIHJlYWRvbmx5IENMT1NFRCA9IDNcblxuICBwdWJsaWMgdXJsOiBzdHJpbmdcbiAgcHVibGljIHByb3RvY29sOiBzdHJpbmdcbiAgcHVibGljIGV4dGVuc2lvbnM6IHN0cmluZ1xuICBwdWJsaWMgYmluYXJ5VHlwZTogQmluYXJ5VHlwZVxuICBwdWJsaWMgcmVhZHlTdGF0ZTogbnVtYmVyXG4gIHB1YmxpYyBidWZmZXJlZEFtb3VudDogbnVtYmVyXG5cbiAgcHJpdmF0ZSBfb25vcGVuOiBXZWJTb2NrZXRFdmVudExpc3RlbmVyIHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSBfb25tZXNzYWdlOiBXZWJTb2NrZXRFdmVudExpc3RlbmVyPFxuICAgIE1lc3NhZ2VFdmVudDxXZWJTb2NrZXREYXRhPlxuICA+IHwgbnVsbCA9IG51bGxcbiAgcHJpdmF0ZSBfb25lcnJvcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lciB8IG51bGwgPSBudWxsXG4gIHByaXZhdGUgX29uY2xvc2U6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8Q2xvc2VFdmVudD4gfCBudWxsID0gbnVsbFxuXG4gIHByaXZhdGUgW2tQYXNzdGhyb3VnaFByb21pc2VdOiBEZWZlcnJlZFByb21pc2U8Ym9vbGVhbj5cbiAgcHJpdmF0ZSBba09uU2VuZF0/OiAoZGF0YTogV2ViU29ja2V0RGF0YSkgPT4gdm9pZFxuXG4gIGNvbnN0cnVjdG9yKHVybDogc3RyaW5nIHwgVVJMLCBwcm90b2NvbHM/OiBzdHJpbmcgfCBBcnJheTxzdHJpbmc+KSB7XG4gICAgc3VwZXIoKVxuICAgIHRoaXMudXJsID0gdXJsLnRvU3RyaW5nKClcbiAgICB0aGlzLnByb3RvY29sID0gJydcbiAgICB0aGlzLmV4dGVuc2lvbnMgPSAnJ1xuICAgIHRoaXMuYmluYXJ5VHlwZSA9ICdibG9iJ1xuICAgIHRoaXMucmVhZHlTdGF0ZSA9IHRoaXMuQ09OTkVDVElOR1xuICAgIHRoaXMuYnVmZmVyZWRBbW91bnQgPSAwXG5cbiAgICB0aGlzW2tQYXNzdGhyb3VnaFByb21pc2VdID0gbmV3IERlZmVycmVkUHJvbWlzZTxib29sZWFuPigpXG5cbiAgICBxdWV1ZU1pY3JvdGFzayhhc3luYyAoKSA9PiB7XG4gICAgICBpZiAoYXdhaXQgdGhpc1trUGFzc3Rocm91Z2hQcm9taXNlXSkge1xuICAgICAgICByZXR1cm5cbiAgICAgIH1cblxuICAgICAgdGhpcy5wcm90b2NvbCA9XG4gICAgICAgIHR5cGVvZiBwcm90b2NvbHMgPT09ICdzdHJpbmcnXG4gICAgICAgICAgPyBwcm90b2NvbHNcbiAgICAgICAgICA6IEFycmF5LmlzQXJyYXkocHJvdG9jb2xzKSAmJiBwcm90b2NvbHMubGVuZ3RoID4gMFxuICAgICAgICAgID8gcHJvdG9jb2xzWzBdXG4gICAgICAgICAgOiAnJ1xuXG4gICAgICAvKipcbiAgICAgICAqIEBub3RlIENoZWNrIHRoYXQgbm90aGluZyBoYXMgcHJldmVudGVkIHRoaXMgY29ubmVjdGlvblxuICAgICAgICogKGUuZy4gY2FsbGVkIGBjbGllbnQuY2xvc2UoKWAgaW4gdGhlIGNvbm5lY3Rpb24gbGlzdGVuZXIpLlxuICAgICAgICogSWYgdGhlIGNvbm5lY3Rpb24gaGFzIGJlZW4gcHJldmVudGVkLCBuZXZlciBkaXNwYXRjaCB0aGUgb3BlbiBldmVudCwuXG4gICAgICAgKi9cbiAgICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuQ09OTkVDVElORykge1xuICAgICAgICB0aGlzLnJlYWR5U3RhdGUgPSB0aGlzLk9QRU5cbiAgICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGJpbmRFdmVudCh0aGlzLCBuZXcgRXZlbnQoJ29wZW4nKSkpXG4gICAgICB9XG4gICAgfSlcbiAgfVxuXG4gIHNldCBvbm9wZW4obGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXIgfCBudWxsKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdvcGVuJywgdGhpcy5fb25vcGVuKVxuICAgIHRoaXMuX29ub3BlbiA9IGxpc3RlbmVyXG4gICAgaWYgKGxpc3RlbmVyICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCBsaXN0ZW5lcilcbiAgICB9XG4gIH1cbiAgZ2V0IG9ub3BlbigpOiBXZWJTb2NrZXRFdmVudExpc3RlbmVyIHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuX29ub3BlblxuICB9XG5cbiAgc2V0IG9ubWVzc2FnZShcbiAgICBsaXN0ZW5lcjogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxNZXNzYWdlRXZlbnQ8V2ViU29ja2V0RGF0YT4+IHwgbnVsbFxuICApIHtcbiAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoXG4gICAgICAnbWVzc2FnZScsXG4gICAgICB0aGlzLl9vbm1lc3NhZ2UgYXMgV2ViU29ja2V0RXZlbnRMaXN0ZW5lclxuICAgIClcbiAgICB0aGlzLl9vbm1lc3NhZ2UgPSBsaXN0ZW5lclxuICAgIGlmIChsaXN0ZW5lciAhPT0gbnVsbCkge1xuICAgICAgdGhpcy5hZGRFdmVudExpc3RlbmVyKCdtZXNzYWdlJywgbGlzdGVuZXIpXG4gICAgfVxuICB9XG4gIGdldCBvbm1lc3NhZ2UoKTogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxNZXNzYWdlRXZlbnQ8V2ViU29ja2V0RGF0YT4+IHwgbnVsbCB7XG4gICAgcmV0dXJuIHRoaXMuX29ubWVzc2FnZVxuICB9XG5cbiAgc2V0IG9uZXJyb3IobGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXIgfCBudWxsKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdlcnJvcicsIHRoaXMuX29uZXJyb3IpXG4gICAgdGhpcy5fb25lcnJvciA9IGxpc3RlbmVyXG4gICAgaWYgKGxpc3RlbmVyICE9PSBudWxsKSB7XG4gICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ2Vycm9yJywgbGlzdGVuZXIpXG4gICAgfVxuICB9XG4gIGdldCBvbmVycm9yKCk6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXIgfCBudWxsIHtcbiAgICByZXR1cm4gdGhpcy5fb25lcnJvclxuICB9XG5cbiAgc2V0IG9uY2xvc2UobGlzdGVuZXI6IFdlYlNvY2tldEV2ZW50TGlzdGVuZXI8Q2xvc2VFdmVudD4gfCBudWxsKSB7XG4gICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCdjbG9zZScsIHRoaXMuX29uY2xvc2UgYXMgV2ViU29ja2V0RXZlbnRMaXN0ZW5lcilcbiAgICB0aGlzLl9vbmNsb3NlID0gbGlzdGVuZXJcbiAgICBpZiAobGlzdGVuZXIgIT09IG51bGwpIHtcbiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcignY2xvc2UnLCBsaXN0ZW5lcilcbiAgICB9XG4gIH1cbiAgZ2V0IG9uY2xvc2UoKTogV2ViU29ja2V0RXZlbnRMaXN0ZW5lcjxDbG9zZUV2ZW50PiB8IG51bGwge1xuICAgIHJldHVybiB0aGlzLl9vbmNsb3NlXG4gIH1cblxuICAvKipcbiAgICogQHNlZSBodHRwczovL3dlYnNvY2tldHMuc3BlYy53aGF0d2cub3JnLyNyZWYtZm9yLWRvbS13ZWJzb2NrZXQtc2VuZCVFMiU5MSVBMFxuICAgKi9cbiAgcHVibGljIHNlbmQoZGF0YTogV2ViU29ja2V0RGF0YSk6IHZvaWQge1xuICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuQ09OTkVDVElORykge1xuICAgICAgdGhpcy5jbG9zZSgpXG4gICAgICB0aHJvdyBuZXcgRE9NRXhjZXB0aW9uKCdJbnZhbGlkU3RhdGVFcnJvcicpXG4gICAgfVxuXG4gICAgLy8gU2VuZGluZyB3aGVuIHRoZSBzb2NrZXQgaXMgYWJvdXQgdG8gY2xvc2VcbiAgICAvLyBkaXNjYXJkcyB0aGUgc2VudCBkYXRhLlxuICAgIGlmICh0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuQ0xPU0lORyB8fCB0aGlzLnJlYWR5U3RhdGUgPT09IHRoaXMuQ0xPU0VEKSB7XG4gICAgICByZXR1cm5cbiAgICB9XG5cbiAgICAvLyBCdWZmZXIgdGhlIGRhdGEgdG8gc2VuZCBpbiB0aGlzIGV2ZW4gbG9vcFxuICAgIC8vIGJ1dCBzZW5kIGl0IGluIHRoZSBuZXh0LlxuICAgIHRoaXMuYnVmZmVyZWRBbW91bnQgKz0gZ2V0RGF0YVNpemUoZGF0YSlcblxuICAgIHF1ZXVlTWljcm90YXNrKCgpID0+IHtcbiAgICAgIC8vIFRoaXMgaXMgYSBiaXQgb3B0aW1pc3RpYyBidXQgc2luY2Ugbm8gYWN0dWFsIGRhdGEgdHJhbnNmZXJcbiAgICAgIC8vIGlzIGludm9sdmVkLCBhbGwgdGhlIGRhdGEgd2lsbCBiZSBcInNlbnRcIiBvbiB0aGUgbmV4dCB0aWNrLlxuICAgICAgdGhpcy5idWZmZXJlZEFtb3VudCA9IDBcblxuICAgICAgLyoqXG4gICAgICAgKiBAbm90ZSBOb3RpZnkgdGhlIHBhcmVudCBhYm91dCBvdXRnb2luZyBkYXRhLlxuICAgICAgICogVGhpcyBub3RpZmllcyB0aGUgdHJhbnNwb3J0IGFuZCB0aGUgY29ubmVjdGlvblxuICAgICAgICogbGlzdGVucyB0byB0aGUgb3V0Z29pbmcgZGF0YSB0byBlbWl0IHRoZSBcIm1lc3NhZ2VcIiBldmVudC5cbiAgICAgICAqL1xuICAgICAgdGhpc1trT25TZW5kXT8uKGRhdGEpXG4gICAgfSlcbiAgfVxuXG4gIHB1YmxpYyBjbG9zZShjb2RlOiBudW1iZXIgPSAxMDAwLCByZWFzb24/OiBzdHJpbmcpOiB2b2lkIHtcbiAgICBpbnZhcmlhbnQoY29kZSwgV0VCU09DS0VUX0NMT1NFX0NPREVfUkFOR0VfRVJST1IpXG4gICAgaW52YXJpYW50KFxuICAgICAgY29kZSA9PT0gMTAwMCB8fCAoY29kZSA+PSAzMDAwICYmIGNvZGUgPD0gNDk5OSksXG4gICAgICBXRUJTT0NLRVRfQ0xPU0VfQ09ERV9SQU5HRV9FUlJPUlxuICAgIClcblxuICAgIHRoaXNba0Nsb3NlXShjb2RlLCByZWFzb24pXG4gIH1cblxuICBwcml2YXRlIFtrQ2xvc2VdKFxuICAgIGNvZGU6IG51bWJlciA9IDEwMDAsXG4gICAgcmVhc29uPzogc3RyaW5nLFxuICAgIHdhc0NsZWFuID0gdHJ1ZVxuICApOiB2b2lkIHtcbiAgICAvKipcbiAgICAgKiBAbm90ZSBNb3ZlIHRoaXMgY2hlY2sgaGVyZSBzbyB0aGF0IGV2ZW4gaW50ZXJuYWwgY2xvc3VyZXMsXG4gICAgICogbGlrZSB0aG9zZSB0cmlnZ2VyZWQgYnkgdGhlIGBzZXJ2ZXJgIGNvbm5lY3Rpb24sIGFyZSBub3RcbiAgICAgKiBwZXJmb3JtZWQgdHdpY2UuXG4gICAgICovXG4gICAgaWYgKHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5DTE9TSU5HIHx8IHRoaXMucmVhZHlTdGF0ZSA9PT0gdGhpcy5DTE9TRUQpIHtcbiAgICAgIHJldHVyblxuICAgIH1cblxuICAgIHRoaXMucmVhZHlTdGF0ZSA9IHRoaXMuQ0xPU0lOR1xuXG4gICAgcXVldWVNaWNyb3Rhc2soKCkgPT4ge1xuICAgICAgdGhpcy5yZWFkeVN0YXRlID0gdGhpcy5DTE9TRURcblxuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KFxuICAgICAgICBiaW5kRXZlbnQoXG4gICAgICAgICAgdGhpcyxcbiAgICAgICAgICBuZXcgQ2xvc2VFdmVudCgnY2xvc2UnLCB7XG4gICAgICAgICAgICBjb2RlLFxuICAgICAgICAgICAgcmVhc29uLFxuICAgICAgICAgICAgd2FzQ2xlYW4sXG4gICAgICAgICAgfSlcbiAgICAgICAgKVxuICAgICAgKVxuXG4gICAgICAvLyBSZW1vdmUgYWxsIGV2ZW50IGxpc3RlbmVycyBvbmNlIHRoZSBzb2NrZXQgaXMgY2xvc2VkLlxuICAgICAgdGhpcy5fb25vcGVuID0gbnVsbFxuICAgICAgdGhpcy5fb25tZXNzYWdlID0gbnVsbFxuICAgICAgdGhpcy5fb25lcnJvciA9IG51bGxcbiAgICAgIHRoaXMuX29uY2xvc2UgPSBudWxsXG4gICAgfSlcbiAgfVxuXG4gIHB1YmxpYyBhZGRFdmVudExpc3RlbmVyPEsgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRFdmVudE1hcD4oXG4gICAgdHlwZTogSyxcbiAgICBsaXN0ZW5lcjogKHRoaXM6IFdlYlNvY2tldCwgZXZlbnQ6IFdlYlNvY2tldEV2ZW50TWFwW0tdKSA9PiB2b2lkLFxuICAgIG9wdGlvbnM/OiBib29sZWFuIHwgQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnNcbiAgKTogdm9pZFxuICBwdWJsaWMgYWRkRXZlbnRMaXN0ZW5lcihcbiAgICB0eXBlOiBzdHJpbmcsXG4gICAgbGlzdGVuZXI6IEV2ZW50TGlzdGVuZXJPckV2ZW50TGlzdGVuZXJPYmplY3QsXG4gICAgb3B0aW9ucz86IGJvb2xlYW4gfCBBZGRFdmVudExpc3RlbmVyT3B0aW9uc1xuICApOiB2b2lkXG4gIHB1YmxpYyBhZGRFdmVudExpc3RlbmVyKFxuICAgIHR5cGU6IHVua25vd24sXG4gICAgbGlzdGVuZXI6IHVua25vd24sXG4gICAgb3B0aW9ucz86IHVua25vd25cbiAgKTogdm9pZCB7XG4gICAgcmV0dXJuIHN1cGVyLmFkZEV2ZW50TGlzdGVuZXIoXG4gICAgICB0eXBlIGFzIHN0cmluZyxcbiAgICAgIGxpc3RlbmVyIGFzIEV2ZW50TGlzdGVuZXIsXG4gICAgICBvcHRpb25zIGFzIEFkZEV2ZW50TGlzdGVuZXJPcHRpb25zXG4gICAgKVxuICB9XG5cbiAgcmVtb3ZlRXZlbnRMaXN0ZW5lcjxLIGV4dGVuZHMga2V5b2YgV2ViU29ja2V0RXZlbnRNYXA+KFxuICAgIHR5cGU6IEssXG4gICAgY2FsbGJhY2s6IEV2ZW50TGlzdGVuZXJPckV2ZW50TGlzdGVuZXJPYmplY3QgfCBudWxsLFxuICAgIG9wdGlvbnM/OiBib29sZWFuIHwgRXZlbnRMaXN0ZW5lck9wdGlvbnNcbiAgKTogdm9pZCB7XG4gICAgcmV0dXJuIHN1cGVyLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2ssIG9wdGlvbnMpXG4gIH1cbn1cblxuZnVuY3Rpb24gZ2V0RGF0YVNpemUoZGF0YTogV2ViU29ja2V0RGF0YSk6IG51bWJlciB7XG4gIGlmICh0eXBlb2YgZGF0YSA9PT0gJ3N0cmluZycpIHtcbiAgICByZXR1cm4gZGF0YS5sZW5ndGhcbiAgfVxuXG4gIGlmIChkYXRhIGluc3RhbmNlb2YgQmxvYikge1xuICAgIHJldHVybiBkYXRhLnNpemVcbiAgfVxuXG4gIHJldHVybiBkYXRhLmJ5dGVMZW5ndGhcbn1cbiIsImltcG9ydCB7IGJpbmRFdmVudCB9IGZyb20gJy4vdXRpbHMvYmluZEV2ZW50J1xuaW1wb3J0IHtcbiAgU3RyaWN0RXZlbnRMaXN0ZW5lck9yRXZlbnRMaXN0ZW5lck9iamVjdCxcbiAgV2ViU29ja2V0RGF0YSxcbiAgV2ViU29ja2V0VHJhbnNwb3J0LFxuICBXZWJTb2NrZXRUcmFuc3BvcnRFdmVudE1hcCxcbn0gZnJvbSAnLi9XZWJTb2NrZXRUcmFuc3BvcnQnXG5pbXBvcnQgeyBrT25TZW5kLCBrQ2xvc2UsIFdlYlNvY2tldE92ZXJyaWRlIH0gZnJvbSAnLi9XZWJTb2NrZXRPdmVycmlkZSdcbmltcG9ydCB7IENhbmNlbGFibGVNZXNzYWdlRXZlbnQsIENsb3NlRXZlbnQgfSBmcm9tICcuL3V0aWxzL2V2ZW50cydcblxuLyoqXG4gKiBBYnN0cmFjdGlvbiBvdmVyIHRoZSBnaXZlbiBtb2NrIGBXZWJTb2NrZXRgIGluc3RhbmNlIHRoYXQgYWxsb3dzXG4gKiBmb3IgY29udHJvbGxpbmcgdGhhdCBpbnN0YW5jZSAoZS5nLiBzZW5kaW5nIGFuZCByZWNlaXZpbmcgbWVzc2FnZXMpLlxuICovXG5leHBvcnQgY2xhc3MgV2ViU29ja2V0Q2xhc3NUcmFuc3BvcnRcbiAgZXh0ZW5kcyBFdmVudFRhcmdldFxuICBpbXBsZW1lbnRzIFdlYlNvY2tldFRyYW5zcG9ydFxue1xuICBjb25zdHJ1Y3Rvcihwcm90ZWN0ZWQgcmVhZG9ubHkgc29ja2V0OiBXZWJTb2NrZXRPdmVycmlkZSkge1xuICAgIHN1cGVyKClcblxuICAgIC8vIEVtaXQgdGhlIFwiY2xvc2VcIiBldmVudCBvbiB0aGUgdHJhbnNwb3J0IGlmIHRoZSBjbG9zZVxuICAgIC8vIG9yaWdpbmF0ZXMgZnJvbSB0aGUgV2ViU29ja2V0IGNsaWVudC4gRS5nLiB0aGUgYXBwbGljYXRpb25cbiAgICAvLyBjYWxscyBcIndzLmNsb3NlKClcIiwgbm90IHRoZSBpbnRlcmNlcHRvci5cbiAgICB0aGlzLnNvY2tldC5hZGRFdmVudExpc3RlbmVyKCdjbG9zZScsIChldmVudCkgPT4ge1xuICAgICAgdGhpcy5kaXNwYXRjaEV2ZW50KGJpbmRFdmVudCh0aGlzLnNvY2tldCwgbmV3IENsb3NlRXZlbnQoJ2Nsb3NlJywgZXZlbnQpKSlcbiAgICB9KVxuXG4gICAgLyoqXG4gICAgICogRW1pdCB0aGUgXCJvdXRnb2luZ1wiIGV2ZW50IG9uIHRoZSB0cmFuc3BvcnRcbiAgICAgKiB3aGVuZXZlciB0aGUgV2ViU29ja2V0IGNsaWVudCBzZW5kcyBkYXRhIChcIndzLnNlbmQoKVwiKS5cbiAgICAgKi9cbiAgICB0aGlzLnNvY2tldFtrT25TZW5kXSA9IChkYXRhKSA9PiB7XG4gICAgICB0aGlzLmRpc3BhdGNoRXZlbnQoXG4gICAgICAgIGJpbmRFdmVudChcbiAgICAgICAgICB0aGlzLnNvY2tldCxcbiAgICAgICAgICAvLyBEaXNwYXRjaCB0aGlzIGFzIGNhbmNlbGFibGUgYmVjYXVzZSBcImNsaWVudFwiIGNvbm5lY3Rpb25cbiAgICAgICAgICAvLyByZS1jcmVhdGVzIHRoaXMgbWVzc2FnZSBldmVudCAoY2Fubm90IGRpc3BhdGNoIHRoZSBzYW1lIGV2ZW50KS5cbiAgICAgICAgICBuZXcgQ2FuY2VsYWJsZU1lc3NhZ2VFdmVudCgnb3V0Z29pbmcnLCB7XG4gICAgICAgICAgICBkYXRhLFxuICAgICAgICAgICAgb3JpZ2luOiB0aGlzLnNvY2tldC51cmwsXG4gICAgICAgICAgICBjYW5jZWxhYmxlOiB0cnVlLFxuICAgICAgICAgIH0pXG4gICAgICAgIClcbiAgICAgIClcbiAgICB9XG4gIH1cblxuICBwdWJsaWMgYWRkRXZlbnRMaXN0ZW5lcjxFdmVudFR5cGUgZXh0ZW5kcyBrZXlvZiBXZWJTb2NrZXRUcmFuc3BvcnRFdmVudE1hcD4oXG4gICAgdHlwZTogRXZlbnRUeXBlLFxuICAgIGNhbGxiYWNrOiBTdHJpY3RFdmVudExpc3RlbmVyT3JFdmVudExpc3RlbmVyT2JqZWN0PFxuICAgICAgV2ViU29ja2V0VHJhbnNwb3J0RXZlbnRNYXBbRXZlbnRUeXBlXVxuICAgID4gfCBudWxsLFxuICAgIG9wdGlvbnM/OiBib29sZWFuIHwgQWRkRXZlbnRMaXN0ZW5lck9wdGlvbnNcbiAgKTogdm9pZCB7XG4gICAgcmV0dXJuIHN1cGVyLmFkZEV2ZW50TGlzdGVuZXIodHlwZSwgY2FsbGJhY2sgYXMgRXZlbnRMaXN0ZW5lciwgb3B0aW9ucylcbiAgfVxuXG4gIHB1YmxpYyBkaXNwYXRjaEV2ZW50PEV2ZW50VHlwZSBleHRlbmRzIGtleW9mIFdlYlNvY2tldFRyYW5zcG9ydEV2ZW50TWFwPihcbiAgICBldmVudDogV2ViU29ja2V0VHJhbnNwb3J0RXZlbnRNYXBbRXZlbnRUeXBlXVxuICApOiBib29sZWFuIHtcbiAgICByZXR1cm4gc3VwZXIuZGlzcGF0Y2hFdmVudChldmVudClcbiAgfVxuXG4gIHB1YmxpYyBzZW5kKGRhdGE6IFdlYlNvY2tldERhdGEpOiB2b2lkIHtcbiAgICBxdWV1ZU1pY3JvdGFzaygoKSA9PiB7XG4gICAgICBpZiAoXG4gICAgICAgIHRoaXMuc29ja2V0LnJlYWR5U3RhdGUgPT09IHRoaXMuc29ja2V0LkNMT1NJTkcgfHxcbiAgICAgICAgdGhpcy5zb2NrZXQucmVhZHlTdGF0ZSA9PT0gdGhpcy5zb2NrZXQuQ0xPU0VEXG4gICAgICApIHtcbiAgICAgICAgcmV0dXJuXG4gICAgICB9XG5cbiAgICAgIGNvbnN0IGRpc3BhdGNoRXZlbnQgPSAoKSA9PiB7XG4gICAgICAgIHRoaXMuc29ja2V0LmRpc3BhdGNoRXZlbnQoXG4gICAgICAgICAgYmluZEV2ZW50KFxuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAbm90ZSBTZXR0aW5nIHRoaXMgZXZlbnQncyBcInRhcmdldFwiIHRvIHRoZVxuICAgICAgICAgICAgICogV2ViU29ja2V0IG92ZXJyaWRlIGluc3RhbmNlIGlzIGltcG9ydGFudC5cbiAgICAgICAgICAgICAqIFRoaXMgd2F5IGl0IGNhbiB0ZWxsIGFwYXJ0IG9yaWdpbmFsIGluY29taW5nIGV2ZW50c1xuICAgICAgICAgICAgICogKG11c3QgYmUgZm9yd2FyZGVkIHRvIHRoZSB0cmFuc3BvcnQpIGZyb20gdGhlXG4gICAgICAgICAgICAgKiBtb2NrZWQgbWVzc2FnZSBldmVudHMgbGlrZSB0aGUgb25lIGJlbG93XG4gICAgICAgICAgICAgKiAobXVzdCBiZSBkaXNwYXRjaGVkIG9uIHRoZSBjbGllbnQgaW5zdGFuY2UpLlxuICAgICAgICAgICAgICovXG4gICAgICAgICAgICB0aGlzLnNvY2tldCxcbiAgICAgICAgICAgIG5ldyBNZXNzYWdlRXZlbnQoJ21lc3NhZ2UnLCB7XG4gICAgICAgICAgICAgIGRhdGEsXG4gICAgICAgICAgICAgIG9yaWdpbjogdGhpcy5zb2NrZXQudXJsLFxuICAgICAgICAgICAgfSlcbiAgICAgICAgICApXG4gICAgICAgIClcbiAgICAgIH1cblxuICAgICAgaWYgKHRoaXMuc29ja2V0LnJlYWR5U3RhdGUgPT09IHRoaXMuc29ja2V0LkNPTk5FQ1RJTkcpIHtcbiAgICAgICAgdGhpcy5zb2NrZXQuYWRkRXZlbnRMaXN0ZW5lcihcbiAgICAgICAgICAnb3BlbicsXG4gICAgICAgICAgKCkgPT4ge1xuICAgICAgICAgICAgZGlzcGF0Y2hFdmVudCgpXG4gICAgICAgICAgfSxcbiAgICAgICAgICB7IG9uY2U6IHRydWUgfVxuICAgICAgICApXG4gICAgICB9IGVsc2Uge1xuICAgICAgICBkaXNwYXRjaEV2ZW50KClcbiAgICAgIH1cbiAgICB9KVxuICB9XG5cbiAgcHVibGljIGNsb3NlKGNvZGU6IG51bWJlciwgcmVhc29uPzogc3RyaW5nKTogdm9pZCB7XG4gICAgLyoqXG4gICAgICogQG5vdGUgQ2FsbCB0aGUgaW50ZXJuYWwgY2xvc2UgbWV0aG9kIGRpcmVjdGx5XG4gICAgICogdG8gYWxsb3cgY2xvc2luZyB0aGUgY29ubmVjdGlvbiB3aXRoIHRoZSBzdGF0dXMgY29kZXNcbiAgICAgKiB0aGF0IGFyZSBub24tY29uZmlndXJhYmxlIGJ5IHRoZSB1c2VyICg+IDEwMDAgPD0gMTAxNSkuXG4gICAgICovXG4gICAgdGhpcy5zb2NrZXRba0Nsb3NlXShjb2RlLCByZWFzb24pXG4gIH1cbn1cbiIsImltcG9ydCB7IEludGVyY2VwdG9yIH0gZnJvbSAnLi4vLi4vSW50ZXJjZXB0b3InXG5pbXBvcnQge1xuICBXZWJTb2NrZXRDbGllbnRDb25uZWN0aW9uUHJvdG9jb2wsXG4gIFdlYlNvY2tldENsaWVudENvbm5lY3Rpb24sXG4gIHR5cGUgV2ViU29ja2V0Q2xpZW50RXZlbnRNYXAsXG59IGZyb20gJy4vV2ViU29ja2V0Q2xpZW50Q29ubmVjdGlvbidcbmltcG9ydCB7XG4gIFdlYlNvY2tldFNlcnZlckNvbm5lY3Rpb25Qcm90b2NvbCxcbiAgV2ViU29ja2V0U2VydmVyQ29ubmVjdGlvbixcbiAgdHlwZSBXZWJTb2NrZXRTZXJ2ZXJFdmVudE1hcCxcbn0gZnJvbSAnLi9XZWJTb2NrZXRTZXJ2ZXJDb25uZWN0aW9uJ1xuaW1wb3J0IHsgV2ViU29ja2V0Q2xhc3NUcmFuc3BvcnQgfSBmcm9tICcuL1dlYlNvY2tldENsYXNzVHJhbnNwb3J0J1xuaW1wb3J0IHtcbiAga0Nsb3NlLFxuICBrUGFzc3Rocm91Z2hQcm9taXNlLFxuICBXZWJTb2NrZXRPdmVycmlkZSxcbn0gZnJvbSAnLi9XZWJTb2NrZXRPdmVycmlkZSdcbmltcG9ydCB7IGJpbmRFdmVudCB9IGZyb20gJy4vdXRpbHMvYmluZEV2ZW50J1xuaW1wb3J0IHsgaGFzQ29uZmlndXJhYmxlR2xvYmFsIH0gZnJvbSAnLi4vLi4vdXRpbHMvaGFzQ29uZmlndXJhYmxlR2xvYmFsJ1xuaW1wb3J0IHsgZW1pdEFzeW5jIH0gZnJvbSAnLi4vLi4vdXRpbHMvZW1pdEFzeW5jJ1xuXG5leHBvcnQgeyB0eXBlIFdlYlNvY2tldERhdGEsIFdlYlNvY2tldFRyYW5zcG9ydCB9IGZyb20gJy4vV2ViU29ja2V0VHJhbnNwb3J0J1xuZXhwb3J0IHtcbiAgV2ViU29ja2V0Q2xpZW50RXZlbnRNYXAsXG4gIFdlYlNvY2tldENsaWVudENvbm5lY3Rpb25Qcm90b2NvbCxcbiAgV2ViU29ja2V0Q2xpZW50Q29ubmVjdGlvbixcbiAgV2ViU29ja2V0U2VydmVyRXZlbnRNYXAsXG4gIFdlYlNvY2tldFNlcnZlckNvbm5lY3Rpb25Qcm90b2NvbCxcbiAgV2ViU29ja2V0U2VydmVyQ29ubmVjdGlvbixcbn1cblxuZXhwb3J0IHtcbiAgQ2xvc2VFdmVudCxcbiAgQ2FuY2VsYWJsZUNsb3NlRXZlbnQsXG4gIENhbmNlbGFibGVNZXNzYWdlRXZlbnQsXG59IGZyb20gJy4vdXRpbHMvZXZlbnRzJ1xuXG5leHBvcnQgdHlwZSBXZWJTb2NrZXRFdmVudE1hcCA9IHtcbiAgY29ubmVjdGlvbjogW2FyZ3M6IFdlYlNvY2tldENvbm5lY3Rpb25EYXRhXVxufVxuXG5leHBvcnQgdHlwZSBXZWJTb2NrZXRDb25uZWN0aW9uRGF0YSA9IHtcbiAgLyoqXG4gICAqIFRoZSBpbmNvbWluZyBXZWJTb2NrZXQgY2xpZW50IGNvbm5lY3Rpb24uXG4gICAqL1xuICBjbGllbnQ6IFdlYlNvY2tldENsaWVudENvbm5lY3Rpb25cblxuICAvKipcbiAgICogVGhlIG9yaWdpbmFsIFdlYlNvY2tldCBzZXJ2ZXIgY29ubmVjdGlvbi5cbiAgICovXG4gIHNlcnZlcjogV2ViU29ja2V0U2VydmVyQ29ubmVjdGlvblxuXG4gIC8qKlxuICAgKiBUaGUgY29ubmVjdGlvbiBpbmZvcm1hdGlvbi5cbiAgICovXG4gIGluZm86IHtcbiAgICAvKipcbiAgICAgKiBUaGUgcHJvdG9jb2xzIHN1cHBvcnRlZCBieSB0aGUgV2ViU29ja2V0IGNsaWVudC5cbiAgICAgKi9cbiAgICBwcm90b2NvbHM6IHN0cmluZyB8IEFycmF5PHN0cmluZz4gfCB1bmRlZmluZWRcbiAgfVxufVxuXG4vKipcbiAqIEludGVyY2VwdCB0aGUgb3V0Z29pbmcgV2ViU29ja2V0IGNvbm5lY3Rpb25zIGNyZWF0ZWQgdXNpbmdcbiAqIHRoZSBnbG9iYWwgYFdlYlNvY2tldGAgY2xhc3MuXG4gKi9cbmV4cG9ydCBjbGFzcyBXZWJTb2NrZXRJbnRlcmNlcHRvciBleHRlbmRzIEludGVyY2VwdG9yPFdlYlNvY2tldEV2ZW50TWFwPiB7XG4gIHN0YXRpYyBzeW1ib2wgPSBTeW1ib2woJ3dlYnNvY2tldCcpXG5cbiAgY29uc3RydWN0b3IoKSB7XG4gICAgc3VwZXIoV2ViU29ja2V0SW50ZXJjZXB0b3Iuc3ltYm9sKVxuICB9XG5cbiAgcHJvdGVjdGVkIGNoZWNrRW52aXJvbm1lbnQoKTogYm9vbGVhbiB7XG4gICAgcmV0dXJuIGhhc0NvbmZpZ3VyYWJsZUdsb2JhbCgnV2ViU29ja2V0JylcbiAgfVxuXG4gIHByb3RlY3RlZCBzZXR1cCgpOiB2b2lkIHtcbiAgICBjb25zdCBvcmlnaW5hbFdlYlNvY2tldERlc2NyaXB0b3IgPSBPYmplY3QuZ2V0T3duUHJvcGVydHlEZXNjcmlwdG9yKFxuICAgICAgZ2xvYmFsVGhpcyxcbiAgICAgICdXZWJTb2NrZXQnXG4gICAgKVxuXG4gICAgY29uc3QgV2ViU29ja2V0UHJveHkgPSBuZXcgUHJveHkoZ2xvYmFsVGhpcy5XZWJTb2NrZXQsIHtcbiAgICAgIGNvbnN0cnVjdDogKFxuICAgICAgICB0YXJnZXQsXG4gICAgICAgIGFyZ3M6IENvbnN0cnVjdG9yUGFyYW1ldGVyczx0eXBlb2YgZ2xvYmFsVGhpcy5XZWJTb2NrZXQ+LFxuICAgICAgICBuZXdUYXJnZXRcbiAgICAgICkgPT4ge1xuICAgICAgICBjb25zdCBbdXJsLCBwcm90b2NvbHNdID0gYXJnc1xuXG4gICAgICAgIGNvbnN0IGNyZWF0ZUNvbm5lY3Rpb24gPSAoKTogV2ViU29ja2V0ID0+IHtcbiAgICAgICAgICByZXR1cm4gUmVmbGVjdC5jb25zdHJ1Y3QodGFyZ2V0LCBhcmdzLCBuZXdUYXJnZXQpXG4gICAgICAgIH1cblxuICAgICAgICAvLyBBbGwgV2ViU29ja2V0IGluc3RhbmNlcyBhcmUgbW9ja2VkIGFuZCBkb24ndCBmb3J3YXJkXG4gICAgICAgIC8vIGFueSBldmVudHMgdG8gdGhlIG9yaWdpbmFsIHNlcnZlciAobm8gY29ubmVjdGlvbiBlc3RhYmxpc2hlZCkuXG4gICAgICAgIC8vIFRvIGZvcndhcmQgdGhlIGV2ZW50cywgdGhlIHVzZXIgbXVzdCB1c2UgdGhlIFwic2VydmVyLnNlbmQoKVwiIEFQSS5cbiAgICAgICAgY29uc3Qgc29ja2V0ID0gbmV3IFdlYlNvY2tldE92ZXJyaWRlKHVybCwgcHJvdG9jb2xzKVxuICAgICAgICBjb25zdCB0cmFuc3BvcnQgPSBuZXcgV2ViU29ja2V0Q2xhc3NUcmFuc3BvcnQoc29ja2V0KVxuXG4gICAgICAgIC8vIEVtaXQgdGhlIFwiY29ubmVjdGlvblwiIGV2ZW50IHRvIHRoZSBpbnRlcmNlcHRvciBvbiB0aGUgbmV4dCB0aWNrXG4gICAgICAgIC8vIHNvIHRoZSBjbGllbnQgY2FuIG1vZGlmeSBXZWJTb2NrZXQgb3B0aW9ucywgbGlrZSBcImJpbmFyeVR5cGVcIlxuICAgICAgICAvLyB3aGlsZSB0aGUgY29ubmVjdGlvbiBpcyBhbHJlYWR5IHBlbmRpbmcuXG4gICAgICAgIHF1ZXVlTWljcm90YXNrKGFzeW5jICgpID0+IHtcbiAgICAgICAgICB0cnkge1xuICAgICAgICAgICAgY29uc3Qgc2VydmVyID0gbmV3IFdlYlNvY2tldFNlcnZlckNvbm5lY3Rpb24oXG4gICAgICAgICAgICAgIHNvY2tldCxcbiAgICAgICAgICAgICAgdHJhbnNwb3J0LFxuICAgICAgICAgICAgICBjcmVhdGVDb25uZWN0aW9uXG4gICAgICAgICAgICApXG5cbiAgICAgICAgICAgIGNvbnN0IGhhc0Nvbm5lY3Rpb25MaXN0ZW5lcnMgPVxuICAgICAgICAgICAgICB0aGlzLmVtaXR0ZXIubGlzdGVuZXJDb3VudCgnY29ubmVjdGlvbicpID4gMFxuXG4gICAgICAgICAgICAvLyBUaGUgXCJnbG9iYWxUaGlzLldlYlNvY2tldFwiIGNsYXNzIHN0YW5kcyBmb3JcbiAgICAgICAgICAgIC8vIHRoZSBjbGllbnQtc2lkZSBjb25uZWN0aW9uLiBBc3N1bWUgaXQncyBlc3RhYmxpc2hlZFxuICAgICAgICAgICAgLy8gYXMgc29vbiBhcyB0aGUgV2ViU29ja2V0IGluc3RhbmNlIGlzIGNvbnN0cnVjdGVkLlxuICAgICAgICAgICAgYXdhaXQgZW1pdEFzeW5jKHRoaXMuZW1pdHRlciwgJ2Nvbm5lY3Rpb24nLCB7XG4gICAgICAgICAgICAgIGNsaWVudDogbmV3IFdlYlNvY2tldENsaWVudENvbm5lY3Rpb24oc29ja2V0LCB0cmFuc3BvcnQpLFxuICAgICAgICAgICAgICBzZXJ2ZXIsXG4gICAgICAgICAgICAgIGluZm86IHtcbiAgICAgICAgICAgICAgICBwcm90b2NvbHMsXG4gICAgICAgICAgICAgIH0sXG4gICAgICAgICAgICB9KVxuXG4gICAgICAgICAgICBpZiAoaGFzQ29ubmVjdGlvbkxpc3RlbmVycykge1xuICAgICAgICAgICAgICBzb2NrZXRba1Bhc3N0aHJvdWdoUHJvbWlzZV0ucmVzb2x2ZShmYWxzZSlcbiAgICAgICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgICAgIHNvY2tldFtrUGFzc3Rocm91Z2hQcm9taXNlXS5yZXNvbHZlKHRydWUpXG5cbiAgICAgICAgICAgICAgc2VydmVyLmNvbm5lY3QoKVxuXG4gICAgICAgICAgICAgIC8vIEZvcndhcmQgdGhlIFwib3BlblwiIGV2ZW50IGZyb20gdGhlIG9yaWdpbmFsIHNlcnZlclxuICAgICAgICAgICAgICAvLyB0byB0aGUgbW9jayBXZWJTb2NrZXQgY2xpZW50IGluIHRoZSBjYXNlIG9mIGEgcGFzc3Rocm91Z2ggY29ubmVjdGlvbi5cbiAgICAgICAgICAgICAgc2VydmVyLmFkZEV2ZW50TGlzdGVuZXIoJ29wZW4nLCAoKSA9PiB7XG4gICAgICAgICAgICAgICAgc29ja2V0LmRpc3BhdGNoRXZlbnQoYmluZEV2ZW50KHNvY2tldCwgbmV3IEV2ZW50KCdvcGVuJykpKVxuXG4gICAgICAgICAgICAgICAgLy8gRm9yd2FyZCB0aGUgb3JpZ2luYWwgY29ubmVjdGlvbiBwcm90b2NvbCB0byB0aGVcbiAgICAgICAgICAgICAgICAvLyBtb2NrIFdlYlNvY2tldCBjbGllbnQuXG4gICAgICAgICAgICAgICAgaWYgKHNlcnZlclsncmVhbFdlYlNvY2tldCddKSB7XG4gICAgICAgICAgICAgICAgICBzb2NrZXQucHJvdG9jb2wgPSBzZXJ2ZXJbJ3JlYWxXZWJTb2NrZXQnXS5wcm90b2NvbFxuICAgICAgICAgICAgICAgIH1cbiAgICAgICAgICAgICAgfSlcbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9IGNhdGNoIChlcnJvcikge1xuICAgICAgICAgICAgLyoqXG4gICAgICAgICAgICAgKiBAbm90ZSBUcmFuc2xhdGUgdW5oYW5kbGVkIGV4Y2VwdGlvbnMgZHVyaW5nIHRoZSBjb25uZWN0aW9uXG4gICAgICAgICAgICAgKiBoYW5kbGluZyAoaS5lLiBpbnRlcmNlcHRvciBleGNlcHRpb25zKSBhcyBXZWJTb2NrZXQgY29ubmVjdGlvblxuICAgICAgICAgICAgICogY2xvc3VyZXMgd2l0aCBlcnJvci4gVGhpcyBwcmV2ZW50cyBmcm9tIHRoZSBleGNlcHRpb25zIG9jY3VycmluZ1xuICAgICAgICAgICAgICogaW4gYHF1ZXVlTWljcm90YXNrYCBmcm9tIGJlaW5nIHByb2Nlc3Mtd2lkZSBhbmQgdW5jYXRjaGFibGUuXG4gICAgICAgICAgICAgKi9cbiAgICAgICAgICAgIGlmIChlcnJvciBpbnN0YW5jZW9mIEVycm9yKSB7XG4gICAgICAgICAgICAgIHNvY2tldC5kaXNwYXRjaEV2ZW50KG5ldyBFdmVudCgnZXJyb3InKSlcblxuICAgICAgICAgICAgICAvLyBObyBuZWVkIHRvIGNsb3NlIHRoZSBjb25uZWN0aW9uIGlmIGl0J3MgYWxyZWFkeSBiZWluZyBjbG9zZWQuXG4gICAgICAgICAgICAgIC8vIEUuZy4gdGhlIGludGVyY2VwdG9yIGNhbGxlZCBgY2xpZW50LmNsb3NlKClgIGFuZCB0aGVuIHRocmV3IGFuIGVycm9yLlxuICAgICAgICAgICAgICBpZiAoXG4gICAgICAgICAgICAgICAgc29ja2V0LnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5DTE9TSU5HICYmXG4gICAgICAgICAgICAgICAgc29ja2V0LnJlYWR5U3RhdGUgIT09IFdlYlNvY2tldC5DTE9TRURcbiAgICAgICAgICAgICAgKSB7XG4gICAgICAgICAgICAgICAgc29ja2V0W2tDbG9zZV0oMTAxMSwgZXJyb3IubWVzc2FnZSwgZmFsc2UpXG4gICAgICAgICAgICAgIH1cblxuICAgICAgICAgICAgICBjb25zb2xlLmVycm9yKGVycm9yKVxuICAgICAgICAgICAgfVxuICAgICAgICAgIH1cbiAgICAgICAgfSlcblxuICAgICAgICByZXR1cm4gc29ja2V0XG4gICAgICB9LFxuICAgIH0pXG5cbiAgICBPYmplY3QuZGVmaW5lUHJvcGVydHkoZ2xvYmFsVGhpcywgJ1dlYlNvY2tldCcsIHtcbiAgICAgIHZhbHVlOiBXZWJTb2NrZXRQcm94eSxcbiAgICAgIGNvbmZpZ3VyYWJsZTogdHJ1ZSxcbiAgICB9KVxuXG4gICAgdGhpcy5zdWJzY3JpcHRpb25zLnB1c2goKCkgPT4ge1xuICAgICAgT2JqZWN0LmRlZmluZVByb3BlcnR5KFxuICAgICAgICBnbG9iYWxUaGlzLFxuICAgICAgICAnV2ViU29ja2V0JyxcbiAgICAgICAgb3JpZ2luYWxXZWJTb2NrZXREZXNjcmlwdG9yIVxuICAgICAgKVxuICAgIH0pXG4gIH1cbn1cbiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7O0FBRU8sU0FBU0EsVUFDZEMsTUFBQSxFQUNBQyxLQUFBLEVBQ3VCO0VBQ3ZCQyxNQUFBLENBQU9DLGdCQUFBLENBQWlCRixLQUFBLEVBQU87SUFDN0JELE1BQUEsRUFBUTtNQUNOSSxLQUFBLEVBQU9KLE1BQUE7TUFDUEssVUFBQSxFQUFZO01BQ1pDLFFBQUEsRUFBVTtJQUNaO0lBQ0FDLGFBQUEsRUFBZTtNQUNiSCxLQUFBLEVBQU9KLE1BQUE7TUFDUEssVUFBQSxFQUFZO01BQ1pDLFFBQUEsRUFBVTtJQUNaO0VBQ0YsQ0FBQztFQUVELE9BQU9MLEtBQUE7QUFDVDs7O0FDcEJBLElBQU1PLFdBQUEsR0FBY0MsTUFBQSxDQUFPLGFBQWE7QUFDeEMsSUFBTUMsaUJBQUEsR0FBb0JELE1BQUEsQ0FBTyxtQkFBbUI7QUFTN0MsSUFBTUUsc0JBQUEsR0FBTixjQUE4Q0MsWUFBQSxDQUFnQjtFQUluRUMsWUFBWUMsSUFBQSxFQUFjQyxJQUFBLEVBQTJCO0lBQ25ELE1BQU1ELElBQUEsRUFBTUMsSUFBSTtJQUNoQixLQUFLUCxXQUFXLElBQUksQ0FBQyxDQUFDTyxJQUFBLENBQUtDLFVBQUE7SUFDM0IsS0FBS04saUJBQWlCLElBQUk7RUFDNUI7RUFFQSxJQUFJTSxXQUFBLEVBQWE7SUFDZixPQUFPLEtBQUtSLFdBQVc7RUFDekI7RUFFQSxJQUFJUSxXQUFXQyxjQUFBLEVBQWdCO0lBQzdCLEtBQUtULFdBQVcsSUFBSVMsY0FBQTtFQUN0QjtFQUVBLElBQUlDLGlCQUFBLEVBQW1CO0lBQ3JCLE9BQU8sS0FBS1IsaUJBQWlCO0VBQy9CO0VBRUEsSUFBSVEsaUJBQWlCQyxvQkFBQSxFQUFzQjtJQUN6QyxLQUFLVCxpQkFBaUIsSUFBSVMsb0JBQUE7RUFDNUI7RUFFT0MsZUFBQSxFQUF1QjtJQUM1QixJQUFJLEtBQUtKLFVBQUEsSUFBYyxDQUFDLEtBQUtOLGlCQUFpQixHQUFHO01BQy9DLEtBQUtBLGlCQUFpQixJQUFJO0lBQzVCO0VBQ0Y7QUFDRjtBQTlCR0YsV0FBQSxFQUNBRSxpQkFBQTtBQXFDSSxJQUFNVyxVQUFBLEdBQU4sY0FBeUJDLEtBQUEsQ0FBTTtFQUtwQ1QsWUFBWUMsSUFBQSxFQUFjQyxJQUFBLEdBQXVCLENBQUMsR0FBRztJQUNuRCxNQUFNRCxJQUFBLEVBQU1DLElBQUk7SUFDaEIsS0FBS1EsSUFBQSxHQUFPUixJQUFBLENBQUtRLElBQUEsS0FBUyxTQUFZLElBQUlSLElBQUEsQ0FBS1EsSUFBQTtJQUMvQyxLQUFLQyxNQUFBLEdBQVNULElBQUEsQ0FBS1MsTUFBQSxLQUFXLFNBQVksS0FBS1QsSUFBQSxDQUFLUyxNQUFBO0lBQ3BELEtBQUtDLFFBQUEsR0FBV1YsSUFBQSxDQUFLVSxRQUFBLEtBQWEsU0FBWSxRQUFRVixJQUFBLENBQUtVLFFBQUE7RUFDN0Q7QUFDRjtBQUVPLElBQU1DLG9CQUFBLEdBQU4sY0FBbUNMLFVBQUEsQ0FBVztFQUluRFIsWUFBWUMsSUFBQSxFQUFjQyxJQUFBLEdBQXVCLENBQUMsR0FBRztJQUNuRCxNQUFNRCxJQUFBLEVBQU1DLElBQUk7SUFDaEIsS0FBS1AsV0FBVyxJQUFJLENBQUMsQ0FBQ08sSUFBQSxDQUFLQyxVQUFBO0lBQzNCLEtBQUtOLGlCQUFpQixJQUFJO0VBQzVCO0VBRUEsSUFBSU0sV0FBQSxFQUFhO0lBQ2YsT0FBTyxLQUFLUixXQUFXO0VBQ3pCO0VBRUEsSUFBSVEsV0FBV0MsY0FBQSxFQUFnQjtJQUM3QixLQUFLVCxXQUFXLElBQUlTLGNBQUE7RUFDdEI7RUFFQSxJQUFJQyxpQkFBQSxFQUFtQjtJQUNyQixPQUFPLEtBQUtSLGlCQUFpQjtFQUMvQjtFQUVBLElBQUlRLGlCQUFpQkMsb0JBQUEsRUFBc0I7SUFDekMsS0FBS1QsaUJBQWlCLElBQUlTLG9CQUFBO0VBQzVCO0VBRU9DLGVBQUEsRUFBdUI7SUFDNUIsSUFBSSxLQUFLSixVQUFBLElBQWMsQ0FBQyxLQUFLTixpQkFBaUIsR0FBRztNQUMvQyxLQUFLQSxpQkFBaUIsSUFBSTtJQUM1QjtFQUNGO0FBQ0Y7QUE5QkdGLFdBQUEsRUFDQUUsaUJBQUE7OztBQzFESCxJQUFNaUIsUUFBQSxHQUFXbEIsTUFBQSxDQUFPLFVBQVU7QUFDbEMsSUFBTW1CLGNBQUEsR0FBaUJuQixNQUFBLENBQU8sZ0JBQWdCO0FBT3ZDLElBQWVvQixpQ0FBQSxHQUFmLE1BQWlELEVBcUJ4RDtBQU9PLElBQU1DLHlCQUFBLEdBQU4sTUFFUDtFQU1FakIsWUFDa0JrQixNQUFBLEVBQ0NDLFNBQUEsRUFDakI7SUFGZ0IsS0FBQUQsTUFBQSxHQUFBQSxNQUFBO0lBQ0MsS0FBQUMsU0FBQSxHQUFBQSxTQUFBO0lBRWpCLEtBQUtDLEVBQUEsR0FBS0MsZ0JBQWdCLENBQUFDLGVBQUEsQ0FBQUMsSUFBQTtJQUMxQixLQUFLQyxHQUFBLEdBQU0sSUFBSUMsR0FBQSxDQUFJUCxNQUFBLENBQU9NLEdBQUc7SUFDN0IsS0FBS1YsUUFBUSxJQUFJLElBQUlZLFdBQUEsQ0FBWTtJQUlqQyxLQUFLUCxTQUFBLENBQVVRLGdCQUFBLENBQWlCLFlBQWF2QyxLQUFBLElBQVU7TUFDckQsTUFBTXdDLE9BQUEsR0FBVTFDLFNBQUEsQ0FDZCxLQUFLZ0MsTUFBQSxFQUNMLElBQUlwQixzQkFBQSxDQUF1QixXQUFXO1FBQ3BDK0IsSUFBQSxFQUFNekMsS0FBQSxDQUFNeUMsSUFBQTtRQUNaQyxNQUFBLEVBQVExQyxLQUFBLENBQU0wQyxNQUFBO1FBQ2QzQixVQUFBLEVBQVk7TUFDZCxDQUFDLENBQ0g7TUFFQSxLQUFLVyxRQUFRLEVBQUVpQixhQUFBLENBQWNILE9BQU87TUFNcEMsSUFBSUEsT0FBQSxDQUFRdkIsZ0JBQUEsRUFBa0I7UUFDNUJqQixLQUFBLENBQU1tQixjQUFBLENBQWU7TUFDdkI7SUFDRixDQUFDO0lBVUQsS0FBS1ksU0FBQSxDQUFVUSxnQkFBQSxDQUFpQixTQUFVdkMsS0FBQSxJQUFVO01BQ2xELEtBQUswQixRQUFRLEVBQUVpQixhQUFBLENBQ2I3QyxTQUFBLENBQVUsS0FBS2dDLE1BQUEsRUFBUSxJQUFJVixVQUFBLENBQVcsU0FBU3BCLEtBQUssQ0FBQyxDQUN2RDtJQUNGLENBQUM7RUFDSDtFQUFBO0FBQUE7QUFBQTtFQUtPdUMsaUJBQ0wxQixJQUFBLEVBQ0ErQixRQUFBLEVBQ0FDLE9BQUEsRUFDTTtJQUNOLElBQUksQ0FBQ0MsT0FBQSxDQUFRQyxHQUFBLENBQUlILFFBQUEsRUFBVWpCLGNBQWMsR0FBRztNQUMxQyxNQUFNcUIsYUFBQSxHQUFnQkosUUFBQSxDQUFTSyxJQUFBLENBQUssS0FBS25CLE1BQU07TUFJL0M3QixNQUFBLENBQU9pRCxjQUFBLENBQWVOLFFBQUEsRUFBVWpCLGNBQUEsRUFBZ0I7UUFDOUN4QixLQUFBLEVBQU82QyxhQUFBO1FBQ1A1QyxVQUFBLEVBQVk7UUFDWitDLFlBQUEsRUFBYztNQUNoQixDQUFDO0lBQ0g7SUFFQSxLQUFLekIsUUFBUSxFQUFFYSxnQkFBQSxDQUNiMUIsSUFBQSxFQUNBaUMsT0FBQSxDQUFRTSxHQUFBLENBQUlSLFFBQUEsRUFBVWpCLGNBQWMsR0FDcENrQixPQUNGO0VBQ0Y7RUFBQTtBQUFBO0FBQUE7RUFLT1Esb0JBQ0xyRCxLQUFBLEVBQ0E0QyxRQUFBLEVBQ0FDLE9BQUEsRUFDTTtJQUNOLEtBQUtuQixRQUFRLEVBQUUyQixtQkFBQSxDQUNickQsS0FBQSxFQUNBOEMsT0FBQSxDQUFRTSxHQUFBLENBQUlSLFFBQUEsRUFBVWpCLGNBQWMsR0FDcENrQixPQUNGO0VBQ0Y7RUFBQTtBQUFBO0FBQUE7RUFLT1MsS0FBS2IsSUFBQSxFQUEyQjtJQUNyQyxLQUFLVixTQUFBLENBQVV1QixJQUFBLENBQUtiLElBQUk7RUFDMUI7RUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0VBT09jLE1BQU1qQyxJQUFBLEVBQWVDLE1BQUEsRUFBdUI7SUFDakQsS0FBS1EsU0FBQSxDQUFVd0IsS0FBQSxDQUFNakMsSUFBQSxFQUFNQyxNQUFNO0VBQ25DO0FBQ0Y7QUF6R1dHLFFBQUE7OztBQ2hEWCxJQUFBOEIsV0FBUyxHQUFBQyxPQUFBOzs7O0FDSVQsSUFBQUMsZ0JBQVMsR0FBQUQsT0FBQSwrQkFBdUI7QUFNaEMsSUFBTUUsZ0NBQUEsR0FDSjtBQUVLLElBQU1DLG1CQUFBLEdBQXNCcEQsTUFBQSxDQUFPLHFCQUFxQjtBQUN4RCxJQUFNcUQsT0FBQSxHQUFVckQsTUFBQSxDQUFPLFNBQVM7QUFDaEMsSUFBTXNELE1BQUEsR0FBU3RELE1BQUEsQ0FBTyxRQUFRO0FBRTlCLElBQU11RCxpQkFBQSxHQUFOLGNBQWdDekIsV0FBQSxDQUFpQztFQTJCdEUxQixZQUFZd0IsR0FBQSxFQUFtQjRCLFNBQUEsRUFBb0M7SUFDakUsTUFBTTtJQXZCUixLQUFTQyxVQUFBLEdBQWE7SUFDdEIsS0FBU0MsSUFBQSxHQUFPO0lBQ2hCLEtBQVNDLE9BQUEsR0FBVTtJQUNuQixLQUFTQyxNQUFBLEdBQVM7SUFTbEIsS0FBUUMsT0FBQSxHQUF5QztJQUNqRCxLQUFRQyxVQUFBLEdBRUc7SUFDWCxLQUFRQyxRQUFBLEdBQTBDO0lBQ2xELEtBQVFDLFFBQUEsR0FBc0Q7SUFPNUQsS0FBS3BDLEdBQUEsR0FBTUEsR0FBQSxDQUFJcUMsUUFBQSxDQUFTO0lBQ3hCLEtBQUtDLFFBQUEsR0FBVztJQUNoQixLQUFLQyxVQUFBLEdBQWE7SUFDbEIsS0FBS0MsVUFBQSxHQUFhO0lBQ2xCLEtBQUtDLFVBQUEsR0FBYSxLQUFLWixVQUFBO0lBQ3ZCLEtBQUthLGNBQUEsR0FBaUI7SUFFdEIsS0FBS2xCLG1CQUFtQixJQUFJLEtBQUksR0FBQUYsZ0JBQXlCLENBQUFxQixlQUFBO0lBRXpEQyxjQUFBLENBQWUsWUFBWTtNQUN6QixJQUFJLE1BQU0sS0FBS3BCLG1CQUFtQixHQUFHO1FBQ25DO01BQ0Y7TUFFQSxLQUFLYyxRQUFBLEdBQ0gsT0FBT1YsU0FBQSxLQUFjLFdBQ2pCQSxTQUFBLEdBQ0FpQixLQUFBLENBQU1DLE9BQUEsQ0FBUWxCLFNBQVMsS0FBS0EsU0FBQSxDQUFVbUIsTUFBQSxHQUFTLElBQy9DbkIsU0FBQSxDQUFVLENBQUMsSUFDWDtNQU9OLElBQUksS0FBS2EsVUFBQSxLQUFlLEtBQUtaLFVBQUEsRUFBWTtRQUN2QyxLQUFLWSxVQUFBLEdBQWEsS0FBS1gsSUFBQTtRQUN2QixLQUFLdkIsYUFBQSxDQUFjN0MsU0FBQSxDQUFVLE1BQU0sSUFBSXVCLEtBQUEsQ0FBTSxNQUFNLENBQUMsQ0FBQztNQUN2RDtJQUNGLENBQUM7RUFDSDtFQUVBLElBQUkrRCxPQUFPeEMsUUFBQSxFQUF5QztJQUNsRCxLQUFLUyxtQkFBQSxDQUFvQixRQUFRLEtBQUtnQixPQUFPO0lBQzdDLEtBQUtBLE9BQUEsR0FBVXpCLFFBQUE7SUFDZixJQUFJQSxRQUFBLEtBQWEsTUFBTTtNQUNyQixLQUFLTCxnQkFBQSxDQUFpQixRQUFRSyxRQUFRO0lBQ3hDO0VBQ0Y7RUFDQSxJQUFJd0MsT0FBQSxFQUF3QztJQUMxQyxPQUFPLEtBQUtmLE9BQUE7RUFDZDtFQUVBLElBQUlnQixVQUNGekMsUUFBQSxFQUNBO0lBQ0EsS0FBS1MsbUJBQUEsQ0FDSCxXQUNBLEtBQUtpQixVQUNQO0lBQ0EsS0FBS0EsVUFBQSxHQUFhMUIsUUFBQTtJQUNsQixJQUFJQSxRQUFBLEtBQWEsTUFBTTtNQUNyQixLQUFLTCxnQkFBQSxDQUFpQixXQUFXSyxRQUFRO0lBQzNDO0VBQ0Y7RUFDQSxJQUFJeUMsVUFBQSxFQUF3RTtJQUMxRSxPQUFPLEtBQUtmLFVBQUE7RUFDZDtFQUVBLElBQUlnQixRQUFRMUMsUUFBQSxFQUF5QztJQUNuRCxLQUFLUyxtQkFBQSxDQUFvQixTQUFTLEtBQUtrQixRQUFRO0lBQy9DLEtBQUtBLFFBQUEsR0FBVzNCLFFBQUE7SUFDaEIsSUFBSUEsUUFBQSxLQUFhLE1BQU07TUFDckIsS0FBS0wsZ0JBQUEsQ0FBaUIsU0FBU0ssUUFBUTtJQUN6QztFQUNGO0VBQ0EsSUFBSTBDLFFBQUEsRUFBeUM7SUFDM0MsT0FBTyxLQUFLZixRQUFBO0VBQ2Q7RUFFQSxJQUFJZ0IsUUFBUTNDLFFBQUEsRUFBcUQ7SUFDL0QsS0FBS1MsbUJBQUEsQ0FBb0IsU0FBUyxLQUFLbUIsUUFBa0M7SUFDekUsS0FBS0EsUUFBQSxHQUFXNUIsUUFBQTtJQUNoQixJQUFJQSxRQUFBLEtBQWEsTUFBTTtNQUNyQixLQUFLTCxnQkFBQSxDQUFpQixTQUFTSyxRQUFRO0lBQ3pDO0VBQ0Y7RUFDQSxJQUFJMkMsUUFBQSxFQUFxRDtJQUN2RCxPQUFPLEtBQUtmLFFBQUE7RUFDZDtFQUFBO0FBQUE7QUFBQTtFQUtPbEIsS0FBS2IsSUFBQSxFQUEyQjtJQUNyQyxJQUFJLEtBQUtvQyxVQUFBLEtBQWUsS0FBS1osVUFBQSxFQUFZO01BQ3ZDLEtBQUtWLEtBQUEsQ0FBTTtNQUNYLE1BQU0sSUFBSWlDLFlBQUEsQ0FBYSxtQkFBbUI7SUFDNUM7SUFJQSxJQUFJLEtBQUtYLFVBQUEsS0FBZSxLQUFLVixPQUFBLElBQVcsS0FBS1UsVUFBQSxLQUFlLEtBQUtULE1BQUEsRUFBUTtNQUN2RTtJQUNGO0lBSUEsS0FBS1UsY0FBQSxJQUFrQlcsV0FBQSxDQUFZaEQsSUFBSTtJQUV2Q3VDLGNBQUEsQ0FBZSxNQUFNO01Bbkp6QixJQUFBVSxFQUFBO01Bc0pNLEtBQUtaLGNBQUEsR0FBaUI7TUFPdEIsQ0FBQVksRUFBQSxRQUFLN0IsT0FBQSxNQUFMLGdCQUFBNkIsRUFBQSxDQUFBdkQsSUFBQSxPQUFnQk0sSUFBQTtJQUNsQixDQUFDO0VBQ0g7RUFFT2MsTUFBTWpDLElBQUEsR0FBZSxLQUFNQyxNQUFBLEVBQXVCO0lBQ3ZEaUMsV0FBVSxDQUFBbUMsU0FBTSxDQUFBeEQsSUFBQSxTQUFBYixJQUFBLEVBQUFxQyxnQ0FBZ0M7SUFDaERILFdBQUEsQ0FBQW1DLFNBQUEsQ0FBQXhELElBQUEsU0FDRWIsSUFBQSxLQUFTLE9BQVNBLElBQUEsSUFBUSxPQUFRQSxJQUFBLElBQVEsTUFDMUNxQyxnQ0FDRjtJQUVBLEtBQUtHLE1BQU0sRUFBRXhDLElBQUEsRUFBTUMsTUFBTTtFQUMzQjtFQUVBLEVBbElTcUMsbUJBQUEsRUFDQUMsT0FBQSxFQWlJQUMsTUFBQSxHQUNQeEMsSUFBQSxHQUFlLEtBQ2ZDLE1BQUEsRUFDQUMsUUFBQSxHQUFXLE1BQ0w7SUFNTixJQUFJLEtBQUtxRCxVQUFBLEtBQWUsS0FBS1YsT0FBQSxJQUFXLEtBQUtVLFVBQUEsS0FBZSxLQUFLVCxNQUFBLEVBQVE7TUFDdkU7SUFDRjtJQUVBLEtBQUtTLFVBQUEsR0FBYSxLQUFLVixPQUFBO0lBRXZCYSxjQUFBLENBQWUsTUFBTTtNQUNuQixLQUFLSCxVQUFBLEdBQWEsS0FBS1QsTUFBQTtNQUV2QixLQUFLekIsYUFBQSxDQUNIN0MsU0FBQSxDQUNFLE1BQ0EsSUFBSXNCLFVBQUEsQ0FBVyxTQUFTO1FBQ3RCRSxJQUFBO1FBQ0FDLE1BQUE7UUFDQUM7TUFDRixDQUFDLENBQ0gsQ0FDRjtNQUdBLEtBQUs2QyxPQUFBLEdBQVU7TUFDZixLQUFLQyxVQUFBLEdBQWE7TUFDbEIsS0FBS0MsUUFBQSxHQUFXO01BQ2hCLEtBQUtDLFFBQUEsR0FBVztJQUNsQixDQUFDO0VBQ0g7RUFZT2pDLGlCQUNMMUIsSUFBQSxFQUNBK0IsUUFBQSxFQUNBQyxPQUFBLEVBQ007SUFDTixPQUFPLE1BQU1OLGdCQUFBLENBQ1gxQixJQUFBLEVBQ0ErQixRQUFBLEVBQ0FDLE9BQ0Y7RUFDRjtFQUVBUSxvQkFDRXhDLElBQUEsRUFDQStFLFFBQUEsRUFDQS9DLE9BQUEsRUFDTTtJQUNOLE9BQU8sTUFBTVEsbUJBQUEsQ0FBb0J4QyxJQUFBLEVBQU0rRSxRQUFBLEVBQVUvQyxPQUFPO0VBQzFEO0FBQ0Y7QUE3TmFrQixpQkFBQSxDQUNLRSxVQUFBLEdBQWE7QUFEbEJGLGlCQUFBLENBRUtHLElBQUEsR0FBTztBQUZaSCxpQkFBQSxDQUdLSSxPQUFBLEdBQVU7QUFIZkosaUJBQUEsQ0FJS0ssTUFBQSxHQUFTO0FBMk4zQixTQUFTcUIsWUFBWWhELElBQUEsRUFBNkI7RUFDaEQsSUFBSSxPQUFPQSxJQUFBLEtBQVMsVUFBVTtJQUM1QixPQUFPQSxJQUFBLENBQUswQyxNQUFBO0VBQ2Q7RUFFQSxJQUFJMUMsSUFBQSxZQUFnQm9ELElBQUEsRUFBTTtJQUN4QixPQUFPcEQsSUFBQSxDQUFLcUQsSUFBQTtFQUNkO0VBRUEsT0FBT3JELElBQUEsQ0FBS3NELFVBQUE7QUFDZDs7O0FEM09BLElBQU1DLFNBQUEsR0FBV3hGLE1BQUEsQ0FBTyxVQUFVO0FBQ2xDLElBQU15RixlQUFBLEdBQWlCekYsTUFBQSxDQUFPLGdCQUFnQjtBQUM5QyxJQUFNMEYsS0FBQSxHQUFRMUYsTUFBQSxDQUFPLE9BQU87QUFTckIsSUFBZTJGLGlDQUFBLEdBQWYsTUFBaUQsRUFvQnhEO0FBT08sSUFBTUMseUJBQUEsR0FBTixNQUVQO0VBU0V4RixZQUNtQnlGLE1BQUEsRUFDQXRFLFNBQUEsRUFDQXVFLGdCQUFBLEVBQ2pCO0lBSGlCLEtBQUFELE1BQUEsR0FBQUEsTUFBQTtJQUNBLEtBQUF0RSxTQUFBLEdBQUFBLFNBQUE7SUFDQSxLQUFBdUUsZ0JBQUEsR0FBQUEsZ0JBQUE7SUFFakIsS0FBS04sU0FBUSxJQUFJLElBQUkxRCxXQUFBLENBQVk7SUFDakMsS0FBS2lFLG1CQUFBLEdBQXNCLElBQUlDLGVBQUEsQ0FBZ0I7SUFDL0MsS0FBS0MsbUJBQUEsR0FBc0IsSUFBSUQsZUFBQSxDQUFnQjtJQU0vQyxLQUFLekUsU0FBQSxDQUFVUSxnQkFBQSxDQUFpQixZQUFhdkMsS0FBQSxJQUFVO01BR3JELElBQUksT0FBTyxLQUFLMEcsYUFBQSxLQUFrQixhQUFhO1FBQzdDO01BQ0Y7TUFNQTFCLGNBQUEsQ0FBZSxNQUFNO1FBQ25CLElBQUksQ0FBQ2hGLEtBQUEsQ0FBTWlCLGdCQUFBLEVBQWtCO1VBTTNCLEtBQUtpRixLQUFLLEVBQUVsRyxLQUFBLENBQU15QyxJQUFJO1FBQ3hCO01BQ0YsQ0FBQztJQUNILENBQUM7SUFFRCxLQUFLVixTQUFBLENBQVVRLGdCQUFBLENBQ2IsWUFDQSxLQUFLb0UscUJBQUEsQ0FBc0IxRCxJQUFBLENBQUssSUFBSSxDQUN0QztFQUNGO0VBQUE7QUFBQTtBQUFBO0FBQUE7RUFNQSxJQUFXbkIsT0FBQSxFQUFvQjtJQUM3QjBCLFdBQUEsQ0FBQW1DLFNBQUEsQ0FBQXhELElBQUEsU0FDRSxLQUFLdUUsYUFBQSxFQUNMLHdJQUNGO0lBRUEsT0FBTyxLQUFLQSxhQUFBO0VBQ2Q7RUFBQTtBQUFBO0FBQUE7RUFLT0UsUUFBQSxFQUFnQjtJQUNyQnBELFdBQUEsQ0FBQW1DLFNBQUEsQ0FBQXhELElBQUEsU0FDRSxDQUFDLEtBQUt1RSxhQUFBLElBQWlCLEtBQUtBLGFBQUEsQ0FBYzdCLFVBQUEsS0FBZWdDLFNBQUEsQ0FBVTNDLElBQUEsRUFDbkUsNEZBQ0Y7SUFFQSxNQUFNd0MsYUFBQSxHQUFnQixLQUFLSixnQkFBQSxDQUFpQjtJQUc1Q0ksYUFBQSxDQUFjOUIsVUFBQSxHQUFhLEtBQUt5QixNQUFBLENBQU96QixVQUFBO0lBS3ZDOEIsYUFBQSxDQUFjbkUsZ0JBQUEsQ0FDWixRQUNDdkMsS0FBQSxJQUFVO01BQ1QsS0FBS2dHLFNBQVEsRUFBRXJELGFBQUEsQ0FDYjdDLFNBQUEsQ0FBVSxLQUFLNEcsYUFBQSxFQUFnQixJQUFJckYsS0FBQSxDQUFNLFFBQVFyQixLQUFLLENBQUMsQ0FDekQ7SUFDRixHQUNBO01BQUU4RyxJQUFBLEVBQU07SUFBSyxDQUNmO0lBRUFKLGFBQUEsQ0FBY25FLGdCQUFBLENBQWlCLFdBQVl2QyxLQUFBLElBQVU7TUFLbkQsS0FBSytCLFNBQUEsQ0FBVVksYUFBQSxDQUNiN0MsU0FBQSxDQUNFLEtBQUs0RyxhQUFBLEVBQ0wsSUFBSS9GLFlBQUEsQ0FBYSxZQUFZO1FBQzNCOEIsSUFBQSxFQUFNekMsS0FBQSxDQUFNeUMsSUFBQTtRQUNaQyxNQUFBLEVBQVExQyxLQUFBLENBQU0wQztNQUNoQixDQUFDLENBQ0gsQ0FDRjtJQUNGLENBQUM7SUFJRCxLQUFLMkQsTUFBQSxDQUFPOUQsZ0JBQUEsQ0FDVixTQUNDdkMsS0FBQSxJQUFVO01BQ1QsS0FBSytHLGVBQUEsQ0FBZ0IvRyxLQUFLO0lBQzVCLEdBQ0E7TUFDRWdILE1BQUEsRUFBUSxLQUFLVCxtQkFBQSxDQUFvQlM7SUFDbkMsQ0FDRjtJQUlBTixhQUFBLENBQWNuRSxnQkFBQSxDQUNaLFNBQ0N2QyxLQUFBLElBQVU7TUFDVCxLQUFLaUgsZUFBQSxDQUFnQmpILEtBQUs7SUFDNUIsR0FDQTtNQUNFZ0gsTUFBQSxFQUFRLEtBQUtQLG1CQUFBLENBQW9CTztJQUNuQyxDQUNGO0lBRUFOLGFBQUEsQ0FBY25FLGdCQUFBLENBQWlCLFNBQVMsTUFBTTtNQUM1QyxNQUFNMkUsVUFBQSxHQUFhcEgsU0FBQSxDQUNqQjRHLGFBQUEsRUFDQSxJQUFJckYsS0FBQSxDQUFNLFNBQVM7UUFBRU4sVUFBQSxFQUFZO01BQUssQ0FBQyxDQUN6QztNQUlBLEtBQUtpRixTQUFRLEVBQUVyRCxhQUFBLENBQWN1RSxVQUFVO01BSXZDLElBQUksQ0FBQ0EsVUFBQSxDQUFXakcsZ0JBQUEsRUFBa0I7UUFDaEMsS0FBS29GLE1BQUEsQ0FBTzFELGFBQUEsQ0FBYzdDLFNBQUEsQ0FBVSxLQUFLdUcsTUFBQSxFQUFRLElBQUloRixLQUFBLENBQU0sT0FBTyxDQUFDLENBQUM7TUFDdEU7SUFDRixDQUFDO0lBRUQsS0FBS3FGLGFBQUEsR0FBZ0JBLGFBQUE7RUFDdkI7RUFBQTtBQUFBO0FBQUE7RUFLT25FLGlCQUNMdkMsS0FBQSxFQUNBNEMsUUFBQSxFQUNBQyxPQUFBLEVBQ007SUFDTixJQUFJLENBQUNDLE9BQUEsQ0FBUUMsR0FBQSxDQUFJSCxRQUFBLEVBQVVxRCxlQUFjLEdBQUc7TUFDMUMsTUFBTWpELGFBQUEsR0FBZ0JKLFFBQUEsQ0FBU0ssSUFBQSxDQUFLLEtBQUtvRCxNQUFNO01BSS9DcEcsTUFBQSxDQUFPaUQsY0FBQSxDQUFlTixRQUFBLEVBQVVxRCxlQUFBLEVBQWdCO1FBQzlDOUYsS0FBQSxFQUFPNkMsYUFBQTtRQUNQNUMsVUFBQSxFQUFZO01BQ2QsQ0FBQztJQUNIO0lBRUEsS0FBSzRGLFNBQVEsRUFBRXpELGdCQUFBLENBQ2J2QyxLQUFBLEVBQ0E4QyxPQUFBLENBQVFNLEdBQUEsQ0FBSVIsUUFBQSxFQUFVcUQsZUFBYyxHQUNwQ3BELE9BQ0Y7RUFDRjtFQUFBO0FBQUE7QUFBQTtFQUtPUSxvQkFDTHJELEtBQUEsRUFDQTRDLFFBQUEsRUFDQUMsT0FBQSxFQUNNO0lBQ04sS0FBS21ELFNBQVEsRUFBRTNDLG1CQUFBLENBQ2JyRCxLQUFBLEVBQ0E4QyxPQUFBLENBQVFNLEdBQUEsQ0FBSVIsUUFBQSxFQUFVcUQsZUFBYyxHQUNwQ3BELE9BQ0Y7RUFDRjtFQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0VBU09TLEtBQUtiLElBQUEsRUFBMkI7SUFDckMsS0FBS3lELEtBQUssRUFBRXpELElBQUk7RUFDbEI7RUFFQSxFQXBNU3VELFNBQUEsRUFvTUFFLEtBQUEsR0FBT3pELElBQUEsRUFBMkI7SUFDekMsTUFBTTtNQUFFaUU7SUFBYyxJQUFJO0lBRTFCbEQsV0FBQSxDQUFBbUMsU0FBQSxDQUFBeEQsSUFBQSxTQUNFdUUsYUFBQSxFQUNBLG1IQUNBLEtBQUtMLE1BQUEsQ0FBT2pFLEdBQ2Q7SUFHQSxJQUNFc0UsYUFBQSxDQUFjN0IsVUFBQSxLQUFlZ0MsU0FBQSxDQUFVMUMsT0FBQSxJQUN2Q3VDLGFBQUEsQ0FBYzdCLFVBQUEsS0FBZWdDLFNBQUEsQ0FBVXpDLE1BQUEsRUFDdkM7TUFDQTtJQUNGO0lBS0EsSUFBSXNDLGFBQUEsQ0FBYzdCLFVBQUEsS0FBZWdDLFNBQUEsQ0FBVTVDLFVBQUEsRUFBWTtNQUNyRHlDLGFBQUEsQ0FBY25FLGdCQUFBLENBQ1osUUFDQSxNQUFNO1FBQ0ptRSxhQUFBLENBQWNwRCxJQUFBLENBQUtiLElBQUk7TUFDekIsR0FDQTtRQUFFcUUsSUFBQSxFQUFNO01BQUssQ0FDZjtNQUNBO0lBQ0Y7SUFHQUosYUFBQSxDQUFjcEQsSUFBQSxDQUFLYixJQUFJO0VBQ3pCO0VBQUE7QUFBQTtBQUFBO0VBS09jLE1BQUEsRUFBYztJQUNuQixNQUFNO01BQUVtRDtJQUFjLElBQUk7SUFFMUJsRCxXQUFBLENBQUFtQyxTQUFBLENBQUF4RCxJQUFBLFNBQ0V1RSxhQUFBLEVBQ0Esc0hBQ0EsS0FBS0wsTUFBQSxDQUFPakUsR0FDZDtJQU1BLEtBQUtxRSxtQkFBQSxDQUFvQlUsS0FBQSxDQUFNO0lBRS9CLElBQ0VULGFBQUEsQ0FBYzdCLFVBQUEsS0FBZWdDLFNBQUEsQ0FBVTFDLE9BQUEsSUFDdkN1QyxhQUFBLENBQWM3QixVQUFBLEtBQWVnQyxTQUFBLENBQVV6QyxNQUFBLEVBQ3ZDO01BQ0E7SUFDRjtJQUdBc0MsYUFBQSxDQUFjbkQsS0FBQSxDQUFNO0lBR3BCeUIsY0FBQSxDQUFlLE1BQU07TUFDbkIsS0FBS2dCLFNBQVEsRUFBRXJELGFBQUEsQ0FDYjdDLFNBQUEsQ0FDRSxLQUFLNEcsYUFBQSxFQUNMLElBQUlqRixvQkFBQSxDQUFxQixTQUFTO1FBQUE7QUFBQTtBQUFBO0FBQUE7UUFLaENILElBQUEsRUFBTTtRQUNOUCxVQUFBLEVBQVk7TUFDZCxDQUFDLENBQ0gsQ0FDRjtJQUNGLENBQUM7RUFDSDtFQUVRNEYsc0JBQXNCM0csS0FBQSxFQUEwQztJQUt0RSxNQUFNb0gsWUFBQSxHQUFldEgsU0FBQSxDQUNuQkUsS0FBQSxDQUFNRCxNQUFBLEVBQ04sSUFBSVcsc0JBQUEsQ0FBdUIsV0FBVztNQUNwQytCLElBQUEsRUFBTXpDLEtBQUEsQ0FBTXlDLElBQUE7TUFDWkMsTUFBQSxFQUFRMUMsS0FBQSxDQUFNMEMsTUFBQTtNQUNkM0IsVUFBQSxFQUFZO0lBQ2QsQ0FBQyxDQUNIO0lBU0EsS0FBS2lGLFNBQVEsRUFBRXJELGFBQUEsQ0FBY3lFLFlBQVk7SUFNekMsSUFBSSxDQUFDQSxZQUFBLENBQWFuRyxnQkFBQSxFQUFrQjtNQUNsQyxLQUFLb0YsTUFBQSxDQUFPMUQsYUFBQSxDQUNWN0MsU0FBQTtNQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7TUFNRSxLQUFLdUcsTUFBQTtNQUFBO01BQUE7TUFHTCxJQUFJMUYsWUFBQSxDQUFhLFdBQVc7UUFDMUI4QixJQUFBLEVBQU16QyxLQUFBLENBQU15QyxJQUFBO1FBQ1pDLE1BQUEsRUFBUTFDLEtBQUEsQ0FBTTBDO01BQ2hCLENBQUMsQ0FDSCxDQUNGO0lBQ0Y7RUFDRjtFQUVRcUUsZ0JBQWdCTSxNQUFBLEVBQXFCO0lBRTNDLElBQUksS0FBS1gsYUFBQSxFQUFlO01BQ3RCLEtBQUtBLGFBQUEsQ0FBY25ELEtBQUEsQ0FBTTtJQUMzQjtFQUNGO0VBRVEwRCxnQkFBZ0JqSCxLQUFBLEVBQXlCO0lBSS9DLEtBQUt1RyxtQkFBQSxDQUFvQlksS0FBQSxDQUFNO0lBRS9CLE1BQU1HLFVBQUEsR0FBYXhILFNBQUEsQ0FDakIsS0FBSzRHLGFBQUEsRUFDTCxJQUFJakYsb0JBQUEsQ0FBcUIsU0FBUztNQUNoQ0gsSUFBQSxFQUFNdEIsS0FBQSxDQUFNc0IsSUFBQTtNQUNaQyxNQUFBLEVBQVF2QixLQUFBLENBQU11QixNQUFBO01BQ2RDLFFBQUEsRUFBVXhCLEtBQUEsQ0FBTXdCLFFBQUE7TUFDaEJULFVBQUEsRUFBWTtJQUNkLENBQUMsQ0FDSDtJQUVBLEtBQUtpRixTQUFRLEVBQUVyRCxhQUFBLENBQWMyRSxVQUFVO0lBSXZDLElBQUksQ0FBQ0EsVUFBQSxDQUFXckcsZ0JBQUEsRUFBa0I7TUFLaEMsS0FBS29GLE1BQUEsQ0FBT3ZDLE1BQU0sRUFBRTlELEtBQUEsQ0FBTXNCLElBQUEsRUFBTXRCLEtBQUEsQ0FBTXVCLE1BQU07SUFDOUM7RUFDRjtBQUNGOzs7QUV2Wk8sSUFBTWdHLHVCQUFBLEdBQU4sY0FDR2pGLFdBQUEsQ0FFVjtFQUNFMUIsWUFBK0JrQixNQUFBLEVBQTJCO0lBQ3hELE1BQU07SUFEdUIsS0FBQUEsTUFBQSxHQUFBQSxNQUFBO0lBTTdCLEtBQUtBLE1BQUEsQ0FBT1MsZ0JBQUEsQ0FBaUIsU0FBVXZDLEtBQUEsSUFBVTtNQUMvQyxLQUFLMkMsYUFBQSxDQUFjN0MsU0FBQSxDQUFVLEtBQUtnQyxNQUFBLEVBQVEsSUFBSVYsVUFBQSxDQUFXLFNBQVNwQixLQUFLLENBQUMsQ0FBQztJQUMzRSxDQUFDO0lBTUQsS0FBSzhCLE1BQUEsQ0FBTytCLE9BQU8sSUFBS3BCLElBQUEsSUFBUztNQUMvQixLQUFLRSxhQUFBLENBQ0g3QyxTQUFBLENBQ0UsS0FBS2dDLE1BQUE7TUFBQTtNQUFBO01BR0wsSUFBSXBCLHNCQUFBLENBQXVCLFlBQVk7UUFDckMrQixJQUFBO1FBQ0FDLE1BQUEsRUFBUSxLQUFLWixNQUFBLENBQU9NLEdBQUE7UUFDcEJyQixVQUFBLEVBQVk7TUFDZCxDQUFDLENBQ0gsQ0FDRjtJQUNGO0VBQ0Y7RUFFT3dCLGlCQUNMMUIsSUFBQSxFQUNBK0UsUUFBQSxFQUdBL0MsT0FBQSxFQUNNO0lBQ04sT0FBTyxNQUFNTixnQkFBQSxDQUFpQjFCLElBQUEsRUFBTStFLFFBQUEsRUFBMkIvQyxPQUFPO0VBQ3hFO0VBRU9GLGNBQ0wzQyxLQUFBLEVBQ1M7SUFDVCxPQUFPLE1BQU0yQyxhQUFBLENBQWMzQyxLQUFLO0VBQ2xDO0VBRU9zRCxLQUFLYixJQUFBLEVBQTJCO0lBQ3JDdUMsY0FBQSxDQUFlLE1BQU07TUFDbkIsSUFDRSxLQUFLbEQsTUFBQSxDQUFPK0MsVUFBQSxLQUFlLEtBQUsvQyxNQUFBLENBQU9xQyxPQUFBLElBQ3ZDLEtBQUtyQyxNQUFBLENBQU8rQyxVQUFBLEtBQWUsS0FBSy9DLE1BQUEsQ0FBT3NDLE1BQUEsRUFDdkM7UUFDQTtNQUNGO01BRUEsTUFBTXpCLGFBQUEsR0FBZ0JBLENBQUEsS0FBTTtRQUMxQixLQUFLYixNQUFBLENBQU9hLGFBQUEsQ0FDVjdDLFNBQUE7UUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO0FBQUE7QUFBQTtBQUFBO1FBU0UsS0FBS2dDLE1BQUEsRUFDTCxJQUFJbkIsWUFBQSxDQUFhLFdBQVc7VUFDMUI4QixJQUFBO1VBQ0FDLE1BQUEsRUFBUSxLQUFLWixNQUFBLENBQU9NO1FBQ3RCLENBQUMsQ0FDSCxDQUNGO01BQ0Y7TUFFQSxJQUFJLEtBQUtOLE1BQUEsQ0FBTytDLFVBQUEsS0FBZSxLQUFLL0MsTUFBQSxDQUFPbUMsVUFBQSxFQUFZO1FBQ3JELEtBQUtuQyxNQUFBLENBQU9TLGdCQUFBLENBQ1YsUUFDQSxNQUFNO1VBQ0pJLGFBQUEsQ0FBYztRQUNoQixHQUNBO1VBQUVtRSxJQUFBLEVBQU07UUFBSyxDQUNmO01BQ0YsT0FBTztRQUNMbkUsYUFBQSxDQUFjO01BQ2hCO0lBQ0YsQ0FBQztFQUNIO0VBRU9ZLE1BQU1qQyxJQUFBLEVBQWNDLE1BQUEsRUFBdUI7SUFNaEQsS0FBS08sTUFBQSxDQUFPZ0MsTUFBTSxFQUFFeEMsSUFBQSxFQUFNQyxNQUFNO0VBQ2xDO0FBQ0Y7OztBQ2hETyxJQUFNaUcscUJBQUEsR0FBTixjQUFtQ3ZGLGdCQUErQixDQUFBd0YsV0FBQTtFQUd2RTdHLFlBQUEsRUFBYztJQUNaLE1BQU00RyxxQkFBQSxDQUFxQkUsTUFBTTtFQUNuQztFQUVVQyxpQkFBQSxFQUE0QjtJQUNwQyxPQUFPQyxnQkFBQSxDQUFBQyxxQkFBaUMsQ0FBQTFGLElBQUE7RUFDMUM7RUFFVTJGLE1BQUEsRUFBYztJQUN0QixNQUFNQywyQkFBQSxHQUE4QjlILE1BQUEsQ0FBTytILHdCQUFBLENBQ3pDQyxVQUFBLEVBQ0EsV0FDRjtJQUVBLE1BQU1DLGNBQUEsR0FBaUIsSUFBSUMsS0FBQSxDQUFNRixVQUFBLENBQVdwQixTQUFBLEVBQVc7TUFDckR1QixTQUFBLEVBQVdBLENBQ1RySSxNQUFBLEVBQ0FzSSxJQUFBLEVBQ0FDLFNBQUEsS0FDRztRQUNILE1BQU0sQ0FBQ2xHLEdBQUEsRUFBSzRCLFNBQVMsSUFBSXFFLElBQUE7UUFFekIsTUFBTS9CLGdCQUFBLEdBQW1CQSxDQUFBLEtBQWlCO1VBQ3hDLE9BQU94RCxPQUFBLENBQVFzRixTQUFBLENBQVVySSxNQUFBLEVBQVFzSSxJQUFBLEVBQU1DLFNBQVM7UUFDbEQ7UUFLQSxNQUFNeEcsTUFBQSxHQUFTLElBQUlpQyxpQkFBQSxDQUFrQjNCLEdBQUEsRUFBSzRCLFNBQVM7UUFDbkQsTUFBTWpDLFNBQUEsR0FBWSxJQUFJd0YsdUJBQUEsQ0FBd0J6RixNQUFNO1FBS3BEa0QsY0FBQSxDQUFlLFlBQVk7VUFDekIsSUFBSTtZQUNGLE1BQU11RCxNQUFBLEdBQVMsSUFBSW5DLHlCQUFBLENBQ2pCdEUsTUFBQSxFQUNBQyxTQUFBLEVBQ0F1RSxnQkFDRjtZQUVBLE1BQU1rQyxzQkFBQSxHQUNKLEtBQUtDLE9BQUEsQ0FBUUMsYUFBQSxDQUFjLFlBQVksSUFBSTtZQUs3QyxNQUFNZCxnQkFBZSxDQUFBZSxTQUFTLENBQUF4RyxJQUFBLE9BQWMsT0FBQXNHLE9BQUE7Y0FDMUNwQyxNQUFBLEVBQVEsSUFBSXhFLHlCQUFBLENBQTBCQyxNQUFBLEVBQVFDLFNBQVM7Y0FDdkR3RyxNQUFBO2NBQ0FLLElBQUEsRUFBTTtnQkFDSjVFO2NBQ0Y7WUFDRixDQUFDO1lBRUQsSUFBSXdFLHNCQUFBLEVBQXdCO2NBQzFCMUcsTUFBQSxDQUFPOEIsbUJBQW1CLEVBQUVpRixPQUFBLENBQVEsS0FBSztZQUMzQyxPQUFPO2NBQ0wvRyxNQUFBLENBQU84QixtQkFBbUIsRUFBRWlGLE9BQUEsQ0FBUSxJQUFJO2NBRXhDTixNQUFBLENBQU8zQixPQUFBLENBQVE7Y0FJZjJCLE1BQUEsQ0FBT2hHLGdCQUFBLENBQWlCLFFBQVEsTUFBTTtnQkFDcENULE1BQUEsQ0FBT2EsYUFBQSxDQUFjN0MsU0FBQSxDQUFVZ0MsTUFBQSxFQUFRLElBQUlULEtBQUEsQ0FBTSxNQUFNLENBQUMsQ0FBQztnQkFJekQsSUFBSWtILE1BQUEsQ0FBTyxlQUFlLEdBQUc7a0JBQzNCekcsTUFBQSxDQUFPNEMsUUFBQSxHQUFXNkQsTUFBQSxDQUFPLGVBQWUsRUFBRTdELFFBQUE7Z0JBQzVDO2NBQ0YsQ0FBQztZQUNIO1VBQ0YsU0FBU29FLEtBQUEsRUFBUDtZQU9BLElBQUlBLEtBQUEsWUFBaUJDLEtBQUEsRUFBTztjQUMxQmpILE1BQUEsQ0FBT2EsYUFBQSxDQUFjLElBQUl0QixLQUFBLENBQU0sT0FBTyxDQUFDO2NBSXZDLElBQ0VTLE1BQUEsQ0FBTytDLFVBQUEsS0FBZWdDLFNBQUEsQ0FBVTFDLE9BQUEsSUFDaENyQyxNQUFBLENBQU8rQyxVQUFBLEtBQWVnQyxTQUFBLENBQVV6QyxNQUFBLEVBQ2hDO2dCQUNBdEMsTUFBQSxDQUFPZ0MsTUFBTSxFQUFFLE1BQU1nRixLQUFBLENBQU10RyxPQUFBLEVBQVMsS0FBSztjQUMzQztjQUVBd0csT0FBQSxDQUFRRixLQUFBLENBQU1BLEtBQUs7WUFDckI7VUFDRjtRQUNGLENBQUM7UUFFRCxPQUFPaEgsTUFBQTtNQUNUO0lBQ0YsQ0FBQztJQUVEN0IsTUFBQSxDQUFPaUQsY0FBQSxDQUFlK0UsVUFBQSxFQUFZLGFBQWE7TUFDN0M5SCxLQUFBLEVBQU8rSCxjQUFBO01BQ1AvRSxZQUFBLEVBQWM7SUFDaEIsQ0FBQztJQUVELEtBQUs4RixhQUFBLENBQWNDLElBQUEsQ0FBSyxNQUFNO01BQzVCakosTUFBQSxDQUFPaUQsY0FBQSxDQUNMK0UsVUFBQSxFQUNBLGFBQ0FGLDJCQUNGO0lBQ0YsQ0FBQztFQUNIO0FBQ0Y7QUF4SE8sSUFBTW9CLG9CQUFBLEdBQU4zQixxQkFBQTtBQUFNMkIsb0JBQUEsQ0FDSnpCLE1BQUEsR0FBU2xILE1BQUEsQ0FBTyxXQUFXIiwiaWdub3JlTGlzdCI6W119