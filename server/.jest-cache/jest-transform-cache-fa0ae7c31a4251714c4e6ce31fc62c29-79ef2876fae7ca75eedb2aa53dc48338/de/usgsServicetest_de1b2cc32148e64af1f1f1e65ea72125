71c33ed68bfa931a1a1d603366f2db6d
"use strict";

// Mock the SeismicIntegration
_getJestObj().mock('../../src/services/SeismicIntegration.js');
var _server = require("../mocks/server.js");
var _usgsService = require("../../src/services/usgsService.js");
var _SeismicIntegration = require("../../src/services/SeismicIntegration.js");
function _getJestObj() {
  const {
    jest
  } = require("@jest/globals");
  _getJestObj = () => jest;
  return jest;
}
describe('USGS Service', () => {
  beforeAll(() => {
    _server.server.listen();
  });
  afterAll(() => {
    _server.server.close();
  });
  beforeEach(() => {
    jest.clearAllMocks();
  });
  describe('getSeismicActivity', () => {
    it('should return transformed seismic data successfully', async () => {
      const mockRawData = {
        features: [{
          id: 'test1',
          properties: {
            mag: 6.5,
            place: 'Test Location',
            time: 1638360000000,
            tsunami: 0,
            sig: 100,
            url: 'https://example.com'
          },
          geometry: {
            coordinates: [-120.0, 35.0, 10.0]
          }
        }]
      };
      _SeismicIntegration.getSeismicData.mockResolvedValue(mockRawData);
      const result = await (0, _usgsService.getSeismicActivity)();
      expect(result).toHaveProperty('events');
      expect(result).toHaveProperty('summary');
      expect(result.events).toHaveLength(1);
      expect(result.events[0]).toMatchObject({
        id: 'test1',
        magnitude: 6.5,
        place: 'Test Location',
        time: 1638360000000,
        tsunami: 0,
        significance: 100,
        url: 'https://example.com',
        coordinates: [-120.0, 35.0, 10.0]
      });
      expect(result.summary).toMatchObject({
        totalEvents: 1,
        maxMagnitude: 6.5,
        source: 'USGS Earthquake Hazards Program'
      });
    });
    it('should handle empty seismic data', async () => {
      const mockRawData = {
        features: []
      };
      _SeismicIntegration.getSeismicData.mockResolvedValue(mockRawData);
      const result = await (0, _usgsService.getSeismicActivity)();
      expect(result.events).toEqual([]);
      expect(result.summary).toMatchObject({
        totalEvents: 0,
        maxMagnitude: 0,
        source: 'USGS Earthquake Hazards Program'
      });
    });
    it('should handle integration errors gracefully', async () => {
      _SeismicIntegration.getSeismicData.mockRejectedValue(new Error('Network error'));
      const result = await (0, _usgsService.getSeismicActivity)();
      expect(result).toHaveProperty('error');
      expect(result.error).toBe('Network error');
      expect(result.events).toEqual([]);
    });
    it('should handle invalid data structure', async () => {
      _SeismicIntegration.getSeismicData.mockResolvedValue(null);
      const result = await (0, _usgsService.getSeismicActivity)();
      expect(result.events).toEqual([]);
      expect(result.summary.totalEvents).toBe(0);
    });
  });
});
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJuYW1lcyI6WyJfZ2V0SmVzdE9iaiIsIm1vY2siLCJfc2VydmVyIiwicmVxdWlyZSIsIl91c2dzU2VydmljZSIsIl9TZWlzbWljSW50ZWdyYXRpb24iLCJqZXN0IiwiZGVzY3JpYmUiLCJiZWZvcmVBbGwiLCJzZXJ2ZXIiLCJsaXN0ZW4iLCJhZnRlckFsbCIsImNsb3NlIiwiYmVmb3JlRWFjaCIsImNsZWFyQWxsTW9ja3MiLCJpdCIsIm1vY2tSYXdEYXRhIiwiZmVhdHVyZXMiLCJpZCIsInByb3BlcnRpZXMiLCJtYWciLCJwbGFjZSIsInRpbWUiLCJ0c3VuYW1pIiwic2lnIiwidXJsIiwiZ2VvbWV0cnkiLCJjb29yZGluYXRlcyIsImdldFNlaXNtaWNEYXRhIiwibW9ja1Jlc29sdmVkVmFsdWUiLCJyZXN1bHQiLCJnZXRTZWlzbWljQWN0aXZpdHkiLCJleHBlY3QiLCJ0b0hhdmVQcm9wZXJ0eSIsImV2ZW50cyIsInRvSGF2ZUxlbmd0aCIsInRvTWF0Y2hPYmplY3QiLCJtYWduaXR1ZGUiLCJzaWduaWZpY2FuY2UiLCJzdW1tYXJ5IiwidG90YWxFdmVudHMiLCJtYXhNYWduaXR1ZGUiLCJzb3VyY2UiLCJ0b0VxdWFsIiwibW9ja1JlamVjdGVkVmFsdWUiLCJFcnJvciIsImVycm9yIiwidG9CZSJdLCJzb3VyY2VzIjpbInVzZ3NTZXJ2aWNlLnRlc3QuanMiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IHsgc2VydmVyIH0gZnJvbSAnLi4vbW9ja3Mvc2VydmVyLmpzJztcbmltcG9ydCB7IGdldFNlaXNtaWNBY3Rpdml0eSB9IGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy91c2dzU2VydmljZS5qcyc7XG5pbXBvcnQgeyBnZXRTZWlzbWljRGF0YSB9IGZyb20gJy4uLy4uL3NyYy9zZXJ2aWNlcy9TZWlzbWljSW50ZWdyYXRpb24uanMnO1xuXG4vLyBNb2NrIHRoZSBTZWlzbWljSW50ZWdyYXRpb25cbmplc3QubW9jaygnLi4vLi4vc3JjL3NlcnZpY2VzL1NlaXNtaWNJbnRlZ3JhdGlvbi5qcycpO1xuXG5kZXNjcmliZSgnVVNHUyBTZXJ2aWNlJywgKCkgPT4ge1xuICBiZWZvcmVBbGwoKCkgPT4ge1xuICAgIHNlcnZlci5saXN0ZW4oKTtcbiAgfSk7XG5cbiAgYWZ0ZXJBbGwoKCkgPT4ge1xuICAgIHNlcnZlci5jbG9zZSgpO1xuICB9KTtcblxuICBiZWZvcmVFYWNoKCgpID0+IHtcbiAgICBqZXN0LmNsZWFyQWxsTW9ja3MoKTtcbiAgfSk7XG5cbiAgZGVzY3JpYmUoJ2dldFNlaXNtaWNBY3Rpdml0eScsICgpID0+IHtcbiAgICBpdCgnc2hvdWxkIHJldHVybiB0cmFuc2Zvcm1lZCBzZWlzbWljIGRhdGEgc3VjY2Vzc2Z1bGx5JywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Jhd0RhdGEgPSB7XG4gICAgICAgIGZlYXR1cmVzOiBbXG4gICAgICAgICAge1xuICAgICAgICAgICAgaWQ6ICd0ZXN0MScsXG4gICAgICAgICAgICBwcm9wZXJ0aWVzOiB7XG4gICAgICAgICAgICAgIG1hZzogNi41LFxuICAgICAgICAgICAgICBwbGFjZTogJ1Rlc3QgTG9jYXRpb24nLFxuICAgICAgICAgICAgICB0aW1lOiAxNjM4MzYwMDAwMDAwLFxuICAgICAgICAgICAgICB0c3VuYW1pOiAwLFxuICAgICAgICAgICAgICBzaWc6IDEwMCxcbiAgICAgICAgICAgICAgdXJsOiAnaHR0cHM6Ly9leGFtcGxlLmNvbSdcbiAgICAgICAgICAgIH0sXG4gICAgICAgICAgICBnZW9tZXRyeToge1xuICAgICAgICAgICAgICBjb29yZGluYXRlczogWy0xMjAuMCwgMzUuMCwgMTAuMF1cbiAgICAgICAgICAgIH1cbiAgICAgICAgICB9XG4gICAgICAgIF1cbiAgICAgIH07XG5cbiAgICAgIGdldFNlaXNtaWNEYXRhLm1vY2tSZXNvbHZlZFZhbHVlKG1vY2tSYXdEYXRhKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0U2Vpc21pY0FjdGl2aXR5KCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdldmVudHMnKTtcbiAgICAgIGV4cGVjdChyZXN1bHQpLnRvSGF2ZVByb3BlcnR5KCdzdW1tYXJ5Jyk7XG4gICAgICBleHBlY3QocmVzdWx0LmV2ZW50cykudG9IYXZlTGVuZ3RoKDEpO1xuICAgICAgZXhwZWN0KHJlc3VsdC5ldmVudHNbMF0pLnRvTWF0Y2hPYmplY3Qoe1xuICAgICAgICBpZDogJ3Rlc3QxJyxcbiAgICAgICAgbWFnbml0dWRlOiA2LjUsXG4gICAgICAgIHBsYWNlOiAnVGVzdCBMb2NhdGlvbicsXG4gICAgICAgIHRpbWU6IDE2MzgzNjAwMDAwMDAsXG4gICAgICAgIHRzdW5hbWk6IDAsXG4gICAgICAgIHNpZ25pZmljYW5jZTogMTAwLFxuICAgICAgICB1cmw6ICdodHRwczovL2V4YW1wbGUuY29tJyxcbiAgICAgICAgY29vcmRpbmF0ZXM6IFstMTIwLjAsIDM1LjAsIDEwLjBdXG4gICAgICB9KTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VtbWFyeSkudG9NYXRjaE9iamVjdCh7XG4gICAgICAgIHRvdGFsRXZlbnRzOiAxLFxuICAgICAgICBtYXhNYWduaXR1ZGU6IDYuNSxcbiAgICAgICAgc291cmNlOiAnVVNHUyBFYXJ0aHF1YWtlIEhhemFyZHMgUHJvZ3JhbSdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgZW1wdHkgc2Vpc21pYyBkYXRhJywgYXN5bmMgKCkgPT4ge1xuICAgICAgY29uc3QgbW9ja1Jhd0RhdGEgPSB7IGZlYXR1cmVzOiBbXSB9O1xuICAgICAgZ2V0U2Vpc21pY0RhdGEubW9ja1Jlc29sdmVkVmFsdWUobW9ja1Jhd0RhdGEpO1xuXG4gICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBnZXRTZWlzbWljQWN0aXZpdHkoKTtcblxuICAgICAgZXhwZWN0KHJlc3VsdC5ldmVudHMpLnRvRXF1YWwoW10pO1xuICAgICAgZXhwZWN0KHJlc3VsdC5zdW1tYXJ5KS50b01hdGNoT2JqZWN0KHtcbiAgICAgICAgdG90YWxFdmVudHM6IDAsXG4gICAgICAgIG1heE1hZ25pdHVkZTogMCxcbiAgICAgICAgc291cmNlOiAnVVNHUyBFYXJ0aHF1YWtlIEhhemFyZHMgUHJvZ3JhbSdcbiAgICAgIH0pO1xuICAgIH0pO1xuXG4gICAgaXQoJ3Nob3VsZCBoYW5kbGUgaW50ZWdyYXRpb24gZXJyb3JzIGdyYWNlZnVsbHknLCBhc3luYyAoKSA9PiB7XG4gICAgICBnZXRTZWlzbWljRGF0YS5tb2NrUmVqZWN0ZWRWYWx1ZShuZXcgRXJyb3IoJ05ldHdvcmsgZXJyb3InKSk7XG5cbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IGdldFNlaXNtaWNBY3Rpdml0eSgpO1xuXG4gICAgICBleHBlY3QocmVzdWx0KS50b0hhdmVQcm9wZXJ0eSgnZXJyb3InKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXJyb3IpLnRvQmUoJ05ldHdvcmsgZXJyb3InKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuZXZlbnRzKS50b0VxdWFsKFtdKTtcbiAgICB9KTtcblxuICAgIGl0KCdzaG91bGQgaGFuZGxlIGludmFsaWQgZGF0YSBzdHJ1Y3R1cmUnLCBhc3luYyAoKSA9PiB7XG4gICAgICBnZXRTZWlzbWljRGF0YS5tb2NrUmVzb2x2ZWRWYWx1ZShudWxsKTtcblxuICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgZ2V0U2Vpc21pY0FjdGl2aXR5KCk7XG5cbiAgICAgIGV4cGVjdChyZXN1bHQuZXZlbnRzKS50b0VxdWFsKFtdKTtcbiAgICAgIGV4cGVjdChyZXN1bHQuc3VtbWFyeS50b3RhbEV2ZW50cykudG9CZSgwKTtcbiAgICB9KTtcbiAgfSk7XG59KTsiXSwibWFwcGluZ3MiOiI7O0FBSUE7QUFDQUEsV0FBQSxHQUFLQyxJQUFJLENBQUMsMENBQTBDLENBQUM7QUFMckQsSUFBQUMsT0FBQSxHQUFBQyxPQUFBO0FBQ0EsSUFBQUMsWUFBQSxHQUFBRCxPQUFBO0FBQ0EsSUFBQUUsbUJBQUEsR0FBQUYsT0FBQTtBQUEwRSxTQUFBSCxZQUFB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