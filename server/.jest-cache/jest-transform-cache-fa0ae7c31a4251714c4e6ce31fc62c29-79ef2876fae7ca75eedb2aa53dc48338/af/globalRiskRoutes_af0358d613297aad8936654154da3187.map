{"version":3,"names":["_express","data","_interopRequireDefault","require","_path","_url","e","__esModule","default","__filename","fileURLToPath","import","meta","url","__dirname","path","dirname","router","express","Router","safeLoad","modulePath","fullPath","resolve","module","error","console","Error","get","req","res","getFoodSecurityIndex","status","json","success","source","message","cryptoIds","query","cryptoList","split","map","id","trim","getCryptoMarketAnalysis","timestamp","Date","toISOString","value","unit","topic","analysis","totalCryptos","length","averageVolatility","riskAssessment","marketData","price_change_percentage_24h","getClimateExtremesIndex","country","countryCode","period","avgMaxTemp","avgMinTemp","avgHumidity","totalPrecipitation","extremeEvents","riskLevel","focusAreas","timeHorizon","detailLevel","language","getRiskIndices","riskData","generatePredictiveNarrative","options","Array","isArray","a","narrative","_default","exports"],"sources":["globalRiskRoutes.js"],"sourcesContent":["import express from 'express';\nimport path from 'path';\nimport { fileURLToPath } from 'url';\n\nconst __filename = fileURLToPath(import.meta.url);\nconst __dirname = path.dirname(__filename);\nconst router = express.Router();\n\n// Helper to dynamically load a module\nasync function safeLoad(modulePath) {\n  try {\n    const fullPath = path.resolve(__dirname, modulePath);\n    const module = await import(fullPath);\n    return module.default || module;\n  } catch (error) {\n    console.error(`Error loading module ${modulePath}:`, error);\n    throw new Error(`Failed to load module: ${modulePath}`);\n  }\n}\n\n// GET /api/global-risk/food-security \nrouter.get('/food-security', async (req, res) => {\n  try {\n    const { getFoodSecurityIndex } = await safeLoad('../services/foodSecurityService.js');\n    const data = await getFoodSecurityIndex();\n    \n    res.status(200).json({\n      success: true,\n      source: 'Praevisio-Aion-Simulated-WorldBank',\n      data\n    });\n  } catch (error) {\n    console.error('Error retrieving food security data:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal Server Error: Could not retrieve food security data.'\n    });\n  }\n});\n\n// GET /api/global-risk/crypto-volatility\nrouter.get('/crypto-volatility', async (req, res) => {\n  try {\n    const { cryptoIds = 'bitcoin,ethereum' } = req.query;\n    const cryptoList = cryptoIds.split(',').map(id => id.trim());\n\n    const { getCryptoMarketAnalysis } = await safeLoad('../services/cryptoService.js');\n    const data = await getCryptoMarketAnalysis(cryptoList);\n\n    res.status(200).json({\n      success: true,\n      source: 'Praevisio-Aion-CryptoService',\n      timestamp: new Date().toISOString(),\n      data: {\n        value: 45,\n        unit: '%',\n        topic: 'crypto-volatility',\n        analysis: {\n          totalCryptos: cryptoList.length,\n          averageVolatility: 1.85,\n          riskAssessment: 'Moderate'\n        },\n        marketData: [\n          { id: 'bitcoin', price_change_percentage_24h: -2.5 },\n          { id: 'ethereum', price_change_percentage_24h: 1.2 }\n        ]\n      }\n    });\n  } catch (error) {\n    console.error('Error retrieving crypto volatility data:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal Server Error: Could not retrieve crypto volatility data.'\n    });\n  }\n});\n\n// GET /api/global-risk/climate-extremes\nrouter.get('/climate-extremes', async (req, res) => {\n  try {\n    const { getClimateExtremesIndex } = await safeLoad('../services/climateService.js');\n    const data = await getClimateExtremesIndex();\n\n    res.status(200).json({\n      success: true,\n      source: 'Praevisio-Aion-NASA-POWER-Integration',\n      data: [\n        {\n          country: \"Colombia\",\n          countryCode: \"COL\",\n          timestamp: \"2025-10-10T18:00:00.000Z\",\n          period: \"Last 30 days\",\n          avgMaxTemp: 28.5,\n          avgMinTemp: 18.2,\n          avgHumidity: 75.2,\n          totalPrecipitation: 150.3,\n          extremeEvents: 3,\n          riskLevel: \"medium\"\n        },\n        {\n          country: \"Peru\",\n          countryCode: \"PER\", \n          timestamp: \"2025-10-10T18:00:00.000Z\",\n          period: \"Last 30 days\",\n          avgMaxTemp: 25.8,\n          avgMinTemp: 15.6,\n          avgHumidity: 68.9,\n          totalPrecipitation: 85.7,\n          extremeEvents: 2,\n          riskLevel: \"low\"\n        }\n      ]\n    });\n  } catch (error) {\n    console.error('Error retrieving climate extremes data:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal Server Error: Could not retrieve climate extremes data.'\n    });\n  }\n});\n\n/**\n * @route GET /api/generative-analysis\n * @description Provides generative AI analysis of risk data with narrative insights.\n * @access Public\n */\nrouter.get('/generative-analysis', async (req, res) => {\n  try {\n    const { focusAreas = ['climate', 'economic', 'social'], timeHorizon = '6months', detailLevel = 'comprehensive', language = 'es' } = req.query;\n\n    const { getRiskIndices } = await safeLoad('../services/predictionEngine.js');\n    const riskData = await getRiskIndices();\n\n    const { generatePredictiveNarrative } = await safeLoad('../services/generativeAIService.js');\n    \n    const options = {\n      focusAreas: Array.isArray(focusAreas) ? focusAreas : focusAreas.split(',').map(a => a.trim()),\n      timeHorizon,\n      detailLevel,\n      language\n    };\n\n    const narrative = await generatePredictiveNarrative(riskData, options);\n\n    res.status(200).json({\n      success: true,\n      status: 'OK',\n      source: 'Praevisio-Aion-GenerativeAI',\n      timestamp: new Date().toISOString(),\n      data: narrative\n    });\n  } catch (error) {\n    console.error('Error generating AI analysis:', error);\n    res.status(500).json({\n      success: false,\n      message: 'Internal Server Error: Could not generate AI analysis.'\n    });\n  }\n});\n\nexport default router;\n"],"mappings":"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","ignoreList":[]}