{"version":3,"names":["onUnhandledRequest_exports","__export","onUnhandledRequest","module","exports","__toCommonJS","import_toPublicUrl","require","import_devUtils","import_isCommonAssetRequest","request","strategy","url","URL","publicUrl","toPublicUrl","search","requestBody","method","clone","text","messageDetails","unhandledRequestMessage","applyStrategy","strategy2","devUtils","error","InternalError","formatMessage","warn","warning","bind","isCommonAssetRequest"],"sources":["../../../../src/core/utils/request/onUnhandledRequest.ts"],"sourcesContent":["import { toPublicUrl } from './toPublicUrl'\nimport { InternalError, devUtils } from '../internal/devUtils'\nimport { isCommonAssetRequest } from '../../isCommonAssetRequest'\n\nexport interface UnhandledRequestPrint {\n  warning(): void\n  error(): void\n}\n\nexport type UnhandledRequestCallback = (\n  request: Request,\n  print: UnhandledRequestPrint,\n) => void\n\nexport type UnhandledRequestStrategy =\n  | 'bypass'\n  | 'warn'\n  | 'error'\n  | UnhandledRequestCallback\n\nexport async function onUnhandledRequest(\n  request: Request,\n  strategy: UnhandledRequestStrategy = 'warn',\n): Promise<void> {\n  const url = new URL(request.url)\n  const publicUrl = toPublicUrl(url) + url.search\n\n  const requestBody =\n    request.method === 'HEAD' || request.method === 'GET'\n      ? null\n      : await request.clone().text()\n  const messageDetails = `\\n\\n  \\u2022 ${request.method} ${publicUrl}\\n\\n${requestBody ? `  \\u2022 Request body: ${requestBody}\\n\\n` : ''}`\n  const unhandledRequestMessage = `intercepted a request without a matching request handler:${messageDetails}If you still wish to intercept this unhandled request, please create a request handler for it.\\nRead more: https://mswjs.io/docs/http/intercepting-requests`\n\n  function applyStrategy(strategy: UnhandledRequestStrategy) {\n    switch (strategy) {\n      case 'error': {\n        // Print a developer-friendly error.\n        devUtils.error('Error: %s', unhandledRequestMessage)\n\n        // Throw an exception to halt request processing and not perform the original request.\n        throw new InternalError(\n          devUtils.formatMessage(\n            'Cannot bypass a request when using the \"error\" strategy for the \"onUnhandledRequest\" option.',\n          ),\n        )\n      }\n\n      case 'warn': {\n        devUtils.warn('Warning: %s', unhandledRequestMessage)\n        break\n      }\n\n      case 'bypass':\n        break\n\n      default:\n        throw new InternalError(\n          devUtils.formatMessage(\n            'Failed to react to an unhandled request: unknown strategy \"%s\". Please provide one of the supported strategies (\"bypass\", \"warn\", \"error\") or a custom callback function as the value of the \"onUnhandledRequest\" option.',\n            strategy,\n          ),\n        )\n    }\n  }\n\n  if (typeof strategy === 'function') {\n    strategy(request, {\n      warning: applyStrategy.bind(null, 'warn'),\n      error: applyStrategy.bind(null, 'error'),\n    })\n    return\n  }\n\n  // Ignore common static asset requests when using a built-in strategy.\n  // There's a slight overhead here because this utility will create a request URL\n  // instance again despite us having done so previously in this function.\n  if (!isCommonAssetRequest(request)) {\n    applyStrategy(strategy)\n  }\n}\n"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAAA,IAAAA,0BAAA;AAAAC,QAAA,CAAAD,0BAAA;EAAAE,kBAAA,EAAAA,CAAA,KAAAA;AAAA;AAAAC,MAAA,CAAAC,OAAA,GAAAC,YAAA,CAAAL,0BAAA;AAAA,IAAAM,kBAAA,GAA4BC,OAAA;AAC5B,IAAAC,eAAA,GAAwCD,OAAA;AACxC,IAAAE,2BAAA,GAAqCF,OAAA;AAkBrC,eAAsBL,mBACpBQ,OAAA,EACAC,QAAA,GAAqC,QACtB;EACf,MAAMC,GAAA,GAAM,IAAIC,GAAA,CAAIH,OAAA,CAAQE,GAAG;EAC/B,MAAME,SAAA,OAAYR,kBAAA,CAAAS,WAAA,EAAYH,GAAG,IAAIA,GAAA,CAAII,MAAA;EAEzC,MAAMC,WAAA,GACJP,OAAA,CAAQQ,MAAA,KAAW,UAAUR,OAAA,CAAQQ,MAAA,KAAW,QAC5C,OACA,MAAMR,OAAA,CAAQS,KAAA,CAAM,EAAEC,IAAA,CAAK;EACjC,MAAMC,cAAA,GAAiB;AAAA;AAAA,WAAgBX,OAAA,CAAQQ,MAAM,IAAIJ,SAAS;AAAA;AAAA,EAAOG,WAAA,GAAc,0BAA0BA,WAAW;AAAA;AAAA,IAAS,EAAE;EACvI,MAAMK,uBAAA,GAA0B,4DAA4DD,cAAc;AAAA;EAE1G,SAASE,cAAcC,SAAA,EAAoC;IACzD,QAAQA,SAAA;MACN,KAAK;QAAS;UAEZhB,eAAA,CAAAiB,QAAA,CAASC,KAAA,CAAM,aAAaJ,uBAAuB;UAGnD,MAAM,IAAId,eAAA,CAAAmB,aAAA,CACRnB,eAAA,CAAAiB,QAAA,CAASG,aAAA,CACP,8FACF,CACF;QACF;MAEA,KAAK;QAAQ;UACXpB,eAAA,CAAAiB,QAAA,CAASI,IAAA,CAAK,eAAeP,uBAAuB;UACpD;QACF;MAEA,KAAK;QACH;MAEF;QACE,MAAM,IAAId,eAAA,CAAAmB,aAAA,CACRnB,eAAA,CAAAiB,QAAA,CAASG,aAAA,CACP,6NACAJ,SACF,CACF;IACJ;EACF;EAEA,IAAI,OAAOb,QAAA,KAAa,YAAY;IAClCA,QAAA,CAASD,OAAA,EAAS;MAChBoB,OAAA,EAASP,aAAA,CAAcQ,IAAA,CAAK,MAAM,MAAM;MACxCL,KAAA,EAAOH,aAAA,CAAcQ,IAAA,CAAK,MAAM,OAAO;IACzC,CAAC;IACD;EACF;EAKA,IAAI,KAACtB,2BAAA,CAAAuB,oBAAA,EAAqBtB,OAAO,GAAG;IAClCa,aAAA,CAAcZ,QAAQ;EACxB;AACF","ignoreList":[]}